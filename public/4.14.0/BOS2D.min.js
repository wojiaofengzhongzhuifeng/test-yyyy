/*
 * BOS3D V4.14.0
 *
 * A WebGL-based 3D Viewer for threejs,it is modified for BimWinner
 * http://bos3d.bimwinner.com
 *
 * Built on 2020-05-25T18:04:06
 *
 * todo
 * Copyright 2020, 盈嘉互联（北京）科技有限公司
 *
 *
 */

!function(a,b,c){"use strict";!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=134)}([function(a,b,d){var e=d(2),f=d(13),g=d(14),h=d(15),i=d(19),j="prototype",k=function(a,b,d){var l,m,n,o,p=a&k.F,q=a&k.G,r=a&k.S,s=a&k.P,t=a&k.B,u=q?e:r?e[b]||(e[b]={}):(e[b]||{})[j],v=q?f:f[b]||(f[b]={}),w=v[j]||(v[j]={});q&&(d=b);for(l in d)m=!p&&u&&u[l]!==c,n=(m?u:d)[l],o=t&&m?i(n,e):s&&"function"==typeof n?i(Function.call,n):n,u&&h(u,l,n,a&k.U),v[l]!=n&&g(v,l,o),s&&w[l]!=n&&(w[l]=n)};e.core=f,k.F=1,k.G=2,k.S=4,k.P=8,k.B=16,k.W=32,k.U=64,k.R=128,a.exports=k},function(a,b,c){var d=c(3);a.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},function(a,c){var d=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof b&&(b=d)},function(a,b){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},function(a,b){a.exports=function(a){try{return!!a()}catch(b){return!0}}},function(a,b,c){var d=c(47)("wks"),e=c(37),f=c(2).Symbol,g="function"==typeof f,h=a.exports=function(a){return d[a]||(d[a]=g&&f[a]||(g?f:e)("Symbol."+a))};h.store=d},function(a,b,c){var d=c(21),e=Math.min;a.exports=function(a){return a>0?e(d(a),9007199254740991):0}},function(a,b,c){var d=c(1),e=c(98),f=c(23),g=Object.defineProperty;b.f=c(8)?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(h){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},function(a,b,c){a.exports=!c(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(a,b,c){var d=c(24);a.exports=function(a){return Object(d(a))}},function(a,b){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},function(a,b,c){var d=c(48),e=c(24);a.exports=function(a){return d(e(a))}},function(a,b){var c={}.hasOwnProperty;a.exports=function(a,b){return c.call(a,b)}},function(b,c){var d=b.exports={version:"2.6.5"};"number"==typeof a&&(a=d)},function(a,b,c){var d=c(7),e=c(31);a.exports=c(8)?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},function(a,b,c){var d=c(2),e=c(14),f=c(12),g=c(37)("src"),h=c(136),i="toString",j=(""+h).split(i);c(13).inspectSource=function(a){return h.call(a)},(a.exports=function(a,b,c,h){var i="function"==typeof c;i&&(f(c,"name")||e(c,"name",b)),a[b]!==c&&(i&&(f(c,g)||e(c,g,a[b]?""+a[b]:j.join(String(b)))),a===d?a[b]=c:h?a[b]?a[b]=c:e(a,b,c):(delete a[b],e(a,b,c)))})(Function.prototype,i,function(){return"function"==typeof this&&this[g]||h.call(this)})},function(a,b,c){var d=c(49),e=c(31),f=c(11),g=c(23),h=c(12),i=c(98),j=Object.getOwnPropertyDescriptor;b.f=c(8)?j:function(a,b){if(a=f(a),b=g(b,!0),i)try{return j(a,b)}catch(c){}if(h(a,b))return e(!d.f.call(a,b),a[b])}},function(a,b,c){var d=c(12),e=c(9),f=c(71)("IE_PROTO"),g=Object.prototype;a.exports=Object.getPrototypeOf||function(a){return a=e(a),d(a,f)?a[f]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},function(a,b,c){var d=c(0),e=c(4),f=c(24),g=/"/g,h=function(a,b,c,d){var e=String(f(a)),h="<"+b;return""!==c&&(h+=" "+c+'="'+String(d).replace(g,"&quot;")+'"'),h+">"+e+"</"+b+">"};a.exports=function(a,b){var c={};c[a]=b(h),d(d.P+d.F*e(function(){var b=""[a]('"');return b!==b.toLowerCase()||b.split('"').length>3}),"String",c)}},function(a,b,d){var e=d(10);a.exports=function(a,b,d){if(e(a),b===c)return a;switch(d){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},function(a,b){var c={}.toString;a.exports=function(a){return c.call(a).slice(8,-1)}},function(a,b){var c=Math.ceil,d=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(a>0?d:c)(a)}},function(a,b,c){var d=c(4);a.exports=function(a,b){return!!a&&d(function(){b?a.call(null,function(){},1):a.call(null)})}},function(a,b,c){var d=c(3);a.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},function(a,b){a.exports=function(a){if(a==c)throw TypeError("Can't call method on  "+a);return a}},function(a,b,c){var d=c(0),e=c(13),f=c(4);a.exports=function(a,b){var c=(e.Object||{})[a]||Object[a],g={};g[a]=b(c),d(d.S+d.F*f(function(){c(1)}),"Object",g)}},function(a,b,d){var e=d(19),f=d(48),g=d(9),h=d(6),i=d(86);a.exports=function(a,b){var d=1==a,j=2==a,k=3==a,l=4==a,m=6==a,n=5==a||m,o=b||i;return function(b,i,p){for(var q,r,s=g(b),t=f(s),u=e(i,p,3),v=h(t.length),w=0,x=d?o(b,v):j?o(b,0):c;v>w;w++)if((n||w in t)&&(q=t[w],r=u(q,w,s),a))if(d)x[w]=r;else if(r)switch(a){case 3:return!0;case 5:return q;case 6:return w;case 2:x.push(q)}else if(l)return!1;return m?-1:k||l?l:x}}},function(a,b,c){var d=c(100),e=c(72);a.exports=Object.keys||function(a){return d(a,e)}},function(a,b,d){var e=d(1),f=d(101),g=d(72),h=d(71)("IE_PROTO"),i=function(){},j="prototype",k=function(){var a,b=d(69)("iframe"),c=g.length,e="<",f=">";for(b.style.display="none",d(73).appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write(e+"script"+f+"document.F=Object"+e+"/script"+f),a.close(),k=a.F;c--;)delete k[j][g[c]];return k()};a.exports=Object.create||function(a,b){var d;return null!==a?(i[j]=e(a),d=new i,i[j]=null,d[h]=a):d=k(),b===c?d:f(d,b)}},function(a,b,d){if(d(8)){var e=d(32),f=d(2),g=d(4),h=d(0),i=d(65),j=d(96),k=d(19),l=d(42),m=d(31),n=d(14),o=d(43),p=d(21),q=d(6),r=d(123),s=d(38),t=d(23),u=d(12),v=d(34),w=d(3),x=d(9),y=d(84),z=d(28),A=d(17),B=d(39).f,C=d(50),D=d(37),E=d(5),F=d(26),G=d(53),H=d(52),I=d(88),J=d(40),K=d(60),L=d(41),M=d(87),N=d(113),O=d(7),P=d(16),Q=O.f,R=P.f,S=f.RangeError,T=f.TypeError,U=f.Uint8Array,V="ArrayBuffer",W="Shared"+V,X="BYTES_PER_ELEMENT",Y="prototype",Z=Array[Y],$=j.ArrayBuffer,_=j.DataView,aa=F(0),ba=F(2),ca=F(3),da=F(4),ea=F(5),fa=F(6),ga=G(!0),ha=G(!1),ia=I.values,ja=I.keys,ka=I.entries,la=Z.lastIndexOf,ma=Z.reduce,na=Z.reduceRight,oa=Z.join,pa=Z.sort,qa=Z.slice,ra=Z.toString,sa=Z.toLocaleString,ta=E("iterator"),ua=E("toStringTag"),va=D("typed_constructor"),wa=D("def_constructor"),xa=i.CONSTR,ya=i.TYPED,za=i.VIEW,Aa="Wrong length!",Ba=F(1,function(a,b){return Ga(H(a,a[wa]),b)}),Ca=g(function(){return 1===new U(new Uint16Array([1]).buffer)[0]}),Da=!!U&&!!U[Y].set&&g(function(){new U(1).set({})}),Ea=function(a,b){var c=p(a);if(c<0||c%b)throw S("Wrong offset!");return c},Fa=function(a){if(w(a)&&ya in a)return a;throw T(a+" is not a typed array!")},Ga=function(a,b){if(!(w(a)&&va in a))throw T("It is not a typed array constructor!");return new a(b)},Ha=function(a,b){return Ia(H(a,a[wa]),b)},Ia=function(a,b){for(var c=0,d=b.length,e=Ga(a,d);d>c;)e[c]=b[c++];return e},Ja=function(a,b,c){Q(a,b,{get:function(){return this._d[c]}})},Ka=function(a){var b,d,e,f,g,h,i=x(a),j=arguments.length,l=j>1?arguments[1]:c,m=l!==c,n=C(i);if(n!=c&&!y(n)){for(h=n.call(i),e=[],b=0;!(g=h.next()).done;b++)e.push(g.value);i=e}for(m&&j>2&&(l=k(l,arguments[2],2)),b=0,d=q(i.length),f=Ga(this,d);d>b;b++)f[b]=m?l(i[b],b):i[b];return f},La=function(){for(var a=0,b=arguments.length,c=Ga(this,b);b>a;)c[a]=arguments[a++];return c},Ma=!!U&&g(function(){sa.call(new U(1))}),Na=function(){return sa.apply(Ma?qa.call(Fa(this)):Fa(this),arguments)},Oa={copyWithin:function(a,b){return N.call(Fa(this),a,b,arguments.length>2?arguments[2]:c)},every:function(a){return da(Fa(this),a,arguments.length>1?arguments[1]:c)},fill:function(a){return M.apply(Fa(this),arguments)},filter:function(a){return Ha(this,ba(Fa(this),a,arguments.length>1?arguments[1]:c))},find:function(a){return ea(Fa(this),a,arguments.length>1?arguments[1]:c)},findIndex:function(a){return fa(Fa(this),a,arguments.length>1?arguments[1]:c)},forEach:function(a){aa(Fa(this),a,arguments.length>1?arguments[1]:c)},indexOf:function(a){return ha(Fa(this),a,arguments.length>1?arguments[1]:c)},includes:function(a){return ga(Fa(this),a,arguments.length>1?arguments[1]:c)},join:function(a){return oa.apply(Fa(this),arguments)},lastIndexOf:function(a){return la.apply(Fa(this),arguments)},map:function(a){return Ba(Fa(this),a,arguments.length>1?arguments[1]:c)},reduce:function(a){return ma.apply(Fa(this),arguments)},reduceRight:function(a){return na.apply(Fa(this),arguments)},reverse:function(){for(var a,b=this,c=Fa(b).length,d=Math.floor(c/2),e=0;e<d;)a=b[e],b[e++]=b[--c],b[c]=a;return b},some:function(a){return ca(Fa(this),a,arguments.length>1?arguments[1]:c)},sort:function(a){return pa.call(Fa(this),a)},subarray:function(a,b){var d=Fa(this),e=d.length,f=s(a,e);return new(H(d,d[wa]))(d.buffer,d.byteOffset+f*d.BYTES_PER_ELEMENT,q((b===c?e:s(b,e))-f))}},Pa=function(a,b){return Ha(this,qa.call(Fa(this),a,b))},Qa=function(a){Fa(this);var b=Ea(arguments[1],1),c=this.length,d=x(a),e=q(d.length),f=0;if(e+b>c)throw S(Aa);for(;f<e;)this[b+f]=d[f++]},Ra={entries:function(){return ka.call(Fa(this))},keys:function(){return ja.call(Fa(this))},values:function(){return ia.call(Fa(this))}},Sa=function(a,b){return w(a)&&a[ya]&&"symbol"!=typeof b&&b in a&&String(+b)==String(b)},Ta=function(a,b){return Sa(a,b=t(b,!0))?m(2,a[b]):R(a,b)},Ua=function(a,b,c){return!(Sa(a,b=t(b,!0))&&w(c)&&u(c,"value"))||u(c,"get")||u(c,"set")||c.configurable||u(c,"writable")&&!c.writable||u(c,"enumerable")&&!c.enumerable?Q(a,b,c):(a[b]=c.value,a)};xa||(P.f=Ta,O.f=Ua),h(h.S+h.F*!xa,"Object",{getOwnPropertyDescriptor:Ta,defineProperty:Ua}),g(function(){ra.call({})})&&(ra=sa=function(){return oa.call(this)});var Va=o({},Oa);o(Va,Ra),n(Va,ta,Ra.values),o(Va,{slice:Pa,set:Qa,constructor:function(){},toString:ra,toLocaleString:Na}),Ja(Va,"buffer","b"),Ja(Va,"byteOffset","o"),Ja(Va,"byteLength","l"),Ja(Va,"length","e"),Q(Va,ua,{get:function(){return this[ya]}}),a.exports=function(a,b,d,j){j=!!j;var k=a+(j?"Clamped":"")+"Array",m="get"+a,o="set"+a,p=f[k],s=p||{},t=p&&A(p),u=!p||!i.ABV,x={},y=p&&p[Y],C=function(a,c){var d=a._d;return d.v[m](c*b+d.o,Ca)},D=function(a,c,d){var e=a._d;j&&(d=(d=Math.round(d))<0?0:d>255?255:255&d),e.v[o](c*b+e.o,d,Ca)},E=function(a,b){Q(a,b,{get:function(){return C(this,b)},set:function(a){return D(this,b,a)},enumerable:!0})};u?(p=d(function(a,d,e,f){l(a,p,k,"_d");var g,h,i,j,m=0,o=0;if(w(d)){if(!(d instanceof $||(j=v(d))==V||j==W))return ya in d?Ia(p,d):Ka.call(p,d);g=d,o=Ea(e,b);var s=d.byteLength;if(f===c){if(s%b)throw S(Aa);if(h=s-o,h<0)throw S(Aa)}else if(h=q(f)*b,h+o>s)throw S(Aa);i=h/b}else i=r(d),h=i*b,g=new $(h);for(n(a,"_d",{b:g,o:o,l:h,e:i,v:new _(g)});m<i;)E(a,m++)}),y=p[Y]=z(Va),n(y,"constructor",p)):g(function(){p(1)})&&g(function(){new p((-1))})&&K(function(a){new p,new p(null),new p(1.5),new p(a)},!0)||(p=d(function(a,d,e,f){l(a,p,k);var g;return w(d)?d instanceof $||(g=v(d))==V||g==W?f!==c?new s(d,Ea(e,b),f):e!==c?new s(d,Ea(e,b)):new s(d):ya in d?Ia(p,d):Ka.call(p,d):new s(r(d))}),aa(t!==Function.prototype?B(s).concat(B(t)):B(s),function(a){a in p||n(p,a,s[a])}),p[Y]=y,e||(y.constructor=p));var F=y[ta],G=!!F&&("values"==F.name||F.name==c),H=Ra.values;n(p,va,!0),n(y,ya,k),n(y,za,!0),n(y,wa,p),(j?new p(1)[ua]==k:ua in y)||Q(y,ua,{get:function(){return k}}),x[k]=p,h(h.G+h.W+h.F*(p!=s),x),h(h.S,k,{BYTES_PER_ELEMENT:b}),h(h.S+h.F*g(function(){s.of.call(p,1)}),k,{from:Ka,of:La}),X in y||n(y,X,b),h(h.P,k,Oa),L(k),h(h.P+h.F*Da,k,{set:Qa}),h(h.P+h.F*!G,k,Ra),e||y.toString==ra||(y.toString=ra),h(h.P+h.F*g(function(){new p(1).slice()}),k,{slice:Pa}),h(h.P+h.F*(g(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!g(function(){y.toLocaleString.call([1,2])})),k,{toLocaleString:Na}),J[k]=G?F:H,e||G||n(y,ta,H)}}else a.exports=function(){}},function(a,b,d){var e=d(118),f=d(0),g=d(47)("metadata"),h=g.store||(g.store=new(d(121))),i=function(a,b,d){var f=h.get(a);if(!f){if(!d)return c;h.set(a,f=new e)}var g=f.get(b);if(!g){if(!d)return c;f.set(b,g=new e)}return g},j=function(a,b,d){var e=i(b,d,!1);return e!==c&&e.has(a)},k=function(a,b,d){var e=i(b,d,!1);return e===c?c:e.get(a)},l=function(a,b,c,d){i(c,d,!0).set(a,b)},m=function(a,b){var c=i(a,b,!1),d=[];return c&&c.forEach(function(a,b){d.push(b)}),d},n=function(a){return a===c||"symbol"==typeof a?a:String(a)},o=function(a){f(f.S,"Reflect",a)};a.exports={store:h,map:i,has:j,get:k,set:l,keys:m,key:n,exp:o}},function(a,b){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},function(a,b){a.exports=!1},function(a,b,c){var d=c(37)("meta"),e=c(3),f=c(12),g=c(7).f,h=0,i=Object.isExtensible||function(){return!0},j=!c(4)(function(){return i(Object.preventExtensions({}))}),k=function(a){g(a,d,{value:{i:"O"+ ++h,w:{}}})},l=function(a,b){if(!e(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!f(a,d)){if(!i(a))return"F";if(!b)return"E";k(a)}return a[d].i},m=function(a,b){if(!f(a,d)){if(!i(a))return!0;if(!b)return!1;k(a)}return a[d].w},n=function(a){return j&&o.NEED&&i(a)&&!f(a,d)&&k(a),a},o=a.exports={KEY:d,NEED:!1,fastKey:l,getWeak:m,onFreeze:n}},function(a,b,d){var e=d(20),f=d(5)("toStringTag"),g="Arguments"==e(function(){return arguments}()),h=function(a,b){try{return a[b]}catch(c){}};a.exports=function(a){var b,d,i;return a===c?"Undefined":null===a?"Null":"string"==typeof(d=h(b=Object(a),f))?d:g?e(b):"Object"==(i=e(b))&&"function"==typeof b.callee?"Arguments":i}},function(a,b,d){var e=d(5)("unscopables"),f=Array.prototype;f[e]==c&&d(14)(f,e,{}),a.exports=function(a){f[e][a]=!0}},function(a,b,c){var d=c(19),e=c(111),f=c(84),g=c(1),h=c(6),i=c(50),j={},k={},b=a.exports=function(a,b,c,l,m){var n,o,p,q,r=m?function(){return a}:i(a),s=d(c,l,b?2:1),t=0;if("function"!=typeof r)throw TypeError(a+" is not iterable!");if(f(r)){for(n=h(a.length);n>t;t++)if(q=b?s(g(o=a[t])[0],o[1]):s(a[t]),q===j||q===k)return q}else for(p=r.call(a);!(o=p.next()).done;)if(q=e(p,s,o.value,b),q===j||q===k)return q};b.BREAK=j,b.RETURN=k},function(a,b){var d=0,e=Math.random();a.exports=function(a){return"Symbol(".concat(a===c?"":a,")_",(++d+e).toString(36))}},function(a,b,c){var d=c(21),e=Math.max,f=Math.min;a.exports=function(a,b){return a=d(a),a<0?e(a+b,0):f(a,b)}},function(a,b,c){var d=c(100),e=c(72).concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return d(a,e)}},function(a,b){a.exports={}},function(a,b,c){var d=c(2),e=c(7),f=c(8),g=c(5)("species");a.exports=function(a){var b=d[a];f&&b&&!b[g]&&e.f(b,g,{configurable:!0,get:function(){return this}})}},function(a,b){a.exports=function(a,b,d,e){if(!(a instanceof b)||e!==c&&e in a)throw TypeError(d+": incorrect invocation!");return a}},function(a,b,c){var d=c(15);a.exports=function(a,b,c){for(var e in b)d(a,e,b[e],c);return a}},function(a,b,c){var d=c(3);a.exports=function(a,b){if(!d(a)||a._t!==b)throw TypeError("Incompatible receiver, "+b+" required!");return a}},function(a,b,c){var d=c(7).f,e=c(12),f=c(5)("toStringTag");a.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})}},function(a,b,c){var d=c(0),e=c(24),f=c(4),g=c(78),h="["+g+"]",i="​",j=RegExp("^"+h+h+"*"),k=RegExp(h+h+"*$"),l=function(a,b,c){var e={},h=f(function(){return!!g[a]()||i[a]()!=i}),j=e[a]=h?b(m):g[a];c&&(e[c]=j),d(d.P+d.F*h,"String",e)},m=l.trim=function(a,b){return a=String(e(a)),1&b&&(a=a.replace(j,"")),2&b&&(a=a.replace(k,"")),a};a.exports=l},function(a,b,d){var e=d(13),f=d(2),g="__core-js_shared__",h=f[g]||(f[g]={});(a.exports=function(a,b){return h[a]||(h[a]=b!==c?b:{})})("versions",[]).push({version:e.version,mode:d(32)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(a,b,c){var d=c(20);a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==d(a)?a.split(""):Object(a)}},function(a,b){b.f={}.propertyIsEnumerable},function(a,b,d){var e=d(34),f=d(5)("iterator"),g=d(40);a.exports=d(13).getIteratorMethod=function(a){if(a!=c)return a[f]||a["@@iterator"]||g[e(a)]}},function(a,b,c){var d=c(1);a.exports=function(){var a=d(this),b="";return a.global&&(b+="g"),a.ignoreCase&&(b+="i"),a.multiline&&(b+="m"),a.unicode&&(b+="u"),a.sticky&&(b+="y"),b}},function(a,b,d){var e=d(1),f=d(10),g=d(5)("species");a.exports=function(a,b){var d,h=e(a).constructor;return h===c||(d=e(h)[g])==c?b:f(d)}},function(a,b,c){var d=c(11),e=c(6),f=c(38);a.exports=function(a){return function(b,c,g){var h,i=d(b),j=e(i.length),k=f(g,j);if(a&&c!=c){for(;j>k;)if(h=i[k++],h!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===c)return a||k||0;return!a&&-1}}},function(a,b){b.f=Object.getOwnPropertySymbols},function(a,b,c){var d=c(20);a.exports=Array.isArray||function(a){return"Array"==d(a)}},function(a,b,d){var e=d(21),f=d(24);a.exports=function(a){return function(b,d){var g,h,i=String(f(b)),j=e(d),k=i.length;return j<0||j>=k?a?"":c:(g=i.charCodeAt(j),g<55296||g>56319||j+1===k||(h=i.charCodeAt(j+1))<56320||h>57343?a?i.charAt(j):g:a?i.slice(j,j+2):(g-55296<<10)+(h-56320)+65536)}}},function(a,b,d){var e=d(3),f=d(20),g=d(5)("match");a.exports=function(a){var b;return e(a)&&((b=a[g])!==c?!!b:"RegExp"==f(a))}},function(a,b,d){var e=d(32),f=d(0),g=d(15),h=d(14),i=d(40),j=d(59),k=d(45),l=d(17),m=d(5)("iterator"),n=!([].keys&&"next"in[].keys()),o="@@iterator",p="keys",q="values",r=function(){return this};a.exports=function(a,b,d,s,t,u,v){j(d,b,s);var w,x,y,z=function(a){if(!n&&a in D)return D[a];switch(a){case p:return function(){return new d(this,a)};case q:return function(){return new d(this,a)}}return function(){return new d(this,a)}},A=b+" Iterator",B=t==q,C=!1,D=a.prototype,E=D[m]||D[o]||t&&D[t],F=E||z(t),G=t?B?z("entries"):F:c,H="Array"==b?D.entries||E:E;if(H&&(y=l(H.call(new a)),y!==Object.prototype&&y.next&&(k(y,A,!0),e||"function"==typeof y[m]||h(y,m,r))),B&&E&&E.name!==q&&(C=!0,F=function(){return E.call(this)}),e&&!v||!n&&!C&&D[m]||h(D,m,F),i[b]=F,i[A]=r,t)if(w={values:B?F:z(q),keys:u?F:z(p),entries:G},v)for(x in w)x in D||g(D,x,w[x]);else f(f.P+f.F*(n||C),b,w);return w}},function(a,b,c){var d=c(28),e=c(31),f=c(45),g={};c(14)(g,c(5)("iterator"),function(){return this}),a.exports=function(a,b,c){a.prototype=d(g,{next:e(1,c)}),f(a,b+" Iterator")}},function(a,b,c){var d=c(5)("iterator"),e=!1;try{var f=[7][d]();f["return"]=function(){e=!0},Array.from(f,function(){throw 2})}catch(g){}a.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{var f=[7],g=f[d]();g.next=function(){return{done:c=!0}},f[d]=function(){return g},a(f)}catch(h){}return c}},function(a,b,c){var d=c(34),e=RegExp.prototype.exec;a.exports=function(a,b){var c=a.exec;if("function"==typeof c){var f=c.call(a,b);if("object"!=typeof f)throw new TypeError("RegExp exec method returned something other than an Object or null");return f}if("RegExp"!==d(a))throw new TypeError("RegExp#exec called on incompatible receiver");return e.call(a,b)}},function(a,b,d){d(114);var e=d(15),f=d(14),g=d(4),h=d(24),i=d(5),j=d(90),k=i("species"),l=!g(function(){var a=/./;return a.exec=function(){var a=[];return a.groups={a:"7"},a},"7"!=="".replace(a,"$<a>")}),m=function(){var a=/(?:)/,b=a.exec;a.exec=function(){return b.apply(this,arguments)};var c="ab".split(a);return 2===c.length&&"a"===c[0]&&"b"===c[1]}();a.exports=function(a,b,d){var n=i(a),o=!g(function(){var b={};return b[n]=function(){return 7},7!=""[a](b)}),p=o?!g(function(){var b=!1,c=/a/;return c.exec=function(){return b=!0,null},"split"===a&&(c.constructor={},c.constructor[k]=function(){return c}),c[n](""),!b}):c;if(!o||!p||"replace"===a&&!l||"split"===a&&!m){var q=/./[n],r=d(h,n,""[a],function(a,b,c,d,e){return b.exec===j?o&&!e?{done:!0,value:q.call(b,c,d)}:{done:!0,value:a.call(c,b,d)}:{done:!1}}),s=r[0],t=r[1];e(String.prototype,a,s),f(RegExp.prototype,n,2==b?function(a,b){return t.call(a,this,b)}:function(a){return t.call(a,this)})}}},function(a,b,c){var d=c(2),e=d.navigator;a.exports=e&&e.userAgent||""},function(a,b,d){var e=d(2),f=d(0),g=d(15),h=d(43),i=d(33),j=d(36),k=d(42),l=d(3),m=d(4),n=d(60),o=d(45),p=d(77);a.exports=function(a,b,d,q,r,s){var t=e[a],u=t,v=r?"set":"add",w=u&&u.prototype,x={},y=function(a){var b=w[a];g(w,a,"delete"==a?function(a){return!(s&&!l(a))&&b.call(this,0===a?0:a)}:"has"==a?function(a){return!(s&&!l(a))&&b.call(this,0===a?0:a)}:"get"==a?function(a){return s&&!l(a)?c:b.call(this,0===a?0:a)}:"add"==a?function(a){return b.call(this,0===a?0:a),this}:function(a,c){return b.call(this,0===a?0:a,c),this})};if("function"==typeof u&&(s||w.forEach&&!m(function(){(new u).entries().next()}))){var z=new u,A=z[v](s?{}:-0,1)!=z,B=m(function(){z.has(1)}),C=n(function(a){new u(a)}),D=!s&&m(function(){for(var a=new u,b=5;b--;)a[v](b,b);return!a.has(-0)});C||(u=b(function(b,d){k(b,u,a);var e=p(new t,b,u);return d!=c&&j(d,r,e[v],e),e}),u.prototype=w,w.constructor=u),(B||D)&&(y("delete"),y("has"),r&&y("get")),(D||A)&&y(v),s&&w.clear&&delete w.clear}else u=q.getConstructor(b,a,r,v),h(u.prototype,d),i.NEED=!0;return o(u,a),x[a]=u,f(f.G+f.W+f.F*(u!=t),x),s||q.setStrong(u,a,r),u}},function(a,b,c){for(var d,e=c(2),f=c(14),g=c(37),h=g("typed_array"),i=g("view"),j=!(!e.ArrayBuffer||!e.DataView),k=j,l=0,m=9,n="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<m;)(d=e[n[l++]])?(f(d.prototype,h,!0),f(d.prototype,i,!0)):k=!1;a.exports={ABV:j,CONSTR:k,TYPED:h,VIEW:i}},function(a,b,c){a.exports=c(32)||!c(4)(function(){var a=Math.random();__defineSetter__.call(null,a,function(){}),delete c(2)[a]})},function(a,b,c){var d=c(0);a.exports=function(a){d(d.S,a,{of:function(){for(var a=arguments.length,b=new Array(a);a--;)b[a]=arguments[a];return new this(b)}})}},function(a,b,d){var e=d(0),f=d(10),g=d(19),h=d(36);a.exports=function(a){e(e.S,a,{from:function(a){var b,d,e,i,j=arguments[1];return f(this),b=j!==c,b&&f(j),a==c?new this:(d=[],b?(e=0,i=g(j,arguments[2],2),h(a,!1,function(a){d.push(i(a,e++))})):h(a,!1,d.push,d),new this(d))}})}},function(a,b,c){var d=c(3),e=c(2).document,f=d(e)&&d(e.createElement);a.exports=function(a){return f?e.createElement(a):{}}},function(a,b,c){var d=c(2),e=c(13),f=c(32),g=c(99),h=c(7).f;a.exports=function(a){var b=e.Symbol||(e.Symbol=f?{}:d.Symbol||{});"_"==a.charAt(0)||a in b||h(b,a,{value:g.f(a)})}},function(a,b,c){var d=c(47)("keys"),e=c(37);a.exports=function(a){return d[a]||(d[a]=e(a))}},function(a,b){a.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(a,b,c){var d=c(2).document;a.exports=d&&d.documentElement},function(a,b,c){var d=c(27),e=c(54),f=c(49),g=c(9),h=c(48),i=Object.assign;a.exports=!i||c(4)(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=i({},a)[c]||Object.keys(i({},b)).join("")!=d})?function(a,b){for(var c=g(a),i=arguments.length,j=1,k=e.f,l=f.f;i>j;)for(var m,n=h(arguments[j++]),o=k?d(n).concat(k(n)):d(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(c[m]=n[m]);return c}:i},function(a,b,d){var e=d(3),f=d(1),g=function(a,b){if(f(a),!e(b)&&null!==b)throw TypeError(b+": can't set as prototype!")};a.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=d(19)(Function.call,d(16).f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(e){b=!0}return function(a,d){return g(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):c),check:g}},function(a,b){a.exports=function(a,b,d){var e=d===c;switch(b.length){case 0:return e?a():a.call(d);case 1:return e?a(b[0]):a.call(d,b[0]);case 2:return e?a(b[0],b[1]):a.call(d,b[0],b[1]);case 3:return e?a(b[0],b[1],b[2]):a.call(d,b[0],b[1],b[2]);case 4:return e?a(b[0],b[1],b[2],b[3]):a.call(d,b[0],b[1],b[2],b[3])}return a.apply(d,b)}},function(a,b,c){var d=c(3),e=c(75).set;a.exports=function(a,b,c){var f,g=b.constructor;return g!==c&&"function"==typeof g&&(f=g.prototype)!==c.prototype&&d(f)&&e&&e(a,f),a}},function(a,b){a.exports="\t\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff"},function(a,b,c){var d=c(21),e=c(24);a.exports=function(a){var b=String(e(this)),c="",f=d(a);if(f<0||f==1/0)throw RangeError("Count can't be negative");for(;f>0;(f>>>=1)&&(b+=b))1&f&&(c+=b);return c}},function(a,b){a.exports=Math.sign||function(a){return 0==(a=+a)||a!=a?a:a<0?-1:1}},function(a,b){var c=Math.expm1;a.exports=!c||c(10)>22025.465794806718||c(10)<22025.465794806718||c(-2e-17)!=-2e-17?function(a){return 0==(a=+a)?a:a>-1e-6&&a<1e-6?a+a*a/2:Math.exp(a)-1}:c},function(a,b,c){var d=c(57),e=c(24);a.exports=function(a,b,c){if(d(b))throw TypeError("String#"+c+" doesn't accept regex!");return String(e(a))}},function(a,b,c){var d=c(5)("match");a.exports=function(a){var b=/./;try{"/./"[a](b)}catch(c){try{return b[d]=!1,!"/./"[a](b)}catch(e){}}return!0}},function(a,b,d){var e=d(40),f=d(5)("iterator"),g=Array.prototype;a.exports=function(a){return a!==c&&(e.Array===a||g[f]===a)}},function(a,b,c){var d=c(7),e=c(31);a.exports=function(a,b,c){b in a?d.f(a,b,e(0,c)):a[b]=c}},function(a,b,c){var d=c(218);a.exports=function(a,b){return new(d(a))(b)}},function(a,b,d){var e=d(9),f=d(38),g=d(6);a.exports=function(a){for(var b=e(this),d=g(b.length),h=arguments.length,i=f(h>1?arguments[1]:c,d),j=h>2?arguments[2]:c,k=j===c?d:f(j,d);k>i;)b[i++]=a;return b}},function(a,b,d){var e=d(35),f=d(89),g=d(40),h=d(11);a.exports=d(58)(Array,"Array",function(a,b){this._t=h(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,d=this._i++;return!a||d>=a.length?(this._t=c,f(1)):"keys"==b?f(0,d):"values"==b?f(0,a[d]):f(0,[d,a[d]])},"values"),g.Arguments=g.Array,e("keys"),e("values"),e("entries")},function(a,b){a.exports=function(a,b){return{value:b,done:!!a}}},function(a,b,d){var e=d(51),f=RegExp.prototype.exec,g=String.prototype.replace,h=f,i="lastIndex",j=function(){var a=/a/,b=/b*/g;return f.call(a,"a"),f.call(b,"a"),0!==a[i]||0!==b[i]}(),k=/()??/.exec("")[1]!==c,l=j||k;l&&(h=function(a){var b,d,h,l,m=this;return k&&(d=new RegExp("^"+m.source+"$(?!\\s)",e.call(m))),j&&(b=m[i]),h=f.call(m,a),j&&h&&(m[i]=m.global?h.index+h[0].length:b),k&&h&&h.length>1&&g.call(h[0],d,function(){for(l=1;l<arguments.length-2;l++)arguments[l]===c&&(h[l]=c)}),h}),a.exports=h},function(a,b,c){var d=c(56)(!0);a.exports=function(a,b,c){return b+(c?d(a,b).length:1)}},function(a,b,c){var d,e,f,g=c(19),h=c(76),i=c(73),j=c(69),k=c(2),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=k.Dispatch,q=0,r={},s="onreadystatechange",t=function(){var a=+this;if(r.hasOwnProperty(a)){var b=r[a];delete r[a],b()}},u=function(a){t.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return r[++q]=function(){h("function"==typeof a?a:Function(a),b)},d(q),q},n=function(a){delete r[a]},"process"==c(20)(l)?d=function(a){l.nextTick(g(t,a,1))}:p&&p.now?d=function(a){p.now(g(t,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=u,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",u,!1)):d=s in j("script")?function(a){i.appendChild(j("script"))[s]=function(){i.removeChild(this),t.call(a)}}:function(a){setTimeout(g(t,a,1),0)}),a.exports={set:m,clear:n}},function(a,b,d){var e=d(2),f=d(92).set,g=e.MutationObserver||e.WebKitMutationObserver,h=e.process,i=e.Promise,j="process"==d(20)(h);a.exports=function(){var a,b,d,k=function(){var e,f;for(j&&(e=h.domain)&&e.exit();a;){f=a.fn,a=a.next;try{f()}catch(g){throw a?d():b=c,g}}b=c,e&&e.enter()};if(j)d=function(){h.nextTick(k)};else if(!g||e.navigator&&e.navigator.standalone)if(i&&i.resolve){var l=i.resolve(c);d=function(){l.then(k)}}else d=function(){f.call(e,k)};else{var m=!0,n=document.createTextNode("");new g(k).observe(n,{characterData:!0}),d=function(){n.data=m=!m}}return function(e){var f={fn:e,next:c};b&&(b.next=f),a||(a=f,d()),b=f}}},function(a,b,d){function e(a){var b,d;this.promise=new a(function(a,e){if(b!==c||d!==c)throw TypeError("Bad Promise constructor");b=a,d=e}),this.resolve=f(b),this.reject=f(d)}var f=d(10);a.exports.f=function(a){return new e(a)}},function(a,b,c){var d=c(39),e=c(54),f=c(1),g=c(2).Reflect;a.exports=g&&g.ownKeys||function(a){var b=d.f(f(a)),c=e.f;return c?b.concat(c(a)):b}},function(a,b,d){function e(a,b,c){var d,e,f,g=new Array(c),h=8*c-b-1,i=(1<<h)-1,j=i>>1,k=23===b?Q(2,-24)-Q(2,-77):0,l=0,m=a<0||0===a&&1/a<0?1:0;for(a=P(a),a!=a||a===N?(e=a!=a?1:0,d=i):(d=R(S(a)/T),a*(f=Q(2,-d))<1&&(d--,f*=2),a+=d+j>=1?k/f:k*Q(2,1-j),a*f>=2&&(d++,f/=2),d+j>=i?(e=0,d=i):d+j>=1?(e=(a*f-1)*Q(2,b),d+=j):(e=a*Q(2,j-1)*Q(2,b),d=0));b>=8;g[l++]=255&e,e/=256,b-=8);for(d=d<<b|e,h+=b;h>0;g[l++]=255&d,d/=256,h-=8);return g[--l]|=128*m,g}function f(a,b,c){var d,e=8*c-b-1,f=(1<<e)-1,g=f>>1,h=e-7,i=c-1,j=a[i--],k=127&j;for(j>>=7;h>0;k=256*k+a[i],i--,h-=8);for(d=k&(1<<-h)-1,k>>=-h,h+=b;h>0;d=256*d+a[i],i--,h-=8);if(0===k)k=1-g;else{if(k===f)return d?NaN:j?-N:N;d+=Q(2,b),k-=g}return(j?-1:1)*d*Q(2,k-b)}function g(a){return a[3]<<24|a[2]<<16|a[1]<<8|a[0]}function h(a){return[255&a]}function i(a){return[255&a,a>>8&255]}function j(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function k(a){return e(a,52,8)}function l(a){return e(a,23,4)}function m(a,b,c){B(a[G],b,{get:function(){return this[c]}})}function n(a,b,c,d){var e=+c,f=z(e);if(f+b>a[Y])throw M(I);var g=a[X]._b,h=f+a[Z],i=g.slice(h,h+b);return d?i:i.reverse()}function o(a,b,c,d,e,f){var g=+c,h=z(g);if(h+b>a[Y])throw M(I);for(var i=a[X]._b,j=h+a[Z],k=d(+e),l=0;l<b;l++)i[j+l]=k[f?l:b-l-1]}var p=d(2),q=d(8),r=d(32),s=d(65),t=d(14),u=d(43),v=d(4),w=d(42),x=d(21),y=d(6),z=d(123),A=d(39).f,B=d(7).f,C=d(87),D=d(45),E="ArrayBuffer",F="DataView",G="prototype",H="Wrong length!",I="Wrong index!",J=p[E],K=p[F],L=p.Math,M=p.RangeError,N=p.Infinity,O=J,P=L.abs,Q=L.pow,R=L.floor,S=L.log,T=L.LN2,U="buffer",V="byteLength",W="byteOffset",X=q?"_b":U,Y=q?"_l":V,Z=q?"_o":W;if(s.ABV){if(!v(function(){J(1)})||!v(function(){new J((-1))})||v(function(){return new J,new J(1.5),new J(NaN),J.name!=E})){J=function(a){return w(this,J),new O(z(a))};for(var $,_=J[G]=O[G],aa=A(O),ba=0;aa.length>ba;)($=aa[ba++])in J||t(J,$,O[$]);r||(_.constructor=J)}var ca=new K(new J(2)),da=K[G].setInt8;ca.setInt8(0,2147483648),ca.setInt8(1,2147483649),!ca.getInt8(0)&&ca.getInt8(1)||u(K[G],{setInt8:function(a,b){da.call(this,a,b<<24>>24)},setUint8:function(a,b){da.call(this,a,b<<24>>24)}},!0)}else J=function(a){w(this,J,E);var b=z(a);this._b=C.call(new Array(b),0),this[Y]=b},K=function(a,b,d){w(this,K,F),w(a,J,F);var e=a[Y],f=x(b);if(f<0||f>e)throw M("Wrong offset!");if(d=d===c?e-f:y(d),f+d>e)throw M(H);this[X]=a,this[Z]=f,this[Y]=d},q&&(m(J,V,"_l"),m(K,U,"_b"),m(K,V,"_l"),m(K,W,"_o")),u(K[G],{getInt8:function(a){return n(this,1,a)[0]<<24>>24},getUint8:function(a){return n(this,1,a)[0]},getInt16:function(a){var b=n(this,2,a,arguments[1]);return(b[1]<<8|b[0])<<16>>16},getUint16:function(a){var b=n(this,2,a,arguments[1]);return b[1]<<8|b[0]},getInt32:function(a){return g(n(this,4,a,arguments[1]))},getUint32:function(a){return g(n(this,4,a,arguments[1]))>>>0},getFloat32:function(a){return f(n(this,4,a,arguments[1]),23,4)},getFloat64:function(a){return f(n(this,8,a,arguments[1]),52,8)},setInt8:function(a,b){o(this,1,a,h,b)},setUint8:function(a,b){o(this,1,a,h,b)},setInt16:function(a,b){o(this,2,a,i,b,arguments[2])},setUint16:function(a,b){o(this,2,a,i,b,arguments[2])},setInt32:function(a,b){o(this,4,a,j,b,arguments[2])},setUint32:function(a,b){o(this,4,a,j,b,arguments[2])},setFloat32:function(a,b){o(this,4,a,l,b,arguments[2])},setFloat64:function(a,b){o(this,8,a,k,b,arguments[2]);
}});D(J,E),D(K,F),t(K[G],s.VIEW,!0),b[E]=J,b[F]=K},function(a,b){a.exports=function(a,b){var c=b===Object(b)?function(a){return b[a]}:b;return function(b){return String(b).replace(a,c)}}},function(a,b,c){a.exports=!c(8)&&!c(4)(function(){return 7!=Object.defineProperty(c(69)("div"),"a",{get:function(){return 7}}).a})},function(a,b,c){b.f=c(5)},function(a,b,c){var d=c(12),e=c(11),f=c(53)(!1),g=c(71)("IE_PROTO");a.exports=function(a,b){var c,h=e(a),i=0,j=[];for(c in h)c!=g&&d(h,c)&&j.push(c);for(;b.length>i;)d(h,c=b[i++])&&(~f(j,c)||j.push(c));return j}},function(a,b,c){var d=c(7),e=c(1),f=c(27);a.exports=c(8)?Object.defineProperties:function(a,b){e(a);for(var c,g=f(b),h=g.length,i=0;h>i;)d.f(a,c=g[i++],b[c]);return a}},function(a,b,c){var d=c(11),e=c(39).f,f={}.toString,g="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],h=function(a){try{return e(a)}catch(b){return g.slice()}};a.exports.f=function(a){return g&&"[object Window]"==f.call(a)?h(a):e(d(a))}},function(a,b){a.exports=Object.is||function(a,b){return a===b?0!==a||1/a===1/b:a!=a&&b!=b}},function(a,b,c){var d=c(10),e=c(3),f=c(76),g=[].slice,h={},i=function(a,b,c){if(!(b in h)){for(var d=[],e=0;e<b;e++)d[e]="a["+e+"]";h[b]=Function("F,a","return new F("+d.join(",")+")")}return h[b](a,c)};a.exports=Function.bind||function(a){var b=d(this),c=g.call(arguments,1),h=function(){var d=c.concat(g.call(arguments));return this instanceof h?i(b,d.length,d):f(b,d,a)};return e(b.prototype)&&(h.prototype=b.prototype),h}},function(a,b,c){var d=c(20);a.exports=function(a,b){if("number"!=typeof a&&"Number"!=d(a))throw TypeError(b);return+a}},function(a,b,c){var d=c(3),e=Math.floor;a.exports=function(a){return!d(a)&&isFinite(a)&&e(a)===a}},function(a,b,c){var d=c(2).parseFloat,e=c(46).trim;a.exports=1/d(c(78)+"-0")!==-(1/0)?function(a){var b=e(String(a),3),c=d(b);return 0===c&&"-"==b.charAt(0)?-0:c}:d},function(a,b,c){var d=c(2).parseInt,e=c(46).trim,f=c(78),g=/^[-+]?0[xX]/;a.exports=8!==d(f+"08")||22!==d(f+"0x16")?function(a,b){var c=e(String(a),3);return d(c,b>>>0||(g.test(c)?16:10))}:d},function(a,b){a.exports=Math.log1p||function(a){return(a=+a)>-1e-8&&a<1e-8?a-a*a/2:Math.log(1+a)}},function(a,b,c){var d=c(80),e=Math.pow,f=e(2,-52),g=e(2,-23),h=e(2,127)*(2-g),i=e(2,-126),j=function(a){return a+1/f-1/f};a.exports=Math.fround||function(a){var b,c,e=Math.abs(a),k=d(a);return e<i?k*j(e/i/g)*i*g:(b=(1+g/f)*e,c=b-(b-e),c>h||c!=c?k*(1/0):k*c)}},function(a,b,d){var e=d(1);a.exports=function(a,b,d,f){try{return f?b(e(d)[0],d[1]):b(d)}catch(g){var h=a["return"];throw h!==c&&e(h.call(a)),g}}},function(a,b,c){var d=c(10),e=c(9),f=c(48),g=c(6);a.exports=function(a,b,c,h,i){d(b);var j=e(a),k=f(j),l=g(j.length),m=i?l-1:0,n=i?-1:1;if(c<2)for(;;){if(m in k){h=k[m],m+=n;break}if(m+=n,i?m<0:l<=m)throw TypeError("Reduce of empty array with no initial value")}for(;i?m>=0:l>m;m+=n)m in k&&(h=b(h,k[m],m,j));return h}},function(a,b,d){var e=d(9),f=d(38),g=d(6);a.exports=[].copyWithin||function(a,b){var d=e(this),h=g(d.length),i=f(a,h),j=f(b,h),k=arguments.length>2?arguments[2]:c,l=Math.min((k===c?h:f(k,h))-j,h-i),m=1;for(j<i&&i<j+l&&(m=-1,j+=l-1,i+=l-1);l-- >0;)j in d?d[i]=d[j]:delete d[i],i+=m,j+=m;return d}},function(a,b,c){var d=c(90);c(0)({target:"RegExp",proto:!0,forced:d!==/./.exec},{exec:d})},function(a,b,c){c(8)&&"g"!=/./g.flags&&c(7).f(RegExp.prototype,"flags",{configurable:!0,get:c(51)})},function(a,b){a.exports=function(a){try{return{e:!1,v:a()}}catch(b){return{e:!0,v:b}}}},function(a,b,c){var d=c(1),e=c(3),f=c(94);a.exports=function(a,b){if(d(a),e(b)&&b.constructor===a)return b;var c=f.f(a),g=c.resolve;return g(b),c.promise}},function(a,b,d){var e=d(119),f=d(44),g="Map";a.exports=d(64)(g,function(a){return function(){return a(this,arguments.length>0?arguments[0]:c)}},{get:function(a){var b=e.getEntry(f(this,g),a);return b&&b.v},set:function(a,b){return e.def(f(this,g),0===a?0:a,b)}},e,!0)},function(a,b,d){var e=d(7).f,f=d(28),g=d(43),h=d(19),i=d(42),j=d(36),k=d(58),l=d(89),m=d(41),n=d(8),o=d(33).fastKey,p=d(44),q=n?"_s":"size",r=function(a,b){var c,d=o(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c};a.exports={getConstructor:function(a,b,d,k){var l=a(function(a,e){i(a,l,b,"_i"),a._t=b,a._i=f(null),a._f=c,a._l=c,a[q]=0,e!=c&&j(e,d,a[k],a)});return g(l.prototype,{clear:function(){for(var a=p(this,b),d=a._i,e=a._f;e;e=e.n)e.r=!0,e.p&&(e.p=e.p.n=c),delete d[e.i];a._f=a._l=c,a[q]=0},"delete":function(a){var c=p(this,b),d=r(c,a);if(d){var e=d.n,f=d.p;delete c._i[d.i],d.r=!0,f&&(f.n=e),e&&(e.p=f),c._f==d&&(c._f=e),c._l==d&&(c._l=f),c[q]--}return!!d},forEach:function(a){p(this,b);for(var d,e=h(a,arguments.length>1?arguments[1]:c,3);d=d?d.n:this._f;)for(e(d.v,d.k,this);d&&d.r;)d=d.p},has:function(a){return!!r(p(this,b),a)}}),n&&e(l.prototype,"size",{get:function(){return p(this,b)[q]}}),l},def:function(a,b,d){var e,f,g=r(a,b);return g?g.v=d:(a._l=g={i:f=o(b,!0),k:b,v:d,p:e=a._l,n:c,r:!1},a._f||(a._f=g),e&&(e.n=g),a[q]++,"F"!==f&&(a._i[f]=g)),a},getEntry:r,setStrong:function(a,b,d){k(a,b,function(a,d){this._t=p(a,b),this._k=d,this._l=c},function(){for(var a=this,b=a._k,d=a._l;d&&d.r;)d=d.p;return a._t&&(a._l=d=d?d.n:a._t._f)?"keys"==b?l(0,d.k):"values"==b?l(0,d.v):l(0,[d.k,d.v]):(a._t=c,l(1))},d?"entries":"values",!d,!0),m(b)}}},function(a,b,d){var e=d(119),f=d(44),g="Set";a.exports=d(64)(g,function(a){return function(){return a(this,arguments.length>0?arguments[0]:c)}},{add:function(a){return e.def(f(this,g),a=0===a?0:a,a)}},e)},function(a,b,d){var e,f=d(2),g=d(26)(0),h=d(15),i=d(33),j=d(74),k=d(122),l=d(3),m=d(44),n=d(44),o=!f.ActiveXObject&&"ActiveXObject"in f,p="WeakMap",q=i.getWeak,r=Object.isExtensible,s=k.ufstore,t=function(a){return function(){return a(this,arguments.length>0?arguments[0]:c)}},u={get:function(a){if(l(a)){var b=q(a);return b===!0?s(m(this,p)).get(a):b?b[this._i]:c}},set:function(a,b){return k.def(m(this,p),a,b)}},v=a.exports=d(64)(p,t,u,k,!0,!0);n&&o&&(e=k.getConstructor(t,p),j(e.prototype,u),i.NEED=!0,g(["delete","has","get","set"],function(a){var b=v.prototype,c=b[a];h(b,a,function(b,d){if(l(b)&&!r(b)){this._f||(this._f=new e);var f=this._f[a](b,d);return"set"==a?this:f}return c.call(this,b,d)})}))},function(a,b,d){var e=d(43),f=d(33).getWeak,g=d(1),h=d(3),i=d(42),j=d(36),k=d(26),l=d(12),m=d(44),n=k(5),o=k(6),p=0,q=function(a){return a._l||(a._l=new r)},r=function(){this.a=[]},s=function(a,b){return n(a.a,function(a){return a[0]===b})};r.prototype={get:function(a){var b=s(this,a);if(b)return b[1]},has:function(a){return!!s(this,a)},set:function(a,b){var c=s(this,a);c?c[1]=b:this.a.push([a,b])},"delete":function(a){var b=o(this.a,function(b){return b[0]===a});return~b&&this.a.splice(b,1),!!~b}},a.exports={getConstructor:function(a,b,d,g){var k=a(function(a,e){i(a,k,b,"_i"),a._t=b,a._i=p++,a._l=c,e!=c&&j(e,d,a[g],a)});return e(k.prototype,{"delete":function(a){if(!h(a))return!1;var c=f(a);return c===!0?q(m(this,b))["delete"](a):c&&l(c,this._i)&&delete c[this._i]},has:function(a){if(!h(a))return!1;var c=f(a);return c===!0?q(m(this,b)).has(a):c&&l(c,this._i)}}),k},def:function(a,b,c){var d=f(g(b),!0);return d===!0?q(a).set(b,c):d[a._i]=c,a},ufstore:q}},function(a,b,d){var e=d(21),f=d(6);a.exports=function(a){if(a===c)return 0;var b=e(a),d=f(b);if(b!==d)throw RangeError("Wrong length!");return d}},function(a,b,d){function e(a,b,d,k,l,m,n,o){for(var p,q,r=l,s=0,t=!!n&&i(n,o,3);s<k;){if(s in d){if(p=t?t(d[s],s,b):d[s],q=!1,g(p)&&(q=p[j],q=q!==c?!!q:f(p)),q&&m>0)r=e(a,b,p,h(p.length),r,m-1)-1;else{if(r>=9007199254740991)throw TypeError();a[r]=p}r++}s++}return r}var f=d(55),g=d(3),h=d(6),i=d(19),j=d(5)("isConcatSpreadable");a.exports=e},function(a,b,d){var e=d(6),f=d(79),g=d(24);a.exports=function(a,b,d,h){var i=String(g(a)),j=i.length,k=d===c?" ":String(d),l=e(b);if(l<=j||""==k)return i;var m=l-j,n=f.call(k,Math.ceil(m/k.length));return n.length>m&&(n=n.slice(0,m)),h?n+i:i+n}},function(a,b,c){var d=c(27),e=c(11),f=c(49).f;a.exports=function(a){return function(b){for(var c,g=e(b),h=d(g),i=h.length,j=0,k=[];i>j;)f.call(g,c=h[j++])&&k.push(a?[c,g[c]]:g[c]);return k}}},function(a,b,c){var d=c(34),e=c(128);a.exports=function(a){return function(){if(d(this)!=a)throw TypeError(a+"#toJSON isn't generic");return e(this)}}},function(a,b,c){var d=c(36);a.exports=function(a,b){var c=[];return d(a,!1,c.push,c,b),c}},function(a,b){a.exports=Math.scale||function(a,b,c,d,e){return 0===arguments.length||a!=a||b!=b||c!=c||d!=d||e!=e?NaN:a===1/0||a===-(1/0)?a:(a-b)*(e-d)/(c-b)+d}},function(a,b,d){var e=d(34),f=d(5)("iterator"),g=d(40);a.exports=d(13).isIterable=function(a){var b=Object(a);return b[f]!==c||"@@iterator"in b||g.hasOwnProperty(e(b))}},function(a,b,c){var d=c(132),e=c(76),f=c(10);a.exports=function(){for(var a=f(this),b=arguments.length,c=new Array(b),g=0,h=d._,i=!1;b>g;)(c[g]=arguments[g++])===h&&(i=!0);return function(){var d,f=this,g=arguments.length,j=0,k=0;if(!i&&!g)return e(a,c,f);if(d=c.slice(),i)for(;b>j;j++)d[j]===h&&(d[j]=arguments[k++]);for(;g>k;)d.push(arguments[k++]);return e(a,d,f)}}},function(a,b,c){a.exports=c(2)},function(a,b,c){var d=c(7),e=c(16),f=c(95),g=c(11);a.exports=function(a,b){for(var c,h=f(g(b)),i=h.length,j=0;i>j;)d.f(a,c=h[j++],e.f(b,c));return a}},function(a,b,c){c(135),c(138),c(139),c(140),c(141),c(142),c(143),c(144),c(145),c(146),c(147),c(148),c(149),c(150),c(151),c(152),c(153),c(154),c(155),c(156),c(157),c(158),c(159),c(160),c(161),c(162),c(163),c(164),c(165),c(166),c(167),c(168),c(169),c(170),c(171),c(172),c(173),c(174),c(175),c(176),c(177),c(178),c(179),c(180),c(181),c(182),c(183),c(184),c(185),c(186),c(187),c(188),c(189),c(190),c(191),c(192),c(193),c(194),c(195),c(196),c(197),c(198),c(199),c(200),c(201),c(202),c(203),c(204),c(205),c(206),c(207),c(208),c(209),c(210),c(211),c(212),c(213),c(214),c(215),c(216),c(217),c(219),c(220),c(221),c(222),c(223),c(224),c(225),c(226),c(227),c(228),c(229),c(230),c(88),c(231),c(232),c(114),c(233),c(115),c(234),c(235),c(236),c(237),c(238),c(118),c(120),c(121),c(239),c(240),c(241),c(242),c(243),c(244),c(245),c(246),c(247),c(248),c(249),c(250),c(251),c(252),c(253),c(254),c(255),c(256),c(258),c(259),c(261),c(262),c(263),c(264),c(265),c(266),c(267),c(268),c(269),c(270),c(271),c(272),c(273),c(274),c(275),c(276),c(277),c(278),c(279),c(280),c(281),c(282),c(283),c(284),c(285),c(286),c(287),c(288),c(289),c(290),c(291),c(292),c(293),c(294),c(295),c(296),c(297),c(298),c(299),c(300),c(301),c(302),c(303),c(304),c(305),c(306),c(307),c(308),c(309),c(310),c(311),c(312),c(313),c(314),c(315),c(316),c(317),c(318),c(319),c(320),c(321),c(322),c(323),c(324),c(325),c(326),c(327),c(328),c(329),c(330),c(331),c(50),c(333),c(130),c(334),c(335),c(336),c(337),c(338),c(339),c(340),c(341),c(342),a.exports=c(343)},function(a,b,d){var e=d(2),f=d(12),g=d(8),h=d(0),i=d(15),j=d(33).KEY,k=d(4),l=d(47),m=d(45),n=d(37),o=d(5),p=d(99),q=d(70),r=d(137),s=d(55),t=d(1),u=d(3),v=d(11),w=d(23),x=d(31),y=d(28),z=d(102),A=d(16),B=d(7),C=d(27),D=A.f,E=B.f,F=z.f,G=e.Symbol,H=e.JSON,I=H&&H.stringify,J="prototype",K=o("_hidden"),L=o("toPrimitive"),M={}.propertyIsEnumerable,N=l("symbol-registry"),O=l("symbols"),P=l("op-symbols"),Q=Object[J],R="function"==typeof G,S=e.QObject,T=!S||!S[J]||!S[J].findChild,U=g&&k(function(){return 7!=y(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=D(Q,b);d&&delete Q[b],E(a,b,c),d&&a!==Q&&E(Q,b,d)}:E,V=function(a){var b=O[a]=y(G[J]);return b._k=a,b},W=R&&"symbol"==typeof G.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof G},X=function(a,b,c){return a===Q&&X(P,b,c),t(a),b=w(b,!0),t(c),f(O,b)?(c.enumerable?(f(a,K)&&a[K][b]&&(a[K][b]=!1),c=y(c,{enumerable:x(0,!1)})):(f(a,K)||E(a,K,x(1,{})),a[K][b]=!0),U(a,b,c)):E(a,b,c)},Y=function(a,b){t(a);for(var c,d=r(b=v(b)),e=0,f=d.length;f>e;)X(a,c=d[e++],b[c]);return a},Z=function(a,b){return b===c?y(a):Y(y(a),b)},$=function(a){var b=M.call(this,a=w(a,!0));return!(this===Q&&f(O,a)&&!f(P,a))&&(!(b||!f(this,a)||!f(O,a)||f(this,K)&&this[K][a])||b)},_=function(a,b){if(a=v(a),b=w(b,!0),a!==Q||!f(O,b)||f(P,b)){var c=D(a,b);return!c||!f(O,b)||f(a,K)&&a[K][b]||(c.enumerable=!0),c}},aa=function(a){for(var b,c=F(v(a)),d=[],e=0;c.length>e;)f(O,b=c[e++])||b==K||b==j||d.push(b);return d},ba=function(a){for(var b,c=a===Q,d=F(c?P:v(a)),e=[],g=0;d.length>g;)!f(O,b=d[g++])||c&&!f(Q,b)||e.push(O[b]);return e};R||(G=function(){if(this instanceof G)throw TypeError("Symbol is not a constructor!");var a=n(arguments.length>0?arguments[0]:c),b=function(c){this===Q&&b.call(P,c),f(this,K)&&f(this[K],a)&&(this[K][a]=!1),U(this,a,x(1,c))};return g&&T&&U(Q,a,{configurable:!0,set:b}),V(a)},i(G[J],"toString",function(){return this._k}),A.f=_,B.f=X,d(39).f=z.f=aa,d(49).f=$,d(54).f=ba,g&&!d(32)&&i(Q,"propertyIsEnumerable",$,!0),p.f=function(a){return V(o(a))}),h(h.G+h.W+h.F*!R,{Symbol:G});for(var ca="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),da=0;ca.length>da;)o(ca[da++]);for(var ea=C(o.store),fa=0;ea.length>fa;)q(ea[fa++]);h(h.S+h.F*!R,"Symbol",{"for":function(a){return f(N,a+="")?N[a]:N[a]=G(a)},keyFor:function(a){if(!W(a))throw TypeError(a+" is not a symbol!");for(var b in N)if(N[b]===a)return b},useSetter:function(){T=!0},useSimple:function(){T=!1}}),h(h.S+h.F*!R,"Object",{create:Z,defineProperty:X,defineProperties:Y,getOwnPropertyDescriptor:_,getOwnPropertyNames:aa,getOwnPropertySymbols:ba}),H&&h(h.S+h.F*(!R||k(function(){var a=G();return"[null]"!=I([a])||"{}"!=I({a:a})||"{}"!=I(Object(a))})),"JSON",{stringify:function(a){for(var b,d,e=[a],f=1;arguments.length>f;)e.push(arguments[f++]);if(d=b=e[1],(u(b)||a!==c)&&!W(a))return s(b)||(b=function(a,b){if("function"==typeof d&&(b=d.call(this,a,b)),!W(b))return b}),e[1]=b,I.apply(H,e)}}),G[J][L]||d(14)(G[J],L,G[J].valueOf),m(G,"Symbol"),m(Math,"Math",!0),m(e.JSON,"JSON",!0)},function(a,b,c){a.exports=c(47)("native-function-to-string",Function.toString)},function(a,b,c){var d=c(27),e=c(54),f=c(49);a.exports=function(a){var b=d(a),c=e.f;if(c)for(var g,h=c(a),i=f.f,j=0;h.length>j;)i.call(a,g=h[j++])&&b.push(g);return b}},function(a,b,c){var d=c(0);d(d.S+d.F*!c(8),"Object",{defineProperty:c(7).f})},function(a,b,c){var d=c(0);d(d.S+d.F*!c(8),"Object",{defineProperties:c(101)})},function(a,b,c){var d=c(11),e=c(16).f;c(25)("getOwnPropertyDescriptor",function(){return function(a,b){return e(d(a),b)}})},function(a,b,c){var d=c(0);d(d.S,"Object",{create:c(28)})},function(a,b,c){var d=c(9),e=c(17);c(25)("getPrototypeOf",function(){return function(a){return e(d(a))}})},function(a,b,c){var d=c(9),e=c(27);c(25)("keys",function(){return function(a){return e(d(a))}})},function(a,b,c){c(25)("getOwnPropertyNames",function(){return c(102).f})},function(a,b,c){var d=c(3),e=c(33).onFreeze;c(25)("freeze",function(a){return function(b){return a&&d(b)?a(e(b)):b}})},function(a,b,c){var d=c(3),e=c(33).onFreeze;c(25)("seal",function(a){return function(b){return a&&d(b)?a(e(b)):b}})},function(a,b,c){var d=c(3),e=c(33).onFreeze;c(25)("preventExtensions",function(a){return function(b){return a&&d(b)?a(e(b)):b}})},function(a,b,c){var d=c(3);c(25)("isFrozen",function(a){return function(b){return!d(b)||!!a&&a(b)}})},function(a,b,c){var d=c(3);c(25)("isSealed",function(a){return function(b){return!d(b)||!!a&&a(b)}})},function(a,b,c){var d=c(3);c(25)("isExtensible",function(a){return function(b){return!!d(b)&&(!a||a(b))}})},function(a,b,c){var d=c(0);d(d.S+d.F,"Object",{assign:c(74)})},function(a,b,c){var d=c(0);d(d.S,"Object",{is:c(103)})},function(a,b,c){var d=c(0);d(d.S,"Object",{setPrototypeOf:c(75).set})},function(a,b,c){var d=c(34),e={};e[c(5)("toStringTag")]="z",e+""!="[object z]"&&c(15)(Object.prototype,"toString",function(){return"[object "+d(this)+"]"},!0)},function(a,b,c){var d=c(0);d(d.P,"Function",{bind:c(104)})},function(a,b,c){var d=c(7).f,e=Function.prototype,f=/^\s*function ([^ (]*)/,g="name";g in e||c(8)&&d(e,g,{configurable:!0,get:function(){try{return(""+this).match(f)[1]}catch(a){return""}}})},function(a,b,c){var d=c(3),e=c(17),f=c(5)("hasInstance"),g=Function.prototype;f in g||c(7).f(g,f,{value:function(a){if("function"!=typeof this||!d(a))return!1;if(!d(this.prototype))return a instanceof this;for(;a=e(a);)if(this.prototype===a)return!0;return!1}})},function(a,b,c){var d=c(2),e=c(12),f=c(20),g=c(77),h=c(23),i=c(4),j=c(39).f,k=c(16).f,l=c(7).f,m=c(46).trim,n="Number",o=d[n],p=o,q=o.prototype,r=f(c(28)(q))==n,s="trim"in String.prototype,t=function(a){var b=h(a,!1);if("string"==typeof b&&b.length>2){b=s?b.trim():m(b,3);var c,d,e,f=b.charCodeAt(0);if(43===f||45===f){if(c=b.charCodeAt(2),88===c||120===c)return NaN}else if(48===f){switch(b.charCodeAt(1)){case 66:case 98:d=2,e=49;break;case 79:case 111:d=8,e=55;break;default:return+b}for(var g,i=b.slice(2),j=0,k=i.length;j<k;j++)if(g=i.charCodeAt(j),g<48||g>e)return NaN;return parseInt(i,d)}}return+b};if(!o(" 0o1")||!o("0b1")||o("+0x1")){o=function(a){var b=arguments.length<1?0:a,c=this;return c instanceof o&&(r?i(function(){q.valueOf.call(c)}):f(c)!=n)?g(new p(t(b)),c,o):t(b)};for(var u,v=c(8)?j(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;v.length>w;w++)e(p,u=v[w])&&!e(o,u)&&l(o,u,k(p,u));o.prototype=q,q.constructor=o,c(15)(d,n,o)}},function(a,b,c){var d=c(0),e=c(21),f=c(105),g=c(79),h=1..toFixed,i=Math.floor,j=[0,0,0,0,0,0],k="Number.toFixed: incorrect invocation!",l="0",m=function(a,b){for(var c=-1,d=b;++c<6;)d+=a*j[c],j[c]=d%1e7,d=i(d/1e7)},n=function(a){for(var b=6,c=0;--b>=0;)c+=j[b],j[b]=i(c/a),c=c%a*1e7},o=function(){for(var a=6,b="";--a>=0;)if(""!==b||0===a||0!==j[a]){var c=String(j[a]);b=""===b?c:b+g.call(l,7-c.length)+c}return b},p=function(a,b,c){return 0===b?c:b%2===1?p(a,b-1,c*a):p(a*a,b/2,c)},q=function(a){for(var b=0,c=a;c>=4096;)b+=12,c/=4096;for(;c>=2;)b+=1,c/=2;return b};d(d.P+d.F*(!!h&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!c(4)(function(){h.call({})})),"Number",{toFixed:function(a){var b,c,d,h,i=f(this,k),j=e(a),r="",s=l;if(j<0||j>20)throw RangeError(k);if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(r="-",i=-i),i>1e-21)if(b=q(i*p(2,69,1))-69,c=b<0?i*p(2,-b,1):i/p(2,b,1),c*=4503599627370496,b=52-b,b>0){for(m(0,c),d=j;d>=7;)m(1e7,0),d-=7;for(m(p(10,d,1),0),d=b-1;d>=23;)n(1<<23),d-=23;n(1<<d),m(1,1),n(2),s=o()}else m(0,c),m(1<<-b,0),s=o()+g.call(l,j);return j>0?(h=s.length,s=r+(h<=j?"0."+g.call(l,j-h)+s:s.slice(0,h-j)+"."+s.slice(h-j))):s=r+s,s}})},function(a,b,d){var e=d(0),f=d(4),g=d(105),h=1..toPrecision;e(e.P+e.F*(f(function(){return"1"!==h.call(1,c)})||!f(function(){h.call({})})),"Number",{toPrecision:function(a){var b=g(this,"Number#toPrecision: incorrect invocation!");return a===c?h.call(b):h.call(b,a)}})},function(a,b,c){var d=c(0);d(d.S,"Number",{EPSILON:Math.pow(2,-52)})},function(a,b,c){var d=c(0),e=c(2).isFinite;d(d.S,"Number",{isFinite:function(a){return"number"==typeof a&&e(a)}})},function(a,b,c){var d=c(0);d(d.S,"Number",{isInteger:c(106)})},function(a,b,c){var d=c(0);d(d.S,"Number",{isNaN:function(a){return a!=a}})},function(a,b,c){var d=c(0),e=c(106),f=Math.abs;d(d.S,"Number",{isSafeInteger:function(a){return e(a)&&f(a)<=9007199254740991}})},function(a,b,c){var d=c(0);d(d.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(a,b,c){var d=c(0);d(d.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(a,b,c){var d=c(0),e=c(107);d(d.S+d.F*(Number.parseFloat!=e),"Number",{parseFloat:e})},function(a,b,c){var d=c(0),e=c(108);d(d.S+d.F*(Number.parseInt!=e),"Number",{parseInt:e})},function(a,b,c){var d=c(0),e=c(108);d(d.G+d.F*(parseInt!=e),{parseInt:e})},function(a,b,c){var d=c(0),e=c(107);d(d.G+d.F*(parseFloat!=e),{parseFloat:e})},function(a,b,c){var d=c(0),e=c(109),f=Math.sqrt,g=Math.acosh;d(d.S+d.F*!(g&&710==Math.floor(g(Number.MAX_VALUE))&&g(1/0)==1/0),"Math",{acosh:function(a){return(a=+a)<1?NaN:a>94906265.62425156?Math.log(a)+Math.LN2:e(a-1+f(a-1)*f(a+1))}})},function(a,b,c){function d(a){return isFinite(a=+a)&&0!=a?a<0?-d(-a):Math.log(a+Math.sqrt(a*a+1)):a}var e=c(0),f=Math.asinh;e(e.S+e.F*!(f&&1/f(0)>0),"Math",{asinh:d})},function(a,b,c){var d=c(0),e=Math.atanh;d(d.S+d.F*!(e&&1/e(-0)<0),"Math",{atanh:function(a){return 0==(a=+a)?a:Math.log((1+a)/(1-a))/2}})},function(a,b,c){var d=c(0),e=c(80);d(d.S,"Math",{cbrt:function(a){return e(a=+a)*Math.pow(Math.abs(a),1/3)}})},function(a,b,c){var d=c(0);d(d.S,"Math",{clz32:function(a){return(a>>>=0)?31-Math.floor(Math.log(a+.5)*Math.LOG2E):32}})},function(a,b,c){var d=c(0),e=Math.exp;d(d.S,"Math",{cosh:function(a){return(e(a=+a)+e(-a))/2}})},function(a,b,c){var d=c(0),e=c(81);d(d.S+d.F*(e!=Math.expm1),"Math",{expm1:e})},function(a,b,c){var d=c(0);d(d.S,"Math",{fround:c(110)})},function(a,b,c){var d=c(0),e=Math.abs;d(d.S,"Math",{hypot:function(a,b){for(var c,d,f=0,g=0,h=arguments.length,i=0;g<h;)c=e(arguments[g++]),i<c?(d=i/c,f=f*d*d+1,i=c):c>0?(d=c/i,f+=d*d):f+=c;return i===1/0?1/0:i*Math.sqrt(f)}})},function(a,b,c){var d=c(0),e=Math.imul;d(d.S+d.F*c(4)(function(){return e(4294967295,5)!=-5||2!=e.length}),"Math",{imul:function(a,b){var c=65535,d=+a,e=+b,f=c&d,g=c&e;return 0|f*g+((c&d>>>16)*g+f*(c&e>>>16)<<16>>>0)}})},function(a,b,c){var d=c(0);d(d.S,"Math",{log10:function(a){return Math.log(a)*Math.LOG10E}})},function(a,b,c){var d=c(0);d(d.S,"Math",{log1p:c(109)})},function(a,b,c){var d=c(0);d(d.S,"Math",{log2:function(a){return Math.log(a)/Math.LN2}})},function(a,b,c){var d=c(0);d(d.S,"Math",{sign:c(80)})},function(a,b,c){var d=c(0),e=c(81),f=Math.exp;d(d.S+d.F*c(4)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function(a){return Math.abs(a=+a)<1?(e(a)-e(-a))/2:(f(a-1)-f(-a-1))*(Math.E/2)}})},function(a,b,c){var d=c(0),e=c(81),f=Math.exp;d(d.S,"Math",{tanh:function(a){var b=e(a=+a),c=e(-a);return b==1/0?1:c==1/0?-1:(b-c)/(f(a)+f(-a))}})},function(a,b,c){var d=c(0);d(d.S,"Math",{trunc:function(a){return(a>0?Math.floor:Math.ceil)(a)}})},function(a,b,c){var d=c(0),e=c(38),f=String.fromCharCode,g=String.fromCodePoint;d(d.S+d.F*(!!g&&1!=g.length),"String",{fromCodePoint:function(a){for(var b,c=[],d=arguments.length,g=0;d>g;){if(b=+arguments[g++],e(b,1114111)!==b)throw RangeError(b+" is not a valid code point");c.push(b<65536?f(b):f(((b-=65536)>>10)+55296,b%1024+56320))}return c.join("")}})},function(a,b,c){var d=c(0),e=c(11),f=c(6);d(d.S,"String",{raw:function(a){for(var b=e(a.raw),c=f(b.length),d=arguments.length,g=[],h=0;c>h;)g.push(String(b[h++])),h<d&&g.push(String(arguments[h]));return g.join("")}})},function(a,b,c){c(46)("trim",function(a){return function(){return a(this,3)}})},function(a,b,c){var d=c(0),e=c(56)(!1);d(d.P,"String",{codePointAt:function(a){return e(this,a)}})},function(a,b,d){var e=d(0),f=d(6),g=d(82),h="endsWith",i=""[h];e(e.P+e.F*d(83)(h),"String",{endsWith:function(a){var b=g(this,a,h),d=arguments.length>1?arguments[1]:c,e=f(b.length),j=d===c?e:Math.min(f(d),e),k=String(a);return i?i.call(b,k,j):b.slice(j-k.length,j)===k}})},function(a,b,d){var e=d(0),f=d(82),g="includes";e(e.P+e.F*d(83)(g),"String",{includes:function(a){return!!~f(this,a,g).indexOf(a,arguments.length>1?arguments[1]:c)}})},function(a,b,c){var d=c(0);d(d.P,"String",{repeat:c(79)})},function(a,b,d){var e=d(0),f=d(6),g=d(82),h="startsWith",i=""[h];e(e.P+e.F*d(83)(h),"String",{startsWith:function(a){var b=g(this,a,h),d=f(Math.min(arguments.length>1?arguments[1]:c,b.length)),e=String(a);return i?i.call(b,e,d):b.slice(d,d+e.length)===e}})},function(a,b,d){var e=d(56)(!0);d(58)(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,d=this._i;return d>=b.length?{value:c,done:!0}:(a=e(b,d),this._i+=a.length,{value:a,done:!1})})},function(a,b,c){c(18)("anchor",function(a){return function(b){return a(this,"a","name",b)}})},function(a,b,c){c(18)("big",function(a){return function(){return a(this,"big","","")}})},function(a,b,c){c(18)("blink",function(a){return function(){return a(this,"blink","","")}})},function(a,b,c){c(18)("bold",function(a){return function(){return a(this,"b","","")}})},function(a,b,c){c(18)("fixed",function(a){return function(){return a(this,"tt","","")}})},function(a,b,c){c(18)("fontcolor",function(a){return function(b){return a(this,"font","color",b)}})},function(a,b,c){c(18)("fontsize",function(a){return function(b){return a(this,"font","size",b)}})},function(a,b,c){c(18)("italics",function(a){return function(){return a(this,"i","","")}})},function(a,b,c){c(18)("link",function(a){return function(b){return a(this,"a","href",b)}})},function(a,b,c){c(18)("small",function(a){return function(){return a(this,"small","","")}})},function(a,b,c){c(18)("strike",function(a){return function(){return a(this,"strike","","")}})},function(a,b,c){c(18)("sub",function(a){return function(){return a(this,"sub","","")}})},function(a,b,c){c(18)("sup",function(a){return function(){return a(this,"sup","","")}})},function(a,b,c){var d=c(0);d(d.S,"Array",{isArray:c(55)})},function(a,b,d){var e=d(19),f=d(0),g=d(9),h=d(111),i=d(84),j=d(6),k=d(85),l=d(50);f(f.S+f.F*!d(60)(function(a){Array.from(a)}),"Array",{from:function(a){var b,d,f,m,n=g(a),o="function"==typeof this?this:Array,p=arguments.length,q=p>1?arguments[1]:c,r=q!==c,s=0,t=l(n);if(r&&(q=e(q,p>2?arguments[2]:c,2)),t==c||o==Array&&i(t))for(b=j(n.length),d=new o(b);b>s;s++)k(d,s,r?q(n[s],s):n[s]);else for(m=t.call(n),d=new o;!(f=m.next()).done;s++)k(d,s,r?h(m,q,[f.value,s],!0):f.value);return d.length=s,d}})},function(a,b,c){var d=c(0),e=c(85);d(d.S+d.F*c(4)(function(){function a(){}return!(Array.of.call(a)instanceof a)}),"Array",{of:function(){for(var a=0,b=arguments.length,c=new("function"==typeof this?this:Array)(b);b>a;)e(c,a,arguments[a++]);return c.length=b,c}})},function(a,b,d){var e=d(0),f=d(11),g=[].join;e(e.P+e.F*(d(48)!=Object||!d(22)(g)),"Array",{join:function(a){return g.call(f(this),a===c?",":a)}})},function(a,b,d){var e=d(0),f=d(73),g=d(20),h=d(38),i=d(6),j=[].slice;e(e.P+e.F*d(4)(function(){f&&j.call(f)}),"Array",{slice:function(a,b){var d=i(this.length),e=g(this);if(b=b===c?d:b,"Array"==e)return j.call(this,a,b);for(var f=h(a,d),k=h(b,d),l=i(k-f),m=new Array(l),n=0;n<l;n++)m[n]="String"==e?this.charAt(f+n):this[f+n];return m}})},function(a,b,d){var e=d(0),f=d(10),g=d(9),h=d(4),i=[].sort,j=[1,2,3];e(e.P+e.F*(h(function(){j.sort(c)})||!h(function(){j.sort(null)})||!d(22)(i)),"Array",{sort:function(a){return a===c?i.call(g(this)):i.call(g(this),f(a))}})},function(a,b,c){var d=c(0),e=c(26)(0),f=c(22)([].forEach,!0);d(d.P+d.F*!f,"Array",{forEach:function(a){return e(this,a,arguments[1])}})},function(a,b,d){var e=d(3),f=d(55),g=d(5)("species");a.exports=function(a){var b;return f(a)&&(b=a.constructor,"function"!=typeof b||b!==Array&&!f(b.prototype)||(b=c),e(b)&&(b=b[g],null===b&&(b=c))),b===c?Array:b}},function(a,b,c){var d=c(0),e=c(26)(1);d(d.P+d.F*!c(22)([].map,!0),"Array",{map:function(a){return e(this,a,arguments[1])}})},function(a,b,c){var d=c(0),e=c(26)(2);d(d.P+d.F*!c(22)([].filter,!0),"Array",{filter:function(a){return e(this,a,arguments[1])}})},function(a,b,c){var d=c(0),e=c(26)(3);d(d.P+d.F*!c(22)([].some,!0),"Array",{some:function(a){return e(this,a,arguments[1])}})},function(a,b,c){var d=c(0),e=c(26)(4);d(d.P+d.F*!c(22)([].every,!0),"Array",{every:function(a){return e(this,a,arguments[1])}})},function(a,b,c){var d=c(0),e=c(112);d(d.P+d.F*!c(22)([].reduce,!0),"Array",{reduce:function(a){return e(this,a,arguments.length,arguments[1],!1)}})},function(a,b,c){var d=c(0),e=c(112);d(d.P+d.F*!c(22)([].reduceRight,!0),"Array",{reduceRight:function(a){return e(this,a,arguments.length,arguments[1],!0)}})},function(a,b,c){var d=c(0),e=c(53)(!1),f=[].indexOf,g=!!f&&1/[1].indexOf(1,-0)<0;d(d.P+d.F*(g||!c(22)(f)),"Array",{indexOf:function(a){return g?f.apply(this,arguments)||0:e(this,a,arguments[1])}})},function(a,b,c){var d=c(0),e=c(11),f=c(21),g=c(6),h=[].lastIndexOf,i=!!h&&1/[1].lastIndexOf(1,-0)<0;d(d.P+d.F*(i||!c(22)(h)),"Array",{lastIndexOf:function(a){if(i)return h.apply(this,arguments)||0;var b=e(this),c=g(b.length),d=c-1;for(arguments.length>1&&(d=Math.min(d,f(arguments[1]))),d<0&&(d=c+d);d>=0;d--)if(d in b&&b[d]===a)return d||0;return-1}})},function(a,b,c){var d=c(0);d(d.P,"Array",{copyWithin:c(113)}),c(35)("copyWithin")},function(a,b,c){var d=c(0);d(d.P,"Array",{fill:c(87)}),c(35)("fill")},function(a,b,d){var e=d(0),f=d(26)(5),g="find",h=!0;g in[]&&Array(1)[g](function(){h=!1}),e(e.P+e.F*h,"Array",{find:function(a){return f(this,a,arguments.length>1?arguments[1]:c)}}),d(35)(g)},function(a,b,d){var e=d(0),f=d(26)(6),g="findIndex",h=!0;g in[]&&Array(1)[g](function(){h=!1}),e(e.P+e.F*h,"Array",{findIndex:function(a){return f(this,a,arguments.length>1?arguments[1]:c)}}),d(35)(g)},function(a,b,c){c(41)("Array")},function(a,b,d){var e=d(2),f=d(77),g=d(7).f,h=d(39).f,i=d(57),j=d(51),k=e.RegExp,l=k,m=k.prototype,n=/a/g,o=/a/g,p=new k(n)!==n;if(d(8)&&(!p||d(4)(function(){return o[d(5)("match")]=!1,k(n)!=n||k(o)==o||"/a/i"!=k(n,"i")}))){k=function(a,b){var d=this instanceof k,e=i(a),g=b===c;return!d&&e&&a.constructor===k&&g?a:f(p?new l(e&&!g?a.source:a,b):l((e=a instanceof k)?a.source:a,e&&g?j.call(a):b),d?this:m,k)};for(var q=(function(a){a in k||g(k,a,{configurable:!0,get:function(){return l[a]},set:function(b){l[a]=b}})}),r=h(l),s=0;r.length>s;)q(r[s++]);m.constructor=k,k.prototype=m,d(15)(e,"RegExp",k)}d(41)("RegExp")},function(a,b,d){d(115);var e=d(1),f=d(51),g=d(8),h="toString",i=/./[h],j=function(a){d(15)(RegExp.prototype,h,a,!0)};d(4)(function(){return"/a/b"!=i.call({source:"a",flags:"b"})})?j(function(){var a=e(this);return"/".concat(a.source,"/","flags"in a?a.flags:!g&&a instanceof RegExp?f.call(a):c)}):i.name!=h&&j(function(){return i.call(this)})},function(a,b,d){var e=d(1),f=d(6),g=d(91),h=d(61);d(62)("match",1,function(a,b,d,i){return[function(d){var e=a(this),f=d==c?c:d[b];return f!==c?f.call(d,e):new RegExp(d)[b](String(e))},function(a){var b=i(d,a,this);if(b.done)return b.value;var c=e(a),j=String(this);if(!c.global)return h(c,j);var k=c.unicode;c.lastIndex=0;for(var l,m=[],n=0;null!==(l=h(c,j));){var o=String(l[0]);m[n]=o,""===o&&(c.lastIndex=g(j,f(c.lastIndex),k)),n++}return 0===n?null:m}]})},function(a,b,d){var e=d(1),f=d(9),g=d(6),h=d(21),i=d(91),j=d(61),k=Math.max,l=Math.min,m=Math.floor,n=/\$([$&`']|\d\d?|<[^>]*>)/g,o=/\$([$&`']|\d\d?)/g,p=function(a){return a===c?a:String(a)};d(62)("replace",2,function(a,b,d,q){function r(a,b,e,g,h,i){var j=e+a.length,k=g.length,l=o;return h!==c&&(h=f(h),l=n),d.call(i,l,function(d,f){var i;switch(f.charAt(0)){case"$":return"$";case"&":return a;case"`":return b.slice(0,e);case"'":return b.slice(j);case"<":i=h[f.slice(1,-1)];break;default:var l=+f;if(0===l)return d;if(l>k){var n=m(l/10);return 0===n?d:n<=k?g[n-1]===c?f.charAt(1):g[n-1]+f.charAt(1):d}i=g[l-1]}return i===c?"":i})}return[function(e,f){var g=a(this),h=e==c?c:e[b];return h!==c?h.call(e,g,f):d.call(String(g),e,f)},function(a,b){var f=q(d,a,this,b);if(f.done)return f.value;var m=e(a),n=String(this),o="function"==typeof b;o||(b=String(b));var s=m.global;if(s){var t=m.unicode;m.lastIndex=0}for(var u=[];;){var v=j(m,n);if(null===v)break;if(u.push(v),!s)break;var w=String(v[0]);""===w&&(m.lastIndex=i(n,g(m.lastIndex),t))}for(var x="",y=0,z=0;z<u.length;z++){v=u[z];for(var A=String(v[0]),B=k(l(h(v.index),n.length),0),C=[],D=1;D<v.length;D++)C.push(p(v[D]));var E=v.groups;if(o){var F=[A].concat(C,B,n);E!==c&&F.push(E);var G=String(b.apply(c,F))}else G=r(A,n,B,C,E,b);B>=y&&(x+=n.slice(y,B)+G,y=B+A.length)}return x+n.slice(y)}]})},function(a,b,d){var e=d(1),f=d(103),g=d(61);d(62)("search",1,function(a,b,d,h){return[function(d){var e=a(this),f=d==c?c:d[b];return f!==c?f.call(d,e):new RegExp(d)[b](String(e))},function(a){var b=h(d,a,this);if(b.done)return b.value;var c=e(a),i=String(this),j=c.lastIndex;f(j,0)||(c.lastIndex=0);var k=g(c,i);return f(c.lastIndex,j)||(c.lastIndex=j),
null===k?-1:k.index}]})},function(a,b,d){var e=d(57),f=d(1),g=d(52),h=d(91),i=d(6),j=d(61),k=d(90),l=d(4),m=Math.min,n=[].push,o="split",p="length",q="lastIndex",r=4294967295,s=!l(function(){RegExp(r,"y")});d(62)("split",2,function(a,b,d,l){var t;return t="c"=="abbc"[o](/(b)*/)[1]||4!="test"[o](/(?:)/,-1)[p]||2!="ab"[o](/(?:ab)*/)[p]||4!="."[o](/(.?)(.?)/)[p]||"."[o](/()()/)[p]>1||""[o](/.?/)[p]?function(a,b){var f=String(this);if(a===c&&0===b)return[];if(!e(a))return d.call(f,a,b);for(var g,h,i,j=[],l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(a.sticky?"y":""),m=0,o=b===c?r:b>>>0,s=new RegExp(a.source,l+"g");(g=k.call(s,f))&&(h=s[q],!(h>m&&(j.push(f.slice(m,g.index)),g[p]>1&&g.index<f[p]&&n.apply(j,g.slice(1)),i=g[0][p],m=h,j[p]>=o)));)s[q]===g.index&&s[q]++;return m===f[p]?!i&&s.test("")||j.push(""):j.push(f.slice(m)),j[p]>o?j.slice(0,o):j}:"0"[o](c,0)[p]?function(a,b){return a===c&&0===b?[]:d.call(this,a,b)}:d,[function(d,e){var f=a(this),g=d==c?c:d[b];return g!==c?g.call(d,f,e):t.call(String(f),d,e)},function(a,b){var e=l(t,a,this,b,t!==d);if(e.done)return e.value;var k=f(a),n=String(this),o=g(k,RegExp),p=k.unicode,q=(k.ignoreCase?"i":"")+(k.multiline?"m":"")+(k.unicode?"u":"")+(s?"y":"g"),u=new o(s?k:"^(?:"+k.source+")",q),v=b===c?r:b>>>0;if(0===v)return[];if(0===n.length)return null===j(u,n)?[n]:[];for(var w=0,x=0,y=[];x<n.length;){u.lastIndex=s?x:0;var z,A=j(u,s?n:n.slice(x));if(null===A||(z=m(i(u.lastIndex+(s?0:x)),n.length))===w)x=h(n,x,p);else{if(y.push(n.slice(w,x)),y.length===v)return y;for(var B=1;B<=A.length-1;B++)if(y.push(A[B]),y.length===v)return y;x=w=z}}return y.push(n.slice(w)),y}]})},function(a,b,d){var e,f,g,h,i=d(32),j=d(2),k=d(19),l=d(34),m=d(0),n=d(3),o=d(10),p=d(42),q=d(36),r=d(52),s=d(92).set,t=d(93)(),u=d(94),v=d(116),w=d(63),x=d(117),y="Promise",z=j.TypeError,A=j.process,B=A&&A.versions,C=B&&B.v8||"",D=j[y],E="process"==l(A),F=function(){},G=f=u.f,H=!!function(){try{var a=D.resolve(1),b=(a.constructor={})[d(5)("species")]=function(a){a(F,F)};return(E||"function"==typeof PromiseRejectionEvent)&&a.then(F)instanceof b&&0!==C.indexOf("6.6")&&w.indexOf("Chrome/66")===-1}catch(c){}}(),I=function(a){var b;return!(!n(a)||"function"!=typeof(b=a.then))&&b},J=function(a,b){if(!a._n){a._n=!0;var c=a._c;t(function(){for(var d=a._v,e=1==a._s,f=0,g=function(b){var c,f,g,h=e?b.ok:b.fail,i=b.resolve,j=b.reject,k=b.domain;try{h?(e||(2==a._h&&M(a),a._h=1),h===!0?c=d:(k&&k.enter(),c=h(d),k&&(k.exit(),g=!0)),c===b.promise?j(z("Promise-chain cycle")):(f=I(c))?f.call(c,i,j):i(c)):j(d)}catch(l){k&&!g&&k.exit(),j(l)}};c.length>f;)g(c[f++]);a._c=[],a._n=!1,b&&!a._h&&K(a)})}},K=function(a){s.call(j,function(){var b,d,e,f=a._v,g=L(a);if(g&&(b=v(function(){E?A.emit("unhandledRejection",f,a):(d=j.onunhandledrejection)?d({promise:a,reason:f}):(e=j.console)&&e.error&&e.error("Unhandled promise rejection",f)}),a._h=E||L(a)?2:1),a._a=c,g&&b.e)throw b.v})},L=function(a){return 1!==a._h&&0===(a._a||a._c).length},M=function(a){s.call(j,function(){var b;E?A.emit("rejectionHandled",a):(b=j.onrejectionhandled)&&b({promise:a,reason:a._v})})},N=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),J(b,!0))},O=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw z("Promise can't be resolved itself");(b=I(a))?t(function(){var d={_w:c,_d:!1};try{b.call(a,k(O,d,1),k(N,d,1))}catch(e){N.call(d,e)}}):(c._v=a,c._s=1,J(c,!1))}catch(d){N.call({_w:c,_d:!1},d)}}};H||(D=function(a){p(this,D,y,"_h"),o(a),e.call(this);try{a(k(O,this,1),k(N,this,1))}catch(b){N.call(this,b)}},e=function(a){this._c=[],this._a=c,this._s=0,this._d=!1,this._v=c,this._h=0,this._n=!1},e.prototype=d(43)(D.prototype,{then:function(a,b){var d=G(r(this,D));return d.ok="function"!=typeof a||a,d.fail="function"==typeof b&&b,d.domain=E?A.domain:c,this._c.push(d),this._a&&this._a.push(d),this._s&&J(this,!1),d.promise},"catch":function(a){return this.then(c,a)}}),g=function(){var a=new e;this.promise=a,this.resolve=k(O,a,1),this.reject=k(N,a,1)},u.f=G=function(a){return a===D||a===h?new g(a):f(a)}),m(m.G+m.W+m.F*!H,{Promise:D}),d(45)(D,y),d(41)(y),h=d(13)[y],m(m.S+m.F*!H,y,{reject:function(a){var b=G(this),c=b.reject;return c(a),b.promise}}),m(m.S+m.F*(i||!H),y,{resolve:function(a){return x(i&&this===h?D:this,a)}}),m(m.S+m.F*!(H&&d(60)(function(a){D.all(a)["catch"](F)})),y,{all:function(a){var b=this,d=G(b),e=d.resolve,f=d.reject,g=v(function(){var d=[],g=0,h=1;q(a,!1,function(a){var i=g++,j=!1;d.push(c),h++,b.resolve(a).then(function(a){j||(j=!0,d[i]=a,--h||e(d))},f)}),--h||e(d)});return g.e&&f(g.v),d.promise},race:function(a){var b=this,c=G(b),d=c.reject,e=v(function(){q(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}})},function(a,b,d){var e=d(122),f=d(44),g="WeakSet";d(64)(g,function(a){return function(){return a(this,arguments.length>0?arguments[0]:c)}},{add:function(a){return e.def(f(this,g),a,!0)}},e,!1,!0)},function(a,b,c){var d=c(0),e=c(10),f=c(1),g=(c(2).Reflect||{}).apply,h=Function.apply;d(d.S+d.F*!c(4)(function(){g(function(){})}),"Reflect",{apply:function(a,b,c){var d=e(a),i=f(c);return g?g(d,b,i):h.call(d,b,i)}})},function(a,b,c){var d=c(0),e=c(28),f=c(10),g=c(1),h=c(3),i=c(4),j=c(104),k=(c(2).Reflect||{}).construct,l=i(function(){function a(){}return!(k(function(){},[],a)instanceof a)}),m=!i(function(){k(function(){})});d(d.S+d.F*(l||m),"Reflect",{construct:function(a,b){f(a),g(b);var c=arguments.length<3?a:f(arguments[2]);if(m&&!l)return k(a,b,c);if(a==c){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3])}var d=[null];return d.push.apply(d,b),new(j.apply(a,d))}var i=c.prototype,n=e(h(i)?i:Object.prototype),o=Function.apply.call(a,n,b);return h(o)?o:n}})},function(a,b,c){var d=c(7),e=c(0),f=c(1),g=c(23);e(e.S+e.F*c(4)(function(){Reflect.defineProperty(d.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(a,b,c){f(a),b=g(b,!0),f(c);try{return d.f(a,b,c),!0}catch(e){return!1}}})},function(a,b,c){var d=c(0),e=c(16).f,f=c(1);d(d.S,"Reflect",{deleteProperty:function(a,b){var c=e(f(a),b);return!(c&&!c.configurable)&&delete a[b]}})},function(a,b,d){var e=d(0),f=d(1),g=function(a){this._t=f(a),this._i=0;var b,c=this._k=[];for(b in a)c.push(b)};d(59)(g,"Object",function(){var a,b=this,d=b._k;do if(b._i>=d.length)return{value:c,done:!0};while(!((a=d[b._i++])in b._t));return{value:a,done:!1}}),e(e.S,"Reflect",{enumerate:function(a){return new g(a)}})},function(a,b,d){function e(a,b){var d,i,l=arguments.length<3?a:arguments[2];return k(a)===l?a[b]:(d=f.f(a,b))?h(d,"value")?d.value:d.get!==c?d.get.call(l):c:j(i=g(a))?e(i,b,l):void 0}var f=d(16),g=d(17),h=d(12),i=d(0),j=d(3),k=d(1);i(i.S,"Reflect",{get:e})},function(a,b,c){var d=c(16),e=c(0),f=c(1);e(e.S,"Reflect",{getOwnPropertyDescriptor:function(a,b){return d.f(f(a),b)}})},function(a,b,c){var d=c(0),e=c(17),f=c(1);d(d.S,"Reflect",{getPrototypeOf:function(a){return e(f(a))}})},function(a,b,c){var d=c(0);d(d.S,"Reflect",{has:function(a,b){return b in a}})},function(a,b,c){var d=c(0),e=c(1),f=Object.isExtensible;d(d.S,"Reflect",{isExtensible:function(a){return e(a),!f||f(a)}})},function(a,b,c){var d=c(0);d(d.S,"Reflect",{ownKeys:c(95)})},function(a,b,c){var d=c(0),e=c(1),f=Object.preventExtensions;d(d.S,"Reflect",{preventExtensions:function(a){e(a);try{return f&&f(a),!0}catch(b){return!1}}})},function(a,b,d){function e(a,b,d){var j,n,o=arguments.length<4?a:arguments[3],p=g.f(l(a),b);if(!p){if(m(n=h(a)))return e(n,b,d,o);p=k(0)}if(i(p,"value")){if(p.writable===!1||!m(o))return!1;if(j=g.f(o,b)){if(j.get||j.set||j.writable===!1)return!1;j.value=d,f.f(o,b,j)}else f.f(o,b,k(0,d));return!0}return p.set!==c&&(p.set.call(o,d),!0)}var f=d(7),g=d(16),h=d(17),i=d(12),j=d(0),k=d(31),l=d(1),m=d(3);j(j.S,"Reflect",{set:e})},function(a,b,c){var d=c(0),e=c(75);e&&d(d.S,"Reflect",{setPrototypeOf:function(a,b){e.check(a,b);try{return e.set(a,b),!0}catch(c){return!1}}})},function(a,b,c){var d=c(0);d(d.S,"Date",{now:function(){return(new Date).getTime()}})},function(a,b,c){var d=c(0),e=c(9),f=c(23);d(d.P+d.F*c(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(a){var b=e(this),c=f(b);return"number"!=typeof c||isFinite(c)?b.toISOString():null}})},function(a,b,c){var d=c(0),e=c(257);d(d.P+d.F*(Date.prototype.toISOString!==e),"Date",{toISOString:e})},function(a,b,c){var d=c(4),e=Date.prototype.getTime,f=Date.prototype.toISOString,g=function(a){return a>9?a:"0"+a};a.exports=d(function(){return"0385-07-25T07:06:39.999Z"!=f.call(new Date(-5e13-1))})||!d(function(){f.call(new Date(NaN))})?function(){if(!isFinite(e.call(this)))throw RangeError("Invalid time value");var a=this,b=a.getUTCFullYear(),c=a.getUTCMilliseconds(),d=b<0?"-":b>9999?"+":"";return d+("00000"+Math.abs(b)).slice(d?-6:-4)+"-"+g(a.getUTCMonth()+1)+"-"+g(a.getUTCDate())+"T"+g(a.getUTCHours())+":"+g(a.getUTCMinutes())+":"+g(a.getUTCSeconds())+"."+(c>99?c:"0"+g(c))+"Z"}:f},function(a,b,c){var d=Date.prototype,e="Invalid Date",f="toString",g=d[f],h=d.getTime;new Date(NaN)+""!=e&&c(15)(d,f,function(){var a=h.call(this);return a===a?g.call(this):e})},function(a,b,c){var d=c(5)("toPrimitive"),e=Date.prototype;d in e||c(14)(e,d,c(260))},function(a,b,c){var d=c(1),e=c(23),f="number";a.exports=function(a){if("string"!==a&&a!==f&&"default"!==a)throw TypeError("Incorrect hint");return e(d(this),a!=f)}},function(a,b,d){var e=d(0),f=d(65),g=d(96),h=d(1),i=d(38),j=d(6),k=d(3),l=d(2).ArrayBuffer,m=d(52),n=g.ArrayBuffer,o=g.DataView,p=f.ABV&&l.isView,q=n.prototype.slice,r=f.VIEW,s="ArrayBuffer";e(e.G+e.W+e.F*(l!==n),{ArrayBuffer:n}),e(e.S+e.F*!f.CONSTR,s,{isView:function(a){return p&&p(a)||k(a)&&r in a}}),e(e.P+e.U+e.F*d(4)(function(){return!new n(2).slice(1,c).byteLength}),s,{slice:function(a,b){if(q!==c&&b===c)return q.call(h(this),a);for(var d=h(this).byteLength,e=i(a,d),f=i(b===c?d:b,d),g=new(m(this,n))(j(f-e)),k=new o(this),l=new o(g),p=0;e<f;)l.setUint8(p++,k.getUint8(e++));return g}}),d(41)(s)},function(a,b,c){var d=c(0);d(d.G+d.W+d.F*!c(65).ABV,{DataView:c(96).DataView})},function(a,b,c){c(29)("Int8",1,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Uint8",1,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Uint8",1,function(a){return function(b,c,d){return a(this,b,c,d)}},!0)},function(a,b,c){c(29)("Int16",2,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Uint16",2,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Int32",4,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Uint32",4,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Float32",4,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,c){c(29)("Float64",8,function(a){return function(b,c,d){return a(this,b,c,d)}})},function(a,b,d){var e=d(0),f=d(53)(!0);e(e.P,"Array",{includes:function(a){return f(this,a,arguments.length>1?arguments[1]:c)}}),d(35)("includes")},function(a,b,c){var d=c(0),e=c(124),f=c(9),g=c(6),h=c(10),i=c(86);d(d.P,"Array",{flatMap:function(a){var b,c,d=f(this);return h(a),b=g(d.length),c=i(d,0),e(c,d,d,b,0,1,a,arguments[1]),c}}),c(35)("flatMap")},function(a,b,d){var e=d(0),f=d(124),g=d(9),h=d(6),i=d(21),j=d(86);e(e.P,"Array",{flatten:function(){var a=arguments[0],b=g(this),d=h(b.length),e=j(b,0);return f(e,b,b,d,0,a===c?1:i(a)),e}}),d(35)("flatten")},function(a,b,c){var d=c(0),e=c(56)(!0);d(d.P,"String",{at:function(a){return e(this,a)}})},function(a,b,d){var e=d(0),f=d(125),g=d(63),h=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(g);e(e.P+e.F*h,"String",{padStart:function(a){return f(this,a,arguments.length>1?arguments[1]:c,!0)}})},function(a,b,d){var e=d(0),f=d(125),g=d(63),h=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(g);e(e.P+e.F*h,"String",{padEnd:function(a){return f(this,a,arguments.length>1?arguments[1]:c,!1)}})},function(a,b,c){c(46)("trimLeft",function(a){return function(){return a(this,1)}},"trimStart")},function(a,b,c){c(46)("trimRight",function(a){return function(){return a(this,2)}},"trimEnd")},function(a,b,c){var d=c(0),e=c(24),f=c(6),g=c(57),h=c(51),i=RegExp.prototype,j=function(a,b){this._r=a,this._s=b};c(59)(j,"RegExp String",function(){var a=this._r.exec(this._s);return{value:a,done:null===a}}),d(d.P,"String",{matchAll:function(a){if(e(this),!g(a))throw TypeError(a+" is not a regexp!");var b=String(this),c="flags"in i?String(a.flags):h.call(a),d=new RegExp(a.source,~c.indexOf("g")?c:"g"+c);return d.lastIndex=f(a.lastIndex),new j(d,b)}})},function(a,b,c){c(70)("asyncIterator")},function(a,b,c){c(70)("observable")},function(a,b,d){var e=d(0),f=d(95),g=d(11),h=d(16),i=d(85);e(e.S,"Object",{getOwnPropertyDescriptors:function(a){for(var b,d,e=g(a),j=h.f,k=f(e),l={},m=0;k.length>m;)d=j(e,b=k[m++]),d!==c&&i(l,b,d);return l}})},function(a,b,c){var d=c(0),e=c(126)(!1);d(d.S,"Object",{values:function(a){return e(a)}})},function(a,b,c){var d=c(0),e=c(126)(!0);d(d.S,"Object",{entries:function(a){return e(a)}})},function(a,b,c){var d=c(0),e=c(9),f=c(10),g=c(7);c(8)&&d(d.P+c(66),"Object",{__defineGetter__:function(a,b){g.f(e(this),a,{get:f(b),enumerable:!0,configurable:!0})}})},function(a,b,c){var d=c(0),e=c(9),f=c(10),g=c(7);c(8)&&d(d.P+c(66),"Object",{__defineSetter__:function(a,b){g.f(e(this),a,{set:f(b),enumerable:!0,configurable:!0})}})},function(a,b,c){var d=c(0),e=c(9),f=c(23),g=c(17),h=c(16).f;c(8)&&d(d.P+c(66),"Object",{__lookupGetter__:function(a){var b,c=e(this),d=f(a,!0);do if(b=h(c,d))return b.get;while(c=g(c))}})},function(a,b,c){var d=c(0),e=c(9),f=c(23),g=c(17),h=c(16).f;c(8)&&d(d.P+c(66),"Object",{__lookupSetter__:function(a){var b,c=e(this),d=f(a,!0);do if(b=h(c,d))return b.set;while(c=g(c))}})},function(a,b,c){var d=c(0);d(d.P+d.R,"Map",{toJSON:c(127)("Map")})},function(a,b,c){var d=c(0);d(d.P+d.R,"Set",{toJSON:c(127)("Set")})},function(a,b,c){c(67)("Map")},function(a,b,c){c(67)("Set")},function(a,b,c){c(67)("WeakMap")},function(a,b,c){c(67)("WeakSet")},function(a,b,c){c(68)("Map")},function(a,b,c){c(68)("Set")},function(a,b,c){c(68)("WeakMap")},function(a,b,c){c(68)("WeakSet")},function(a,b,c){var d=c(0);d(d.G,{global:c(2)})},function(a,b,c){var d=c(0);d(d.S,"System",{global:c(2)})},function(a,b,c){var d=c(0),e=c(20);d(d.S,"Error",{isError:function(a){return"Error"===e(a)}})},function(a,b,c){var d=c(0);d(d.S,"Math",{clamp:function(a,b,c){return Math.min(c,Math.max(b,a))}})},function(a,b,c){var d=c(0);d(d.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(a,b,c){var d=c(0),e=180/Math.PI;d(d.S,"Math",{degrees:function(a){return a*e}})},function(a,b,c){var d=c(0),e=c(129),f=c(110);d(d.S,"Math",{fscale:function(a,b,c,d,g){return f(e(a,b,c,d,g))}})},function(a,b,c){var d=c(0);d(d.S,"Math",{iaddh:function(a,b,c,d){var e=a>>>0,f=b>>>0,g=c>>>0;return f+(d>>>0)+((e&g|(e|g)&~(e+g>>>0))>>>31)|0}})},function(a,b,c){var d=c(0);d(d.S,"Math",{isubh:function(a,b,c,d){var e=a>>>0,f=b>>>0,g=c>>>0;return f-(d>>>0)-((~e&g|~(e^g)&e-g>>>0)>>>31)|0}})},function(a,b,c){var d=c(0);d(d.S,"Math",{imulh:function(a,b){var c=65535,d=+a,e=+b,f=d&c,g=e&c,h=d>>16,i=e>>16,j=(h*g>>>0)+(f*g>>>16);return h*i+(j>>16)+((f*i>>>0)+(j&c)>>16)}})},function(a,b,c){var d=c(0);d(d.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(a,b,c){var d=c(0),e=Math.PI/180;d(d.S,"Math",{radians:function(a){return a*e}})},function(a,b,c){var d=c(0);d(d.S,"Math",{scale:c(129)})},function(a,b,c){var d=c(0);d(d.S,"Math",{umulh:function(a,b){var c=65535,d=+a,e=+b,f=d&c,g=e&c,h=d>>>16,i=e>>>16,j=(h*g>>>0)+(f*g>>>16);return h*i+(j>>>16)+((f*i>>>0)+(j&c)>>>16)}})},function(a,b,c){var d=c(0);d(d.S,"Math",{signbit:function(a){return(a=+a)!=a?a:0==a?1/a==1/0:a>0}})},function(a,b,c){var d=c(0),e=c(13),f=c(2),g=c(52),h=c(117);d(d.P+d.R,"Promise",{"finally":function(a){var b=g(this,e.Promise||f.Promise),c="function"==typeof a;return this.then(c?function(c){return h(b,a()).then(function(){return c})}:a,c?function(c){return h(b,a()).then(function(){throw c})}:a)}})},function(a,b,c){var d=c(0),e=c(94),f=c(116);d(d.S,"Promise",{"try":function(a){var b=e.f(this),c=f(a);return(c.e?b.reject:b.resolve)(c.v),b.promise}})},function(a,b,c){var d=c(30),e=c(1),f=d.key,g=d.set;d.exp({defineMetadata:function(a,b,c,d){g(a,b,e(c),f(d))}})},function(a,b,d){var e=d(30),f=d(1),g=e.key,h=e.map,i=e.store;e.exp({deleteMetadata:function(a,b){var d=arguments.length<3?c:g(arguments[2]),e=h(f(b),d,!1);if(e===c||!e["delete"](a))return!1;if(e.size)return!0;var j=i.get(b);return j["delete"](d),!!j.size||i["delete"](b)}})},function(a,b,d){var e=d(30),f=d(1),g=d(17),h=e.has,i=e.get,j=e.key,k=function(a,b,d){var e=h(a,b,d);if(e)return i(a,b,d);var f=g(b);return null!==f?k(a,f,d):c};e.exp({getMetadata:function(a,b){return k(a,f(b),arguments.length<3?c:j(arguments[2]))}})},function(a,b,d){var e=d(120),f=d(128),g=d(30),h=d(1),i=d(17),j=g.keys,k=g.key,l=function(a,b){var c=j(a,b),d=i(a);if(null===d)return c;var g=l(d,b);return g.length?c.length?f(new e(c.concat(g))):g:c};g.exp({getMetadataKeys:function(a){return l(h(a),arguments.length<2?c:k(arguments[1]))}})},function(a,b,d){var e=d(30),f=d(1),g=e.get,h=e.key;e.exp({getOwnMetadata:function(a,b){return g(a,f(b),arguments.length<3?c:h(arguments[2]))}})},function(a,b,d){var e=d(30),f=d(1),g=e.keys,h=e.key;e.exp({getOwnMetadataKeys:function(a){return g(f(a),arguments.length<2?c:h(arguments[1]))}})},function(a,b,d){var e=d(30),f=d(1),g=d(17),h=e.has,i=e.key,j=function(a,b,c){var d=h(a,b,c);if(d)return!0;var e=g(b);return null!==e&&j(a,e,c)};e.exp({hasMetadata:function(a,b){return j(a,f(b),arguments.length<3?c:i(arguments[2]))}})},function(a,b,d){var e=d(30),f=d(1),g=e.has,h=e.key;e.exp({hasOwnMetadata:function(a,b){return g(a,f(b),arguments.length<3?c:h(arguments[2]))}})},function(a,b,d){var e=d(30),f=d(1),g=d(10),h=e.key,i=e.set;e.exp({metadata:function(a,b){return function(d,e){i(a,b,(e!==c?f:g)(d),h(e))}}})},function(a,b,c){var d=c(0),e=c(93)(),f=c(2).process,g="process"==c(20)(f);d(d.G,{asap:function(a){var b=g&&f.domain;e(b?b.bind(a):a)}})},function(a,b,d){var e=d(0),f=d(2),g=d(13),h=d(93)(),i=d(5)("observable"),j=d(10),k=d(1),l=d(42),m=d(43),n=d(14),o=d(36),p=o.RETURN,q=function(a){return null==a?c:j(a)},r=function(a){var b=a._c;b&&(a._c=c,b())},s=function(a){return a._o===c},t=function(a){s(a)||(a._o=c,r(a))},u=function(a,b){k(a),this._c=c,this._o=a,a=new v(this);try{var d=b(a),e=d;null!=d&&("function"==typeof d.unsubscribe?d=function(){e.unsubscribe()}:j(d),this._c=d)}catch(f){return void a.error(f)}s(this)&&r(this)};u.prototype=m({},{unsubscribe:function(){t(this)}});var v=function(a){this._s=a};v.prototype=m({},{next:function(a){var b=this._s;if(!s(b)){var c=b._o;try{var d=q(c.next);if(d)return d.call(c,a)}catch(e){try{t(b)}finally{throw e}}}},error:function(a){var b=this._s;if(s(b))throw a;var d=b._o;b._o=c;try{var e=q(d.error);if(!e)throw a;a=e.call(d,a)}catch(f){try{r(b)}finally{throw f}}return r(b),a},complete:function(a){var b=this._s;if(!s(b)){var d=b._o;b._o=c;try{var e=q(d.complete);a=e?e.call(d,a):c}catch(f){try{r(b)}finally{throw f}}return r(b),a}}});var w=function(a){l(this,w,"Observable","_f")._f=j(a)};m(w.prototype,{subscribe:function(a){return new u(a,this._f)},forEach:function(a){var b=this;return new(g.Promise||f.Promise)(function(c,d){j(a);var e=b.subscribe({next:function(b){try{return a(b)}catch(c){d(c),e.unsubscribe()}},error:d,complete:c})})}}),m(w,{from:function(a){var b="function"==typeof this?this:w,c=q(k(a)[i]);if(c){var d=k(c.call(a));return d.constructor===b?d:new b(function(a){return d.subscribe(a)})}return new b(function(b){var c=!1;return h(function(){if(!c){try{if(o(a,!1,function(a){if(b.next(a),c)return p})===p)return}catch(d){if(c)throw d;return void b.error(d)}b.complete()}}),function(){c=!0}})},of:function(){for(var a=0,b=arguments.length,c=new Array(b);a<b;)c[a]=arguments[a++];return new("function"==typeof this?this:w)(function(a){var b=!1;return h(function(){if(!b){for(var d=0;d<c.length;++d)if(a.next(c[d]),b)return;a.complete()}}),function(){b=!0}})}}),n(w.prototype,i,function(){return this}),e(e.G,{Observable:w}),d(41)("Observable")},function(a,b,c){var d=c(0),e=c(92);d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},function(a,b,c){for(var d=c(88),e=c(27),f=c(15),g=c(2),h=c(14),i=c(40),j=c(5),k=j("iterator"),l=j("toStringTag"),m=i.Array,n={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},o=e(n),p=0;p<o.length;p++){var q,r=o[p],s=n[r],t=g[r],u=t&&t.prototype;if(u&&(u[k]||h(u,k,m),u[l]||h(u,l,r),i[r]=m,s))for(q in d)u[q]||f(u,q,d[q],!0)}},function(a,b,c){var d=c(2),e=c(0),f=c(63),g=[].slice,h=/MSIE .\./.test(f),i=function(a){return function(b,c){var d=arguments.length>2,e=!!d&&g.call(arguments,2);return a(d?function(){("function"==typeof b?b:Function(b)).apply(this,e)}:b,c)}};e(e.G+e.B+e.F*h,{setTimeout:i(d.setTimeout),setInterval:i(d.setInterval)})},function(a,b,d){function e(a){var b=o(null);return a!=c&&(v(a)?u(a,!0,function(a,c){b[a]=c}):n(b,a)),b}function f(a,b,c){t(b);var d,e,f=z(a),g=q(f),h=g.length,i=0;if(arguments.length<3){if(!h)throw TypeError("Reduce of empty object with no initial value");d=f[g[i++]]}else d=Object(c);for(;h>i;)B(f,e=g[i++])&&(d=b(d,f[e],e,a));return d}function g(a,b){return(b==b?s(a,b):D(a,function(a){return a!=a}))!==c}function h(a,b){if(B(a,b))return a[b]}function i(a,b,c){return A&&b in Object?r.f(a,b,m(0,c)):a[b]=c,a}function j(a){return y(a)&&p(a)===e.prototype}var k=d(19),l=d(0),m=d(31),n=d(74),o=d(28),p=d(17),q=d(27),r=d(7),s=d(332),t=d(10),u=d(36),v=d(130),w=d(59),x=d(89),y=d(3),z=d(11),A=d(8),B=d(12),C=function(a){var b=1==a,d=4==a;return function(f,g,h){var i,j,l,m=k(g,h,3),n=z(f),o=b||7==a||2==a?new("function"==typeof this?this:e):c;for(i in n)if(B(n,i)&&(j=n[i],l=m(j,i,f),a))if(b)o[i]=l;else if(l)switch(a){case 2:o[i]=j;break;case 3:return!0;case 5:return j;case 6:return i;case 7:o[l[0]]=l[1]}else if(d)return!1;return 3==a||d?d:o}},D=C(6),E=function(a){return function(b){return new F(b,a)}},F=function(a,b){this._t=z(a),this._a=q(a),this._i=0,this._k=b};w(F,"Dict",function(){var a,b=this,d=b._t,e=b._a,f=b._k;do if(b._i>=e.length)return b._t=c,x(1);while(!B(d,a=e[b._i++]));return"keys"==f?x(0,a):"values"==f?x(0,d[a]):x(0,[a,d[a]])}),e.prototype=null,l(l.G+l.F,{Dict:e}),l(l.S,"Dict",{keys:E("keys"),values:E("values"),entries:E("entries"),forEach:C(0),map:C(1),filter:C(2),some:C(3),every:C(4),find:C(5),findKey:D,mapPairs:C(7),reduce:f,keyOf:s,includes:g,has:B,get:h,set:i,isDict:j})},function(a,b,c){var d=c(27),e=c(11);a.exports=function(a,b){for(var c,f=e(a),g=d(f),h=g.length,i=0;h>i;)if(f[c=g[i++]]===b)return c}},function(a,b,c){var d=c(1),e=c(50);a.exports=c(13).getIterator=function(a){var b=e(a);if("function"!=typeof b)throw TypeError(a+" is not iterable!");return d(b.call(a))}},function(a,b,c){var d=c(2),e=c(13),f=c(0),g=c(131);f(f.G+f.F,{delay:function(a){return new(e.Promise||d.Promise)(function(b){setTimeout(g.call(b,!0),a)})}})},function(a,b,c){var d=c(132),e=c(0);c(13)._=d._=d._||{},e(e.P+e.F,"Function",{part:c(131)})},function(a,b,c){var d=c(0);d(d.S+d.F,"Object",{isObject:c(3)})},function(a,b,c){var d=c(0);d(d.S+d.F,"Object",{classof:c(34)})},function(a,b,c){var d=c(0),e=c(133);d(d.S+d.F,"Object",{define:e})},function(a,b,c){var d=c(0),e=c(133),f=c(28);d(d.S+d.F,"Object",{make:function(a,b){return e(f(a),b)}})},function(a,b,d){d(58)(Number,"Number",function(a){this._l=+a,this._i=0},function(){var a=this._i++,b=!(a<this._l);return{done:b,value:b?c:a}})},function(a,b,c){var d=c(0),e=c(97)(/[\\^$*+?.()|[\]{}]/g,"\\$&");d(d.S,"RegExp",{escape:function(a){return e(a)}})},function(a,b,c){var d=c(0),e=c(97)(/[&<>"']/g,{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"});d(d.P+d.F,"String",{escapeHTML:function(){return e(this)}})},function(a,b,c){var d=c(0),e=c(97)(/&(?:amp|lt|gt|quot|apos);/g,{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"});d(d.P+d.F,"String",{unescapeHTML:function(){return e(this)}})}]),"undefined"!=typeof module&&module.exports?module.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):b.core=a}(1,1),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):(a=a||self,b(a.BOS2D={}))}(this,function(a){"use strict";function b(){this.level=-1,this.setLevel(F.LOG)}function c(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+6*(b-a)*(2/3-c):a}function d(a){"@babel/helpers - typeof";return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&j(a,b)}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a,b){return(j=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function k(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function l(a,b){return!b||"object"!=typeof b&&"function"!=typeof b?k(a):b}function m(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=i(a),null!==a););return a}function n(a,b,c){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=m(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}})(a,b,c||a)}function o(a){return p(a)||q(a)||r()}function p(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function q(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(a,b,c,d){this._x=a||0,this._y=b||0,this._z=c||0,this._w=void 0!==d?d:1}function t(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0}function u(a,b,c,d,e){var f=0,g=0;for(f=0,g=a.length-3;f<=g;f+=3){V.fromArray(a,f);var h=e.x*Math.abs(V.x)+e.y*Math.abs(V.y)+e.z*Math.abs(V.z),i=b.dot(V),j=c.dot(V),k=d.dot(V);if(Math.max(-Math.max(i,j,k),Math.min(i,j,k))>h)return!1}return!0}function v(a,b){this.min=void 0!==a?a:new t(1/0,1/0,1/0),this.max=void 0!==b?b:new t((-(1/0)),(-(1/0)),(-(1/0)))}function w(a){var b=a.replace(/\s{2,}/g,""),c=(new DOMParser).parseFromString(b,"text/html");return c.body.firstElementChild.cloneNode(!0)}function x(a,b){return Ja("".concat(a,"/drawings/elements?elementKey=").concat(b))}function y(a){this.autoStart=void 0===a||a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function z(a,b){this.normal=void 0!==a?a:new t(1,0,0),this.constant=void 0!==b?b:0}function A(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=void 0!==d?d:1}var B=function(a,b){this.x=a||0,this.y=b||0};Object.defineProperties(B.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}}),Object.assign(B.prototype,{isVector2:!0,set:function(a,b){return this.x=a,this.y=b,this},setScalar:function(a){return this.x=a,this.y=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){return this.x=a.x,this.y=a.y,this},add:function(a,b){return void 0!==b?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this)},addScalar:function(a){return this.x+=a,this.y+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this},sub:function(a,b){return void 0!==b?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this)},subScalar:function(a){return this.x-=a,this.y-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return this.x/=a.x,this.y/=a.y,this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){return this.x=a.elements[0]*this.x+a.elements[3]*this.y+a.elements[6],this.y=a.elements[1]*this.x+a.elements[4]*this.y+a.elements[7],this},min:function(a){return a.x<this.x&&(this.x=a.x),a.y<this.y&&(this.y=a.y),this},max:function(a){return a.x>this.x&&(this.x=a.x),a.y>this.y&&(this.y=a.y),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this},clampScalar:function(){var a=new B,b=new B;return function(c,d){return a.set(c,c),b.set(d,d),this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function wc(){var wc=Math.atan2(this.y,this.x);return wc<0&&(wc+=2*Math.PI),wc},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a},rotateAround:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,
this.y=e*d+f*c+a.y,this}});var C=[new B,new B,new B,new B],D=function(a,b){this.min=void 0!==a?a:new B(Number(1/0),Number(1/0)),this.max=void 0!==b?b:new B((-(1/0)),(-(1/0)))};Object.assign(D.prototype,{set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b+=1)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new B;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=Number(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){return void 0===a&&(console.warn("Box2: .getCenter() target is now required"),a=new B),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){return void 0===a&&(console.warn("Box2: .getSize() target is now required"),a=new B),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){return void 0===b&&(console.warn("Box2: .getParameter() target is now required"),b=new B),b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},clampPoint:function(a,b){return void 0===b&&(console.warn("Box2: .clampPoint() target is now required"),b=new B),b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new B;return function(b){var c=a.copy(b).clamp(this.min,this.max);return c.sub(b).length()}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},applyMatrix3:function(a){return this.isEmpty()?this:(C[0].set(this.min.x,this.min.y).applyMatrix3(a),C[1].set(this.max.x,this.min.y).applyMatrix3(a),C[2].set(this.max.x,this.max.y).applyMatrix3(a),C[3].set(this.min.x,this.max.y).applyMatrix3(a),this.setFromPoints(C),this)}});var E={};E.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))},E.euclideanModulo=function(a,b){return(a%b+b)%b};var F={DEBUG:6,PERFORMANCE:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};b.prototype.setLevel=function(a){if(this.level!==a){this.level=a;var b=function(){},c=F,d=this,e=function(){if(d.callback){var a=Array.prototype.slice.call(arguments).join(" ");d.callback({category:"error",message:a},{adp:!1})}console.error.apply(console,arguments)};this.debug=a>=c.DEBUG?console.debug.bind(console):b,this.trace=a>=c.DEBUG?console.trace.bind(console):b,this.assert=a>=c.DEBUG?console.assert.bind(console):b,this.count=a>=c.DEBUG?console.count.bind(console):b,this.dir=a>=c.DEBUG?console.dir.bind(console):b,this.time=a>=c.PERFORMANCE?console.time.bind(console):b,this.timeEnd=a>=c.PERFORMANCE?console.timeEnd.bind(console):b,this.log=a>=c.LOG?console.log.bind(console):b,this.info=a>=c.INFO?console.info.bind(console):b,this.warn=a>=c.WARNING?console.warn.bind(console):b,this.error=a>=c.ERROR?e:b}};var G=new b,H={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},I=function(a,b,c,d){return void 0===d&&void 0===c?this.set(a,b):this.setRGB(a,b,c,d)};Object.assign(I.prototype,{isColor:!0,r:1,g:1,b:1,a:1,set:function(a,b){return"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),void 0!==b&&this.setAlpha(b),this},setHex:function(a,b){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this.setAlpha(b),this},setAlpha:function(a){return"number"==typeof a?(a>1&&(a=1),a<0&&(a=0),this.a=a):isNaN(parseFloat(a))?this.a=1:(a=parseFloat(a),a>1&&(a=1),a<0&&(a=0),this.a=a),this},setRGB:function(a,b,c,d){return a>1?this.r=Math.min(255,parseInt(a,10))/255:this.r=a,b>1?this.g=Math.min(255,parseInt(b,10))/255:this.r=b,c>1?this.b=Math.min(255,parseInt(c,10))/255:this.b=c,this.setAlpha(d),this},setHSL:function(a,b,d,e){if(a=E.euclideanModulo(a,1),b=E.clamp(b,0,1),d=E.clamp(d,0,1),0===b)this.r=this.g=this.b=d;else{var f=d<=.5?d*(1+b):d+b-d*b,g=2*d-f;this.r=c(g,f,a+1/3),this.g=c(g,f,a),this.b=c(g,f,a-1/3)}return this.a=e,this},setStyle:function(a){var b=null;if(b=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var c=null,d=b[1],e=b[2];switch(d){case"rgb":case"rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,this.setAlpha(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,this.setAlpha(c[5]),this;break;case"hsl":case"hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e)){var f=parseFloat(c[1])/360,g=parseInt(c[2],10)/100,h=parseInt(c[3],10)/100;return this.setAlpha(c[5]),this.setHSL(f,g,h)}}}else if(b=/^\#([A-Fa-f0-9]+)$/.exec(a)){var i=b[1],j=i.length;if(3===j)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===j)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}if(a&&a.length>0){var i=H[a];void 0!==i?this.setHex(i):G.warn("Color: Unknown color "+a)}return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var a={h:0,s:0,l:0,a:1},b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g=0,h=0,i=(f+e)/2;if(f===e)g=0,h=0;else{var j=e-f;switch(h=i<=.5?j/(e+f):j/(2-e-f),e){case b:g=(c-d)/j+(c<d?6:0);break;case c:g=(d-b)/j+2;break;case d:g=(b-c)/j+4}g/=6}return a.h=g,a.s=h,a.l=i,a.a=this.a,a},getRGB:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},getRGBA:function(){return"rgba("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+","+this.a+")"},getAlpha:function(){return this.a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var a={};return function(b,c,d){return this.getHSL(a),a.h+=b,a.s+=c,a.l+=d,this.setHSL(a.h,a.s,a.l),this}}(),fromArray:function(a,b){return void 0===b&&(b=0),this.r=a[b],this.g=a[b+1],this.b=a[b+2],this.a=a[b+3]||1,this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a[b+3]=this.a,a},toJSON:function(){return this.getHex()}}),Object.defineProperties(I.prototype,{red:{get:function(){return this.r},set:function(a){this.r=a}},green:{get:function(){return this.g},set:function(a){this.g=a}},blue:{get:function(){return this.b},set:function(a){this.b=a}},alpha:{get:function(){return this.a},set:function(a){this.a=a}},opacity:{get:function(){return this.a},set:function(a){this.a=a}}});var J=function(){};J.prototype={constructor:J,apply:function(a){a.addEventListener=J.prototype.addEventListener,a.hasEventListener=J.prototype.hasEventListener,a.removeEventListener=J.prototype.removeEventListener,a.fireEvent=J.prototype.dispatchEvent,a.dispatchEvent=J.prototype.dispatchEvent},addEventListener:function(a,b){a&&(void 0===this._listeners&&(this._listeners={}),"undefined"==typeof this._listeners[a]&&(this._listeners[a]=[]),this._listeners[a].push(b))},hasEventListener:function(a,b){if(!a)return!1;if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&c[a].indexOf(b)!==-1},removeEventListener:function(a,b){if(a&&(void 0===this._listeners&&(this._listeners={}),Array.isArray(this._listeners[a])))for(var c=this._listeners[a],d=0,e=c.length;d<e;d+=1)if(c[d]===b){c.splice(d,1);break}},removeAllEventListenerByType:function(a){a&&(void 0===this._listeners&&(this._listeners={}),Array.isArray(this._listeners[a])&&this._listeners[a]&&(this._listeners[a]=void 0))},removeAllEventListener:function(){void 0===this._listeners&&(this._listeners={});for(var a in this._listeners)if(this._listeners.hasOwnProperty(a))for(var b=this._listeners[a],c=0,d=b.length;c<d;c+=1)b.splice(c,1);this._listeners={}},dispatchEvent:function(a){if(void 0===this._listeners&&(this._listeners={}),"string"==typeof a&&(a={type:a}),!a.target)try{a.target=this}catch(b){}if(null===a.type||void 0===a.type)throw G.trace("事件类型未知."),new Error("事件类型未知.");if(Array.isArray(this._listeners[a.type]))for(var c=this._listeners[a.type].slice(),d=0;d<c.length;d+=1)c[d].call(this,a)},fireEvent:function(a){this.dispatchEvent(a)}},Object.assign(s,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],i=c[d+1],j=c[d+2],k=c[d+3],l=e[f+0],m=e[f+1],n=e[f+2],o=e[f+3];if(k!==o||h!==l||i!==m||j!==n){var p=1-g,q=h*l+i*m+j*n+k*o,r=q>=0?1:-1,s=1-q*q;if(s>Number.EPSILON){var t=Math.sqrt(s),u=Math.atan2(t,q*r);p=Math.sin(p*u)/t,g=Math.sin(g*u)/t}var v=g*r;if(h=h*p+l*v,i=i*p+m*v,j=j*p+n*v,k=k*p+o*v,p===1-g){var w=1/Math.sqrt(h*h+i*i+j*j+k*k);h*=w,i*=w,j*=w,k*=w}}a[b]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k}}),Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a,this._onChangeCallback()}}}),Object.assign(s.prototype,{isQuaternion:!0,set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,d=a._y,e=a._z,f=a.order,g=Math.cos,h=Math.sin,i=g(c/2),j=g(d/2),k=g(e/2),l=h(c/2),m=h(d/2),n=h(e/2);return"XYZ"===f?(this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n):"YXZ"===f?(this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n):"ZXY"===f?(this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n):"ZYX"===f?(this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n):"YZX"===f?(this._x=l*j*k+i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k-l*m*n):"XZY"===f&&(this._x=l*j*k-i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k+l*m*n),b!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this._onChangeCallback(),this},setFromRotationMatrix:function(a){var b,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[1],h=c[5],i=c[9],j=c[2],k=c[6],l=c[10],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this._w=.25/b,this._x=(k-i)*b,this._y=(f-j)*b,this._z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this._w=(k-i)/b,this._x=.25*b,this._y=(e+g)/b,this._z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this._w=(f-j)/b,this._x=(e+g)/b,this._y=.25*b,this._z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this._w=(g-e)/b,this._x=(f+j)/b,this._y=(i+k)/b,this._z=.25*b),this._onChangeCallback(),this},setFromUnitVectors:function(a,b){var c=1e-6,d=a.dot(b)+1;return d<c?(d=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0,this._w=d):(this._x=0,this._y=-a.z,this._z=a.y,this._w=d)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x,this._w=d),this.normalize()},angleTo:function(a){return 2*Math.acos(Math.abs(E.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,b){var c=this.angleTo(a);if(0===c)return this;var d=Math.min(1,b/c);return this.slerp(a,d),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this._onChangeCallback(),this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(g<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=1-g*g;if(h<=Number.EPSILON){var i=1-b;return this._w=i*f+b*this._w,this._x=i*c+b*this._x,this._y=i*d+b*this._y,this._z=i*e+b*this._z,this.normalize(),this._onChangeCallback(),this}var j=Math.sqrt(h),k=Math.atan2(j,g),l=Math.sin((1-b)*k)/j,m=Math.sin(b*k)/j;return this._w=f*l+this._w*m,this._x=c*l+this._x*m,this._y=d*l+this._y*m,this._z=e*l+this._z*m,this._onChangeCallback(),this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){return void 0===b&&(b=0),this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this._onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},_onChange:function(a){return this._onChangeCallback=a,this},_onChangeCallback:function(){}}),Object.assign(t.prototype,{isVector3:!0,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyEuler:function(){var a=new s;return function(b){return b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new s;return function(b,c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},project:function(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)},unproject:function(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)},transformDirection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize()},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this},clampScalar:function(a,b){return this.x=Math.max(a,Math.min(b,this.x)),this.y=Math.max(a,Math.min(b,this.y)),this.z=Math.max(a,Math.min(b,this.z)),this},clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new t;return function(b){return a.copy(this).projectOnVector(b),this.sub(a)}}(),reflect:function(){var a=new t;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){var b=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(E.clamp(b,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)},setFromSphericalCoords:function(a,b,c){var d=Math.sin(b)*a;return this.x=d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this},setFromCylindrical:function(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)},setFromCylindricalCoords:function(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this},setFromMatrixPosition:function(a){var b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},fromBufferAttribute:function(a,b,c){return void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this}});var K=[new t,new t,new t,new t,new t,new t,new t,new t],L=new t,M=new t,N=new t,O=new t,P=new t,Q=new t,R=new t,S=new t,T=new t,U=new t,V=new t,W=new v;Object.assign(v.prototype,{isBox3:!0,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromArray:function(a){for(var b=1/0,c=1/0,d=1/0,e=-(1/0),f=-(1/0),g=-(1/0),h=0,i=a.length;h<i;h+=3){var j=a[h],k=a[h+1],l=a[h+2];j<b&&(b=j),k<c&&(c=k),l<d&&(d=l),j>e&&(e=j),k>f&&(f=k),l>g&&(g=l)}return this.min.set(b,c,d),this.max.set(e,f,g),this},toArray:function(a){return void 0===a&&(a=[]),this.min.toArray(a),this.max.toArray(a,3),a},setFromBufferAttribute:function(a){for(var b=1/0,c=1/0,d=1/0,e=-(1/0),f=-(1/0),g=-(1/0),h=0,i=a.count;h<i;h+=1){var j=a.getX(h),k=a.getY(h),l=a.getZ(h);j<b&&(b=j),k<c&&(c=k),l<d&&(d=l),j>e&&(e=j),k>f&&(f=k),l>g&&(g=l)}return this.min.set(b,c,d),this.max.set(e,f,g),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b+=1)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(a,b){var c=L.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this},setFromObject:function(a){return this.makeEmpty(),this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){return void 0===a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new t),this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){return void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),a=new t),this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},expandByObject:function(a){a.updateWorldMatrix(!1,!1);var b=a.geometry;void 0!==b&&(null===b.boundingBox&&b.computeBoundingBox(),W.copy(b.boundingBox),W.applyMatrix4(a.matrixWorld),this.union(W));for(var c=a.children,d=0,e=c.length;d<e;d+=1)this.expandByObject(c[d]);return this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return void 0===b&&(console.warn("THREE.Box3: .getParameter() target is now required"),b=new t),b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},intersectsSphere:function(a){return this.clampPoint(a.center,L),L.distanceToSquared(a.center)<=a.radius*a.radius},intersectsPlane:function(a){var b=null,c=null;return a.normal.x>0?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),a.normal.y>0?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),a.normal.z>0?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant},intersectsTriangle:function(a){if(this.isEmpty())return!1;this.getCenter(S),T.subVectors(this.max,S),M.subVectors(a.a,S),N.subVectors(a.b,S),O.subVectors(a.c,S),P.subVectors(N,M),Q.subVectors(O,N),R.subVectors(M,O);var b=[0,-P.z,P.y,0,-Q.z,Q.y,0,-R.z,R.y,P.z,0,-P.x,Q.z,0,-Q.x,R.z,0,-R.x,-P.y,P.x,0,-Q.y,Q.x,0,-R.y,R.x,0];return!!u(b,M,N,O,T)&&(b=[1,0,0,0,1,0,0,0,1],!!u(b,M,N,O,T)&&(U.crossVectors(P,Q),b=[U.x,U.y,U.z],u(b,M,N,O,T)))},clampPoint:function(a,b){return void 0===b&&(console.warn("THREE.Box3: .clampPoint() target is now required"),b=new t),b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(a){var b=L.copy(a).clamp(this.min,this.max);return b.sub(a).length()},getBoundingSphere:function(a){return void 0===a&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(a.center),a.radius=.5*this.getSize(L).length(),a},intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},applyMatrix4:function(a){return this.isEmpty()?this:(K[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),K[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),K[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),K[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),K[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),K[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),K[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),K[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(K),this)},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});var X={byteArr2Int:function(a){return(255&a[0])<<24|(255&a[1])<<16|(255&a[2])<<8|(255&a[3])<<0},int2ByteArr:function(a){var b=[];return b[0]=a>>24,b[1]=a>>16,b[2]=a>>8,b[3]=a>>0,b},isPlainObject:function(a){var b=null,c=null;return!(!a||"[object Object]"!==Object.prototype.toString.call(a))&&(!(b=Object.getPrototypeOf(a))||(c=Object.hasOwnProperty.call(b,"constructor")&&b.constructor,"function"==typeof c&&Object.hasOwnProperty.toString.call(c)===Object.hasOwnProperty.toString.call(Object)))},extend:function(){var a=null,b=null,c=null,e=null,f=null,g=null,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i+=1),"object"!==d(h)&&"function"===!d(h)&&(h={}),i===j&&(h=this,i-=1);i<j;i+=1)if(null!==(a=arguments[i])&&void 0!==(a=arguments[i]))for(b in a)c=h[b],e=a[b],h!==e&&(k&&e&&(X.isPlainObject(e)||(f=Array.isArray(e)))?(f?(f=!1,g=c&&Array.isArray(c)?c:[]):g=c&&X.isPlainObject(c)?c:{},h[b]=X.extend(k,g,e)):void 0!==e&&null!==e&&(h[b]=e));return h},supportWorker:function(){return"undefined"!=typeof Worker||(console.log("Web Worker is not supported."),!1)},box3FromArray:function(a,b){if(Array.isArray(a)){var c=b||new v;return c.min.fromArray(a,0),c.max.fromArray(a,3),c}return null},box3FromArrayRange:function(a,b,c){for(var d=new v,e=Number(1/0),f=Number(1/0),g=Number(1/0),h=-(1/0),i=-(1/0),j=-(1/0),k=b,l=c;k<l;k+=3){var m=a[k],n=a[k+1],o=a[k+2];m<e&&(e=m),n<f&&(f=n),o<g&&(g=o),m>h&&(h=m),n>i&&(i=n),o>j&&(j=o)}return d.min.set(e,f,g),d.max.set(h,i,j),
d},box3FromObject:function(a,b,c){if(void 0!==a&&void 0!==b&&void 0!==a.x&&void 0!==a.y&&void 0!==a.z&&void 0!==b.x&&void 0!==b.y&&void 0!==b.z){var d=c||new v;return d.min.set(a.x,a.y,a.z),d.max.set(b.x,b.y,b.z),d}return null},computeBBox:function(a){for(var b=new v,c=new t,d=0,e=a.length;d<e;d+=1)c.fromArray(a[d],0),b.expandByPoint(c);return b},mergeBBox:function(a){if(a.length<1)return null;for(var b=new v,c=new t,d=new t,e=new v,f=0,g=a.length;f<g;f+=1)c.set(a[f].max.x,a[f].max.y,a[f].max.z),d.set(a[f].min.x,a[f].min.y,a[f].min.z),e.set(d,c),b.union(e);return b},parseTransform:function(a,b,c){var d=!1;if(b.rotation&&(a.rotation.fromArray(b.rotation),d=!0),b.position&&(a.position.fromArray(b.position),d=!0),b.scale&&(a.scale.fromArray(b.scale),d=!0),b.quaternion&&(a.quaternion.fromArray(b.quaternion),d=!0),d&&a.updateMatrix(),b.matrix&&a.matrix.fromArray(b.matrix),c){var e=a.matrix.clone();e.multiplyMatrices(c,a.matrix),a.matrix=e}a.matrixAutoUpdate=!1,void 0!==a.boundingBox&&(a.boundingBox=X.box3FromArray(b.bbox))},isEmptyObject:function(a){if(!a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isEmptyObjectSimple:function(a){for(var b in a)return!1;return!0},isOwnEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},hexStrToRgb:function(a){var b=a.replace("#",""),c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return c?{r:parseInt(c[1],16)/255,g:parseInt(c[2],16)/255,b:parseInt(c[3],16)/255}:null},hexToRgb:function(a){var b={};return b.r=(a>>16&255)/255,b.g=(a>>8&255)/255,b.b=(255&a)/255,b},getMin:function(a){for(var b=a.length,c=1/0;(b-=1)>=0;)c=a[b]<c?a[b]:c;return c},getMax:function(a){for(var b=a.length,c=-(1/0);(b-=1)>=0;)c=a[b]>c?a[b]:c;return c},findRange:function(a,b){if(b<Math.min.apply(null,a))return 0;if(b>Math.max.apply(null,a))return a.length-1;for(var c=0,d=0,e=a.length;d<e;d+=1)if(a[d]>b){c=d-1;break}return c},stringToByte:function(a){for(var b=[],c=a.length,d=null,e=0;e<c;e+=1)d=a.charCodeAt(e),d>=65536&&d<=1114111?(b.push(d>>18&7|240),b.push(d>>12&63|128),b.push(d>>6&63|128),b.push(63&d|128)):d>=2048&&d<=65535?(b.push(d>>12&15|224),b.push(d>>6&63|128),b.push(63&d|128)):d>=128&&d<=2047?(b.push(d>>6&31|192),b.push(63&d|128)):b.push(255&d);return b},byteToString:function(a){if("string"==typeof a)return a;for(var b="",c=a,d=0;d<c.length;d+=1){var e=c[d].toString(2),f=e.match(/^1+?(?=0)/);if(f&&8===e.length){for(var g=f[0].length,h=c[d].toString(2).slice(7-g),i=1;i<g;i+=1)h+=c[i+d].toString(2).slice(2);b+=String.fromCharCode(parseInt(h,2)),d+=g-1}else b+=String.fromCharCode(c[d])}return b},strToBinary:function(a){for(var b=[],c=a.split(""),d=0;d<c.length;d+=1){0!==d&&b.push(" ");var e=c[d],f=e.charCodeAt().toString(2);b.push(f)}return b.join("")},binaryToStr:function(a){for(var b=[],c=a.split(" "),d=0;d<c.length;d+=1){var e=c[d],f=parseInt(e,2),g=String.fromCharCode(f);b.push(g)}return b.join("")},isMirror:function(a){var b=new t(a[0],a[1],a[2]),c=new t(a[4],a[5],a[6]),d=new t(a[8],a[9],a[10]),e=(new t).crossVectors(b,c),f=e.dot(d);return f<0},decodeUTF8:function(a){for(var b="",c=0;c<a.length;c+=1)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},unique:function(a){for(var b,c=[],d={},e=0;null!==(b=a[e])&&void 0!==(b=a[e]);e+=1)d[b]||(c.push(b),d[b]=!0);return d=null,c},getValue:function(a,b){var c=b.split("."),d=a;return c.map(function(a,b){d=d[a]}),d},sortByName:function(a,b,c){c=c||"asc";var d=!1;b?b.indexOf(".")>-1&&(d=!0):b="name",a=a.sort(function(a,e){if(d){var f=X.getValue(a,b),g=X.getValue(e,b);return"asc"===c?f.localeCompare(g):g.localeCompare(f)}return"asc"===c?a[b].localeCompare(e[b]):e[b].localeCompare(a[b])});var e=[],f=[],g=[],h=[];return a.map(function(a,c){var i=null;i=d?X.getValue(a,b):a[b],/^[a-zA-Z]*$/.test(i.slice(0,1))?e.push(a):/^[\u4e00-\u9fa5]*$/.test(i.slice(0,1))?f.push(a):/^\d+(\.\d+)?$/.test(i.slice(0,1))?g.push(a):h.push(a)}),h.concat(g,e,f)},PointToLineDistance:function(a,b,c,d,e,f){var g=void 0,h=void 0,i=void 0,j=void 0,k=0,l=Math.sqrt((c-a)*(c-a)+(d-b)*(d-b));if(0===l)return[0,{x:c,y:d}];var m=Math.sqrt((e-a)*(e-a)+(f-b)*(f-b));if(0===m)return[0,{x:e,y:f}];var n=Math.sqrt((c-e)*(c-e)+(d-f)*(d-f));if(0===n)return k=l,[k,{x:c,y:d}];if(l<m){if(d===f?g=c<e?0:Math.PI:(j=(e-c)/n,j-1>1e-5&&(j=1),g=Math.acos(j),d>f&&(g=2*Math.PI-g)),j=(a-c)/l,j-1>1e-5&&(j=1),h=Math.acos(j),d>b&&(h=2*Math.PI-h),i=h-g,i<0&&(i=-i),i>Math.PI&&(i=2*Math.PI-i),i>Math.PI/2)return[l,{x:c,y:d}];if(c===e)return[m*Math.sin(i),{x:c,y:b}];if(d===f)return[m*Math.sin(i),{x:a,y:d}];var o=0,p=0,q=(f-d)/e-c,r=-1/q,s=b-a*r,t=f-e*q;return o=(t-s)/(r-q),p=r*o+s,[l*Math.sin(i),{x:o,y:p}]}if(d===f?g=c<e?Math.PI:0:(j=(c-e)/n,j-1>1e-5&&(j=1),g=Math.acos(j),f>d&&(g=2*Math.PI-g)),j=(a-e)/m,j-1>1e-5&&(j=1),h=Math.acos(j),f>b&&(h=2*Math.PI-h),i=h-g,i<0&&(i=-i),i>Math.PI&&(i=2*Math.PI-i),i>Math.PI/2)return[m,{x:e,y:f}];if(c===e)return[m*Math.sin(i),{x:c,y:b}];if(d===f)return[m*Math.sin(i),{x:a,y:d}];var u=0,v=0,w=(f-d)/e-c,x=-1/w,y=b-a*x,z=f-e*w;return u=(z-y)/(x-w),v=x*u+y,[m*Math.sin(i),{x:u,y:v}]},freezeObject:function(a){return Object.freeze?Object.freeze(a):a},getEncodedId:function(a){return a},arrayToMap:function(a,b){b=b||{};for(var c=0,d=a.length;c<d;c+=1)b[a[c]]=!0;return b},getDifferentialIdxs:function(a,b){var c=null,d={},e={},f={};if(b)if(this.isEmptyObject(a))e=b;else{for(c in b)a[c]&&(f[c]=!0);if(this.isEmptyObject(f))d=a,e=b;else{for(c in b)f[c]||(e[c]=!0);for(c in a)f[c]||(d[c]=!0)}}else this.isEmptyObject(a)||(d=a);return{objCurrUsedIdxs:a,addIdxs:Object.keys(d),removeIdxs:Object.keys(e)}},getCombinedKeyString:function(a,b){return b=b||"&",a.join(b)},splitCombinedKeyString:function(a,b){return b=b||"&",a.split(b)},isGroupObject:function(a){return!(!a.children||!a.children.length)},isMeshObject:function(a){return!!(a.isMesh||a.isLine||a.isPoints)},asyncProcess:function(a,b,c,d,e){function f(g){var h=g;return function(){var g=null,i=null;for(i=h+c>b?b:h+c,g=h;g<i;g+=1){var j=g;d&&d(a,j),g===i-1&&(i!==b?requestAnimationFrame(f(g+1)):e&&e(a))}}}requestAnimationFrame(f(0))},hasSimilarProperty:function(a,b){if(!(a instanceof Object&&b instanceof Object))return!1;for(var c in a)if(a.hasOwnProperty(c)&&!b.hasOwnProperty(c))return!1;return!0},equalsWithEpsilon:function(a,b){var c=1e-7,d=Math.abs(a.x-b.x),e=Math.abs(a.y-b.y),f=Math.abs(a.z-b.z);return d<=c&&e<=c&&f<=c},arrayMax:function(a){if(0===a.length)return-(1/0);for(var b=a[0],c=1,d=a.length;c<d;c+=1)a[c]>b&&(b=a[c]);return b},arrayMin:function(a){if(0===a.length)return 1/0;for(var b=a[0],c=1,d=a.length;c<d;c+=1)a[c]<b&&(b=a[c]);return b},ab2str:function(a){return(new TextDecoder).decode(new Uint8Array(a))},str2ab:function(a){return(new TextEncoder).encode(a).buffer}},Y=function(){for(var a=[],b="0123456789abcdef",c=0;c<36;c+=1)a[c]=b.substr(Math.floor(16*Math.random()),1);a[14]="4",a[19]=b.substr(3&a[19]|8,1),a[8]=a[13]=a[18]=a[23]="-";var d=a.join("");return d};X.createUUID=Y;var Z={getDataFromIndexedDB:!0,UserControlView:!1,ClippingCaps:!0,SelectionColor:{color:"#21a7e5"},ConcurrencyRequestCount:16,EnableDemolishByDClick:!1,IsMobile:!1,EnableViewController:!0,DirectionalLight:!0,LightPreset:2,IBL:!1,ToneMapping:4,LightIntensityFactor:1,Hover:!0,EnableHitDetection:!1,EnableSelectionOutline:!1,EnableSelectionByTranslucent:!1,EnableSelectionBoundingBox:!1,EnableShadow:!1,EnableAnimation:!0,UseLods:!1,AutoPrepare:!0,DEBUG:!1,ConstraintZoom:!1,RendererWhenLoad:!1,language:"zh-cn"},_=[1,0,0,1,0,0],aa=96,ba={DRAW_LIST_LOAD_START:"DRAW_LIST_LOAD_START",DRAW_LIST_LOAD_COMPLETE:"DRAW_LIST_LOAD_COMPLETE",DRAW_LOAD_ERROR:"DRAW_LOAD_ERROR",ONE_DRAW_LOAD_COMPLETE:"ONE_DRAW_LOAD_COMPLETE",ALL_DRAW_LOAD_COMPLETE:"ALL_DRAW_LOAD_COMPLETE",SHOW_DRAW:"SHOW_DRAW"},ca={LEFT:0,MIDDLE:1,RIGHT:2},da={ORBIT:"orbit",PICK:"pick",PAN:"pan",ZOOM:"zoom"},ea={PICK_BY_RECT:"pickByRect",ZOOM_BY_RECT:"zoomByRect",CLIP_BY_BOX:"clipByBox",CLIP_FILL:"fillClip",PICK_BY_MEASURE:"pickByMeasure",VIEWER3D_CAMERA_CONTROL:"viewer3DCameraControl"},fa={Clear:0,Add:1,Remove:2},ga={ON_LOAD_START:"ON_LOAD_START",ON_LOAD_PROGRESS:"ON_LOAD_PROGRESS",ON_LOAD_COMPLETE:"ON_LOAD_COMPLETE",ON_LOAD_EMPTY_SCENE:"ON_LOAD_EMPTY_SCENE",ON_LOAD_CONFIG_FINISH:"ON_LOAD_CONFIG_FINISH",ON_LOAD_INVALID_SCENE:"ON_LOAD_INVALID_SCENE",ON_NETWORK_ERROR:"ON_NETWORK_ERROR",ACCOUNT_NO_EXIST:"ACCOUNT_NO_EXIST",NO_PERMISSION:"NO_PERMISSION",ON_LOAD_ERROR:"ON_LOAD_ERROR",ON_SELECTION_CHANGED:"ON_SELECTION_CHANGED",ON_RECTPICK_ADD:"ON_RECTPICK_ADD",ON_RECTPICK_REMOVE:"ON_RECTPICK_REMOVE",ON_CLICK_PICK:"ON_CLICK_PICK",ON_HOVER_PICK:"ON_HOVER_PICK",ON_MEASURE_PICK:"ON_MEASURE_PICK",ON_SELECTION_FAILED:"ON_SELECTION_FAILED",ON_CLIP_HOVER:"ON_CLIP_HOVER",ON_CLIP_MOUSE_MOVE:"ON_CLIP_MOUSE_MOVE",ON_CLIP_MOUSE_DOWN:"ON_CLIP_MOUSE_DOWN",ON_VERSION_NO_MATCH:"ON_VERSION_NO_MATCH",ON_VIEWER_RESTORED:"ON_VIEWER_RESTORED",ON_CAMERA_HEIGHT_CHANGED:"ON_CAMERA_HEIGHT_CHANGED",ON_DATABASE_OPEN:"ON_DATABASE_OPEN",ON_DATABASE_CLOSE:"ON_DATABASE_CLOSE",ON_DATABASE_ADD:"ON_DATABASE_ADD",ON_DATABASE_DELETE:"ON_DATABASE_DELETE",ON_DATABASE_CLERA:"ON_DATABASE_CLERA",ON_DATABASE_EEEOR:"ON_DATABASE_EEEOR",ON_CAMERA_CHANGE:"ON_CAMERA_CHANGE",ON_CONTROL_ENTER:"ON_CONTROL_ENTER",ON_CONTROL_EXIST:"ON_CONTROL_EXIST",ON_CONTROL_BEGIN:"ON_CONTROL_BEGIN",ON_CONTROL_END:"ON_CONTROL_END",ON_CONTROL_ZOOM:"ON_CONTROL_ZOOM",ON_CONTROL_UPDATEUI:"ON_CONTROL_UPDATEUI",ON_CONTROL_KEYDOWN:"ON_CONTROL_KEYDOWN",ON_CONTROL_KEYUP:"ON_CONTROL_KEYUP",ON_VIEWER3D_CAMERA_CHANGE:"ON_VIEWER3D_CAMERA_CHANGE"},ha=function(){function a(b){var c=this;e(this,a),this.container=document,this.viewer2D=b.viewer2D,this.passLayerCB=b.passLayerCB,this.invalidKey=["noDraw","fetching"],this.drawStateList={noDraw:{key:"noDraw",name:"暂无图纸"},fetching:{key:"fetching",name:"正在获取图纸"}},this.drawList=[this.drawStateList.fetching],this.popup=!1,this._init(),this.viewer2D.onDrawListLoad=function(a){a.length>0?(c.drawList=o(a),c.viewer2D.showDraw(a[0].key,function(a){c.passLayerCB(a)})):c.drawList=[c.drawStateList.noDraw],c.updateListUI()},this.viewer2D.onDrawLoad=function(a){c.drawList.some(function(b,d){return b.key===a.drawKey&&(c.drawList[d].isLoaded=!0,c.container.querySelector('#viewer2D-draw-option>div[data-key="'.concat(b.key,'"]')).classList.remove("draw-loading"),c.container.querySelector('#viewer2D-draw-option>div[data-key="'.concat(b.key,'"]>span')).setAttribute("draw-loading","false"),!0)})}}return g(a,[{key:"_init",value:function(){var a=this,b='\n            <div class="viewer2D-draw">\n              <div id="viewer2D-draw-select" class="draw-select">\n                <div data-key="fetching">正在获取图纸</div>\n              </div>\n              <div class="draw-option">\n                  <div id="viewer2D-draw-option" class="draw-option-container">\n                  </div>\n              </div>\n            </div>\n        ';b=b.replace(/\s{2,}/g,"");var c=(new DOMParser).parseFromString(b,"text/html");this.container=c.body.firstElementChild.cloneNode(!0),this.container.querySelector("#viewer2D-draw-select").onclick=function(b){a.clickSelect(b)},this.container.querySelector("#viewer2D-draw-option").onclick=function(b){a.changeDraw(b)},this.viewer2D.viewerImpl.domElement.appendChild(this.container)}},{key:"clickSelect",value:function(a){a.preventDefault(),a.stopPropagation(),this.popup?this.container.classList.remove("draw-popup"):this.container.classList.add("draw-popup"),this.popup=!this.popup}},{key:"updateListUI",value:function(){var a=this,b=this.container.querySelector("#viewer2D-draw-option");this.drawList.forEach(function(c,d){var e=document.createElement("div"),f=document.createElement("span");if(f.innerText=c.name.replace(/\.json$/,""),e.setAttribute("data-key",c.key),f.setAttribute("data-key",c.key),e.classList.add("draw-item"),c.isLoaded||(e.classList.add("draw-loading"),f.setAttribute("draw-loading","true")),e.title=f.innerText,e.appendChild(f),0===d){var g=a.container.querySelector("#viewer2D-draw-select");g.removeChild(g.firstChild),g.appendChild(e.cloneNode(!0))}b.appendChild(e)})}},{key:"changeDraw",value:function(a){var b=this;a.preventDefault(),a.stopPropagation();var c=a.target.getAttribute("data-key"),d=a.target.getAttribute("draw-loading");if(c&&"false"===d&&this.invalidKey.indexOf(c)===-1){this.viewer2D.showDraw(c,function(a){b.passLayerCB(a)}),this.popup=!1,this.container.classList.remove("draw-popup");var e=this.container.querySelector("#viewer2D-draw-select");e.removeChild(e.firstChild),e.appendChild(a.target.cloneNode(!0))}}}]),a}(),ia=function(){function a(b){e(this,a),this.container=document,this.showBody=!0,this.expandMode=Boolean(b.expandMode),this.onClose=b.onClose,this._init(b.children,b.parent,b.title,b.className||"")}return g(a,[{key:"_init",value:function(a,b){var c=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"标题",e=arguments.length>3?arguments[3]:void 0,f='\n            <div class="viewer2D-modal '.concat(e,'">\n              <div class="modal-header">\n                <span>').concat(d,'</span>\n                <span class="modal-close" title="点击').concat(this.expandMode?"收起":"关闭",'">\n                  ').concat(this.expandMode?"-":"x",'\n                </span>\n              </div>\n              <div class="modal-body"></div>\n            </div>\n        ');f=f.replace(/\s{2,}/g,"");var g=(new DOMParser).parseFromString(f,"text/html");this.container=g.body.firstElementChild.cloneNode(!0);var h=this.container.querySelector(".modal-close");h.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),c.expandMode?c._switchModalExpand(a):(c._switchModalClose(),"function"==typeof c.onClose&&c.onClose())});var i=this.container.querySelector(".modal-body");i.appendChild(a),b.appendChild(this.container)}},{key:"_switchModalExpand",value:function(a){var b=this.container.querySelector(".modal-body"),c=this.container.querySelector(".modal-header");if(this.showBody){var d=getComputedStyle(b),e=getComputedStyle(c),f=parseInt(d.width,10)-parseInt(e.marginLeft,10)-parseInt(e.marginRight,10)-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10);a.target.innerText="+",c.style="width: ".concat(f,"px"),c.querySelector(".modal-close").setAttribute("title","点击展开"),b.style="display: none"}else a.target.innerText="-",c.removeAttribute("style"),b.removeAttribute("style"),c.querySelector(".modal-close").setAttribute("title","点击收起");this.showBody=!this.showBody}},{key:"_switchModalClose",value:function(){this.switchModalShow(!1)}},{key:"switchModalShow",value:function(a){this.container.style.display=a?"block":"none"}}]),a}(),ja=function(){function a(b){e(this,a),this.container=document,this.viewer2D=b.viewer2D,this.layerList=[],this.modal={},this._init()}return g(a,[{key:"_init",value:function(){var a=this,b="图层选择",c=this.viewer2D.viewerImpl.domElement,d='\n            <div class="viewer2D-Layer">\n              <div id="viewer2D-layer-all" class="layer-all layer-show layer-item" title="点击隐藏图层">\n                全部图层\n              </div>\n              <div id="viewer2D-layer-container" class="layer-container">\n              </div>\n            </div>\n        ';d=d.replace(/\s{2,}/g,"");var e=(new DOMParser).parseFromString(d,"text/html");this.container=e.body.firstElementChild.cloneNode(!0);var f=this.container.querySelector("#viewer2D-layer-container");f.addEventListener("click",function(b){a.switchLayer(b)}),this.container.querySelector("#viewer2D-layer-all").addEventListener("click",function(b){a.switchAllLayer(b)}),this.modal=new ia({children:this.container,title:b,parent:c,className:"viewer2D-js-layer",expandMode:!0}),document.querySelector(".viewer2D-js-layer").style.zIndex="10"}},{key:"changeShowCSS",value:function(a,b){b?(a.classList.remove("layer-hide"),a.classList.add("layer-show"),a.setAttribute("title","点击隐藏图层")):(a.classList.remove("layer-show"),a.classList.add("layer-hide"),a.setAttribute("title","点击显示图层"))}},{key:"switchLayer",value:function(a){a.preventDefault(),a.stopPropagation();var b=a.target.getAttribute("data-key");if(b){var c=a.target.classList.contains("layer-show");c?this.viewer2D.hideDrawLayer(this.layerList[Number(b)]):this.viewer2D.showDrawLayer(this.layerList[Number(b)]),this.changeShowCSS(a.target,!c)}}},{key:"switchAllLayer",value:function(a){var b=this;a.preventDefault(),a.stopPropagation();var c=this.container.querySelector("#viewer2D-layer-all"),d=this.container.querySelector("#viewer2D-layer-container"),e=c.classList.contains("layer-show");e?this.viewer2D.hideAllLayer():this.viewer2D.showAllLayer(),this.changeShowCSS(c,!e),d.childNodes.forEach(function(a){b.changeShowCSS(a,!e)})}},{key:"passDrawer",value:function(a){a&&(this.layerList=o(a),this.updateAllLayerUI())}},{key:"updateAllLayerUI",value:function(){var a=this.container.querySelector("#viewer2D-layer-container");a.innerHTML="";var b=!0;this.layerList.forEach(function(c,d){var e="layer-show",f="点击隐藏图层";c.isVisible===!1&&(e="layer-hide",f="点击显示图层",b=!1);var g='\n                <div class="layer-item '.concat(e,'" title="').concat(f,'" data-key="').concat(d,'">\n                  ').concat(c.name,"\n                </div>\n            ");g=g.replace(/\s{2,}/g,"");var h=(new DOMParser).parseFromString(g,"text/html"),i=h.body.firstElementChild.cloneNode(!0);a.appendChild(i)}),this.changeShowCSS(this.container.querySelector("#viewer2D-layer-all"),b)}}]),a}(),ka=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.className=b.className,this.name=b.name,this.title=b.title||"",this.ui=document.createElement("div"),this.enable=!1,this._init()}return g(a,[{key:"_init",value:function(){this.ui.className="viewer2D-icon ".concat(this.className),this.ui.setAttribute("data-name",this.name),this.ui.setAttribute("title",this.title)}},{key:"changeMode",value:function(a){a!==this.name||this.enable?(this.viewer2D.viewerImpl.controlManager.disableTool(this.name),this.ui.classList.remove("enable"),this.enable=!1):(this.viewer2D.viewerImpl.controlManager.enableTool(this.viewer2D.viewerImpl,this.name),this.ui.classList.add("enable"),this.enable=!0)}}]),a}(),la=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.container=document.createElement("div"),this.pressKey="",this._init()}return g(a,[{key:"_init",value:function(){var a='\n            <div class="viewer2D-mobile-pick-by-rect" style="display: none">\n              <button type="button" data-key="ctrl">增选模式</button>\n              <button type="button" data-key="alt">减选模式</button>\n            </div>\n        ';a=a.replace(/\s{2,}/g,"");var b=(new DOMParser).parseFromString(a,"text/html");this.container=b.body.firstElementChild.cloneNode(!0),this.viewer2D.getViewerImpl().domElement.appendChild(this.container),this.container.addEventListener("click",this._onClick.bind(this))}},{key:"_onClick",value:function(a){a.preventDefault(),a.stopPropagation();var b=a.target.getAttribute("data-key");b&&(b===this.pressKey?(this.pressKey="",a.target.style.removeProperty("background-color")):(a.target.style.backgroundColor="skyblue",this.pressKey&&this.container.querySelector("[data-key="+this.pressKey+"]").style.removeProperty("background-color"),this.pressKey=b),this.viewer2D.viewerImpl.controlManager.getToolByName("pickByRect").setPressKey(this.pressKey))}},{key:"show",value:function(a){a?this.container.style.removeProperty("display"):(this.container.style.display="none",this.container.querySelectorAll("button").forEach(function(a){a.style.removeProperty("background-color")}),this.pressKey="")}}]),a}(),ma={"zh-cn":{YourGraphicsCardDoesNotSeemToSupportWebGL:"您的显卡似乎不支持WebGL",YourBrowserDoesNotSeemToSupportWebGL:"您的浏览器似乎不支持WebGL",FindOutHowToGetItHere:"您可以在这里查看相关信息",SectionBoxLockHint:"请在使用此方法之前调用enableSectionBox。",APIAxisLockHint:"The API supports AxisOption.Z only for now."},en:{YourGraphicsCardDoesNotSeemToSupportWebGL:"Your graphics card does not seem to support WebGL",YourBrowserDoesNotSeemToSupportWebGL:"Your browser does not seem to support WebGL",FindOutHowToGetItHere:"Find out how to get it here",SectionBoxLockHint:"Please call enableSectionBox before using this method.",APIAxisLockHint:"The API supports AxisOption.Z only for now."}},na={};na.getAndroidVersion=function(a){a=a||navigator.userAgent;var b=a.match(/Android\s([0-9.]*)/);return!!b&&b[1]},na.isTouchDevice=function(){return"undefined"!=typeof window&&"ontouchstart"in window},na.isBrowser=function(){return"undefined"!=typeof navigator},na.isIE11=function(){return na.isBrowser()&&Boolean(navigator.userAgent.match(/Edge|Trident\/7\./))},na.isIOSDevice=function(){return!!na.isBrowser()&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())},na.isAndroidDevice=function(){return!!na.isBrowser()&&navigator.userAgent.toLowerCase().indexOf("android")!==-1},na.isMobileDevice=function(){return!!na.isBrowser()&&(na.isIOSDevice()||na.isAndroidDevice())},na.isSafari=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("safari")!==-1&&a.indexOf("chrome")===-1},na.isFirefox=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("firefox")!==-1},na.isChrome=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("chrome")!==-1},na.isMac=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("mac os")!==-1},na.isLinux=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("linux x86_64")!==-1},na.isWindows=function(){if(!na.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("win32")!==-1||a.indexOf("windows")!==-1},na.isWindowsPhone=function(){var a=navigator.userAgent.toLowerCase();return/(?:Windows Phone)/.test(a)},na.isSymbian=function(){var a=navigator.userAgent.toLowerCase();return/(?:SymbianOS)/.test(a)||na.isWindowsPhone()},na.isTablet=function(){var a=navigator.userAgent.toLowerCase();return/(?:iPad|PlayBook)/.test(a)||na.isAndroidDevice()&&!/(?:Mobile)/.test(a)||na.isFirefox()&&/(?:Tablet)/.test(a)},na.isPc=function(){return!na.isMobileDevice()&&!na.isTablet()&&!na.isSymbian()},na.isOpera=function(){var a=navigator.userAgent;return a.indexOf("Opera")>-1};(function(){return na.isSafari()?function(a){if(!window.Polymer)return a;for(var b in a)if(b.indexOf("__impl")!==-1)return a[b];return a}:function(a){return a}})();na.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl"],c=!1,d=0;d<b.length;d+=1)try{if(c=a.getContext(b[d]),c&&"function"==typeof c.getParameter)return 1}catch(e){}return 0}return-1},na.detectWebGL2=function(){if(window.WebGL2RenderingContext){for(var a=document.createElement("canvas"),b=["webgl2"],c=!1,d=0;d<b.length;d+=1)try{if(c=a.getContext(b[d]),c&&"function"==typeof c.getParameter)return 1}catch(e){}return 0}return-1},na.showWebGLMessage=function(a,b,c){var d=null,e=null,f=null;c=c||{},d=void 0!==c.parent?c.parent:document.body,e=void 0!==c.id?c.id:"oldie",f=na.getWebGLErrorMessage(a,b),f.id=e,d.appendChild(f)},na.language=function(){return(navigator.browserLanguage||navigator.language).toLowerCase()},na.getWebGLErrorMessage=function(a,b){var c=document.createElement("div");c.id="webgl-error-message",c.style.fontSize="16px",c.style.fontWeight="normal",c.style.textAlign="center",c.style.background="#f4c8c8",c.style.color="#000",c.style.padding="1.5em",c.style.width="400px",c.style.position="absolute",c.style.left=document.body.clientWidth/2-224+"px";var d=document.body.clientHeight/2-45;return d<0&&(d=0),c.style.top=d+"px",b||(b="zh-cn"),0===a?c.innerHTML=[' <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">'+ma[b].YourGraphicsCardDoesNotSeemToSupportWebGL+"</a>.<br />",' <a href="http://get.webgl.org/" style="color:#000">'+ma[b].FindOutHowToGetItHere+"</a>."].join("\n"):a===-1&&(c.innerHTML=['<a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">'+ma[b].YourBrowserDoesNotSeemToSupportWebGL+"</a>.<br/>",'<a href="http://get.webgl.org/" style="color:#000">'+ma[b].FindOutHowToGetItHere+"</a>."].join("\n")),c},na.isSupportIndexedDB=function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},na.isSupportWorker=function(){return window.Worker};var oa={splitStr:function(a){return a.trim().split(/\s+/g)},getClientHeight:function(){var a=0;return a=document.body.clientHeight&&document.documentElement.clientHeight?document.body.clientHeight<document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight:document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight},getClientWidth:function(){var a=0;return a=document.body.clientWidth&&document.documentElement.clientWidth?document.body.clientWidth<document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth:document.body.clientWidth>document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth},getDomOffsetToClient:function(a){var b=null,c=function(a){for(var b=0,c=0;a;)b+=a.offsetTop,c+=a.offsetLeft,a=a.offsetParent;var d=document.body,e=document.documentElement,f=window.pageYOffset||e.scrollTop||d.scrollTop,g=window.pageXOffset||e.scrollLeft||d.scrollLeft;return b-=f,c-=g,{top:b,left:c}},d=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=d.clientTop||c.clientTop,f=d.clientLeft||c.clientLeft,g=b.top-e,h=b.left-f;return{top:Math.round(g),left:Math.round(h)}},e=function(a){return a.getBoundingClientRect?d(a):c(a)};if(a!==document){var f=e(a);b={width:a.offsetWidth,height:a.offsetHeight,left:f.left,top:f.top}}else b={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return b},setClassName:function(a,b){var c=document.getElementById(a);c&&(c.className=b)},addClassName:function(a,b){var c=null,d=null,e=null,f=null,g=null,h=/\s+/,i=document.getElementById(a);if(i&&(d=i,b&&"string"==typeof b&&(c=b.split(h),1===d.nodeType)))if(d.className||1!==c.length){for(e=" "+d.className+" ",f=0,g=c.length;f<g;f+=1)e.indexOf(" "+c[f]+" ")<0&&(e+=c[0]+" ");d.className=String.trim(e)}else d.className=b},removeClassName:function(a,b){var c=null,d=null,e=null,f=null,g=null,h=/\s+/,i=document.getElementById(a);if(i&&(e=i,b&&"string"==typeof b&&(c=(b||"").split(h),1===e.nodeType&&e.className))){for(d=(" "+e.className+" ").replace(0," "),f=0,g=c.length;f<g;f+=1)for(;d.indexOf(" "+c[f]+" ")>=0;)d=d.replace(" "+c[f]+" "," ");e.className=b?String.trim(d):""}},showOrHideElement:function(a,b){var c=document.getElementById(a);c&&(b?c.style.display="":c.style.display="none")},getStyleString:function(a){var b=[];for(var c in a){var d=a[c];b.push(c),b.push(":"),b.push(d),b.push("; ")}return b.join("")},cloneStyle:function(a){var b={};for(var c in a)b[c]=a[c];return b},removeStyleAttribute:function(a,b){Array.isArray(b)||(b=[b]),b.forEach(function(b){b in a&&delete a[b]})},trimRight:function(a){if(0===a.length)return"";for(var b=a.length-1,c=b;c>=0;c-=1)if(" "!==a.charAt(c)){b=c;break}return a.substr(0,b+1)},trimLeft:function(a){if(0===a.length)return"";for(var b=0,c=0;c<a.length;c+=1)if(" "!==a.charAt(c)){b=c;break}return a.substr(b)},trim:function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},matchesSelector:function(a,b){if(a.matches)return a.matches(b);if(a.matchesSelector)return a.matchesSelector(b);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(b);if(a.msMatchesSelector)return a.msMatchesSelector(b);if(a.mozMatchesSelector)return a.mozMatchesSelector(b);if(a.oMatchesSelector)return a.oMatchesSelector(b);if(a.querySelectorAll){for(var c=(a.document||a.ownerDocument).querySelectorAll(b),d=0;c[d]&&void 0!==c[d];)d+=1;return!!c[d]}return!1},toTranslate3d:function(a,b){return"translate3d("+a+"px,"+b+"px,0)"},setCursorStyle:function(a,b){var c=null;switch(b){case"n":case"s":c="ns-resize";break;case"w":case"e":c="ew-resize";break;case"ne":case"sw":c="nesw-resize";break;case"nw":case"se":c="nwse-resize"}a.style.cursor=c},css:function(a,b){for(var c=a.getAttribute("style")||"",d=Object.keys(b),e=c.split(";"),f=[],g=0,h=e.length;g<h;g+=1){var i=e[g];""!==i?f.push(i.replace(/:.+/,"")):e.splice(g,1)}for(var g=0,h=d.length;g<h;g+=1){var i=d[g],j=-1;e.map(function(a,b){return a.indexOf(i)>-1&&(j=b),null}),j>-1?e[j]=i+":"+b[i]:e.push(i+":"+b[i])}var k=e.join(";");a.setAttribute("style",k+";")},append:function(a,b){if("string"==typeof b){var c=document.createElement("div");c.innerHTML=b;for(var d=document.createDocumentFragment();c.firstChild;)d.appendChild(c.firstChild);a.appendChild(d)}else a.appendChild(b)},scrollTop:function(a,b){var c=a.scrollTop;if(c>b)var d=setInterval(function(){var c=a.scrollTop,e=Math.floor(-c/6);a.scrollTop=c=e+c,a.scrollTop<=b&&(a.scrollTop=a.scrollTop=b,clearTimeout(d))},20);else if(0===c)var e=setInterval(function(){var d=a.scrollTop,f=Math.floor(70);a.scrollTop=d=f+d,a.scrollTop<c&&(a.scrollTop=b,clearTimeout(e))},20);else if(c<b)var f=setInterval(function(){var d=a.scrollTop,e=Math.floor(d/6);a.scrollTop=d=e+d,a.scrollTop<c&&(a.scrollTop=b,clearTimeout(f))},20);else if(b===c)return!1},closest:function(a,b){if(!a)return null;for(var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;a&&!c.call(a,b);)a=a.parentElement;return a},addEventListener:function(a,b,c){if(a)if(a.length)for(var d=0;d<a.length;d+=1)a[d].addEventListener(b,function(a){c&&"function"==typeof c&&c(a)});else a.addEventListener(b,function(a){c&&"function"==typeof c&&c(a)})},remove:function(a){if(a)if(a.removeNode=[],void 0!==a.length){for(var b=a.length,c=0;c<b;c+=1)a.removeNode.push({parent:a[c].parentNode,inner:a[c].outerHTML,next:a[c].nextSibling});for(var c=0;c<b;c+=1)a[0].parentNode.removeChild(a[0])}else a.removeNode.push({parent:a.parentNode,inner:a.outerHTML,next:a.nextSibling}),a.parentNode.removeChild(a)},getStyleValue:function(a,b){var c=a.ownerDocument.defaultView;return c&&c.opener||(c=window),a.currentStyle?a.currentStyle[b]:c.getComputedStyle(a)[b]},isShow:function(a){var b=this.getStyleValue(a,"display");return"none"!==b},getHeight:function(a){if(null!==a&&void 0!==a){if(this.isShow(a)){if(null!==a.style.height&&void 0!==a.style.height&&a.style.height.length>0)return parseFloat(a.style.height);if(parseFloat(this.getStyleValue(a,"height"))>0)return parseFloat(this.getStyleValue(a,"height"));if(a.offsetHeight>0){var b=this.getStyleValue(a,"borderTopWidth"),c=this.getStyleValue(a,"borderBottomWidth"),d=this.getStyleValue(a,"paddingTop"),e=this.getStyleValue(a,"paddingBottom"),f=parseFloat(a.offsetHeight)-parseFloat(b)-parseFloat(c)-parseFloat(d)-parseFloat(e);return parseFloat(f)}return 0}var g=a.getAttribute("style")||"",h=g+"visibility:hidden;display:block !important;";a.setAttribute("style",h);var i=this.getHeight(a);return a.setAttribute("style",g),Math.ceil(i)}},getWidth:function(a){if(null!==a&&void 0!==a){if(this.isShow(a)){if(null!==a.style.width&&void 0!==a.style.width&&a.style.width.length>0)return parseFloat(a.style.width);if(parseFloat(this.getStyleValue(a,"width"))>0)return parseFloat(this.getStyleValue(a,"width"));if(a.offsetWidth>0){var b=this.getStyleValue(a,"borderLeftWidth"),c=this.getStyleValue(a,"borderRightWidth"),d=this.getStyleValue(a,"paddingLeft"),e=this.getStyleValue(a,"paddingRight"),f=parseFloat(a.offsetWidth)-parseFloat(b)-parseFloat(c)-parseFloat(d)-parseFloat(e);return parseFloat(f)}return 0}var g=a.getAttribute("style")||"",h=g+"visibility:hidden;display:inline-block !important;";a.setAttribute("style",h);var i=this.getWidth(a);return a.setAttribute("style",g),Math.ceil(i)}},outerHeight:function(a,b){var c=a.offsetHeight;if(b){var d=a.currentStyle||getComputedStyle(a);c+=parseInt(d.marginTop,0)+parseInt(d.marginBottom,0)}return c},outerWidth:function(a,b){var c=a.offsetWidth;if(b){var d=a.currentStyle||getComputedStyle(a);c+=parseInt(d.marginLeft,0)+parseInt(d.marginRight,0);
}return c},isEmptyObject:function(a){var b=null;for(b in a)return!1;return!0},hasClass:function(a,b){if(a){var c=a.className.match&&a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"));return Boolean(c)}return!1},addClass:function(a,b){a&&(this.hasClass(a,b)||(a.className+=" "+b))},removeClass:function(a,b){if(this.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}},toggleClass:function(a,b){this.hasClass(a,b)?this.removeClass(a,b):this.addClass(a,b)},simulateEvent:function(a,b){var c=document.createEvent("Event");c.initEvent(b,!0,!0);!a.dispatchEvent(c)},bind:function(a,b,c){a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)},delegate:function(a,b,c,d){if(a)if(a.length)for(var e=0;e<a.length;e+=1)this.delegateFn(a[e],b,c,d);else this.delegateFn(a,b,c,d)},delegateFn:function(a,b,c,d){function e(a){var a=a||window.event,e=a.target||a.srcElement;f.matchSelector(e,b)&&d&&("mouseenter"===c||"mouseleave"===c?f.fixedMouse(a,e)&&d.call(e,a):d.call(e,a))}var f=this;c=c.toLowerCase(),a.addEventListener?"mouseenter"===c?a.addEventListener("mouseover",e):"mouseleave"===c?a.addEventListener("mouseout",e):a.addEventListener(c,e):"mouseenter"===c?a.attachEvent("onmouseover",e):"mouseleave"===c?a.attachEvent("onmouseout",e):a.attachEvent("on"+c,e)},matchSelector:function(a,b){return"#"===b.charAt(0)?a.id===b.slice(1):"."===b.charAt(0)?(" "+a.className+" ").indexOf(" "+b.slice(1)+" ")!==-1:a.tagName.toLowerCase()===b.toLowerCase()},contains:function(a,b){return a.contains?a!==b&&a.contains(b):Boolean(16&a.compareDocumentPosition(b))},fixedMouse:function(a,b){var c=null,d=a.type.toLowerCase();if("mouseover"===d)c=a.relatedTarget||a.fromElement;else{if("mouseout"!==d)return!0;c=a.relatedTarget||a.toElement}return c&&"xul"!==c.prefix&&!this.contains(b,c)&&c!==b},fireEvent:function(a,b){var c=null;if(a.ownerDocument)c=a.ownerDocument;else{if(9!==a.nodeType)throw new Error("Invalid node passed to fireEvent: "+a.id);c=a}if(a.dispatchEvent){var d="";switch(b){case"click":case"mousedown":case"mouseup":d="MouseEvents";break;case"focus":case"change":case"blur":case"select":d="HTMLEvents";break;default:G.error("fireEvent: Couldn't find an event class for event '"+b+"'.")}var e=c.createEvent(d),f="change"!==b;e.initEvent(b,f,!0),e.synthetic=!0,a.dispatchEvent(e,!0)}else if(a.fireEvent){var e=c.createEventObject();e.synthetic=!0,a.fireEvent("on"+b,e)}}},pa=function(a,b){var c=document.createElement(a);return c.setAttribute("class",b),c};oa.create=pa;var qa=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);return c.setAttribute("class",b),c};oa.createNS=qa;var ra=function(a){return a.indexof("#")?document.getElementById(a.replace("#","")):a.indexof(".")?document.getElementsByClassName(a.replace(".","")):document.getElementsByTagName(a)};oa.select=ra;var sa=function(a){if(""===a)return 0;if("string"==typeof a){if(a.indexOf("px")===-1){var b=Number(a);return isNaN(b)?0:b}var c=a.split("px"),d=Number(c[0]);return isNaN(d)?0:d}return 0},ta=function(a){var b=na.isPc(),c={element:null,handle:null,axis:"all",cursor:"move",distance:0,start:null,move:null,stop:null},d=Object.assign(c,a),e=d.element;if(!e)return!1;var f=d.handle||e,g=void 0,h=!1,i=function(a){return Math.pow(a.x,2)+Math.pow(a.y,2)>Math.pow(d.distance,2)&&(d.start&&d.start(g),!0)},j=function(a){var b=navigator.userAgent,c=b.indexOf("compatible")>-1&&b.indexOf("MSIE")>-1&&!na.isOpera();return c?1===a:0===a},k=function(a){var b=e.offsetLeft,c=e.offsetTop,f=sa(getComputedStyle(e).marginLeft),g=sa(getComputedStyle(e).marginTop);b-=f,c-=g;var h=b+a.x<0?0:b+a.x,i=c+a.y<0?0:c+a.y;switch(d.axis){case"x":e.style.left=h+"px";break;case"y":e.style.top=i+"px";break;case"all":default:e.style.left=h+"px",e.style.top=i+"px"}},l=function(a){var c=a;if(b)var e={x:c.clientX,y:c.clientY};else var e={x:c.touches[0].clientX,y:c.touches[0].clientY};var f={x:e.x-g.x,y:e.y-g.y};h?(d.move&&d.move(g,e,f),g=e,k(f)):h=i(f)},m=function(a){var c=a;if(b){if(!j(c.button))return;g={x:c.clientX,y:c.clientY},document.addEventListener("mousemove",l)}else g={x:c.touches[0].clientX,y:c.touches[0].clientY},f.addEventListener("touchmove",l);d.start&&d.start(g)},n=function(){h&&d.end&&d.end(g),h=!1,document.removeEventListener("mousemove",l),f.removeEventListener("touchmove",l)};b?(f.style.cursor=d.cursor,f.style.userSelect="none",f.addEventListener("mousedown",m),document.addEventListener("mouseup",n)):(f.addEventListener("touchend",n),f.addEventListener("touchstart",m))};oa.drag=ta;var ua=function(a){var b={element:null,axis:"all",minWidth:100,minHeight:100,distance:0,start:null,sizable:null,stop:null},c=Object.assign(b,a),d=c.element;if(!d)return!1;var e=void 0,f=!1,g=oa.create("div","yj-resize"),h=function(a){return Math.pow(a.x,2)+Math.pow(a.y,2)>Math.pow(c.distance,2)&&(c.start&&c.start(e),!0)},i=function(a){var b=navigator.userAgent,c=b.indexOf("compatible")>-1&&b.indexOf("MSIE")>-1&&!na.isOpera();return c?1===a:0===a},j=void 0,k=void 0,l=function(a){var b=d.offsetLeft,e=d.offsetTop,f=j+a.x<c.minWidth?c.minWidth:j+a.x,g=k+a.y<c.minHeight?c.minHeight:k+a.y;switch(c.resize&&c.resize(f,g),d.style.left=b+"px",d.style.top=e+"px",c.axis){case"x":d.style.width=f+"px";break;case"y":d.style.height=g+"px";break;case"all":default:d.style.width=f+"px",d.style.height=g+"px"}},m=function(a){var b=a,d={x:b.clientX,y:b.clientY},g={x:d.x-e.x,y:d.y-e.y};f?(c.sizable&&c.sizable(e,d,g),l(g)):f=h(g)},n=function(a){j=d.clientWidth,k=d.clientHeight;var b=a;i(b.button)&&(e={x:b.clientX,y:b.clientY},document.addEventListener("mousemove",m),document.addEventListener("touchmove",m))},o=function(){f&&c.end&&c.end(e),f=!1,document.removeEventListener("mousemove",m),document.removeEventListener("touchmove",m)};oa.addClass(d,"yj-sizable"),d.appendChild(g),g.addEventListener("mousedown",n),g.addEventListener("touchstart",n),document.addEventListener("mouseup",o),document.addEventListener("touchend",o)};oa.sizable=ua;var va=function(a){var b=this,c={element:null,min:0,max:100,cur:50,step:1,isShowProgress:!0,input:null,change:null,currentColor:"#11dab7",defaultColor:"#999"},d=Object.assign(c,a);this._opt=d;var e=oa.create("div","yj-range"),f=oa.create("input","yj-input-range");b.input=f,f.setAttribute("type","range"),f.setAttribute("step",d.step),f.setAttribute("min",d.min),f.setAttribute("max",d.max),f.setAttribute("value",d.cur);var g=oa.create("span","yj-range-min");g.innerText=d.min;var h=oa.create("span","yj-range-cur");b.cur=h,h.innerText=d.cur;var i=oa.create("span","yj-range-max");i.innerText=d.max;var j=oa.create("span","yj-range-progress");e.appendChild(f),d.isShowProgress&&(e.appendChild(g),e.appendChild(h),e.appendChild(i)),e.appendChild(j),d.element.appendChild(e),b.setProgress(d.cur),f.addEventListener("input",function(){b.setProgress(this.value),d.input&&d.input(this.value)}),f.addEventListener("change",function(){b.setProgress(this.value),d.change&&d.change(this.value)})};va.prototype.setProgress=function(a){var b=this._opt,c=b.max-b.min,d=this.input,e=this.cur,f=(a-b.min)/c*100;d.value=a,d.style.background="linear-gradient(to right,"+b.currentColor+" 0%,"+b.currentColor+"  "+f+"%,"+b.defaultColor+" "+f+"%, "+b.defaultColor+" 100%)",e.innerText=a},va.prototype.reset=function(){this.setProgress(this._opt.cur)},oa.range=va;var wa=function(a){var b={element:null,min:0,max:100,from:null,to:null,step:1,currentColor:"#11dab7",defaultColor:"#999",change:null};this._opt=Object.assign(b,a),this._opt.from=this._opt.from||this._opt.min,this._opt.to=this._opt.to||this._opt.max,this.init()};wa.prototype={init:function(){var a=oa.create("div","yj-multiple-range"),b=oa.create("div","yj-range-track"),c=oa.create("span","yj-slider yj-slider-min");c.id="minSlider",c.type="minimum";var d=oa.create("span","yj-slider yj-slider-max");d.id="maxSlider",d.type="maximum",this._state={from:this._opt.from,to:this._opt.to},b.style.backgroundColor=this._opt.currentColor,a.style.backgroundColor=this._opt.defaultColor,a.appendChild(b),a.appendChild(c),a.appendChild(d),this._opt.element.appendChild(a),this._track=b,this._sliders={min:c,max:d},this._element=a,this.bindEvent(),this.update(!1)},bindEvent:function(){var a=this,b=!1,c=null,d=null,e=function(a){var a=a||event;d=a.screenX,c=this,b=!0},f=function(e){if(b){var e=e||event,f=e.screenX-d,g=Math.round(f/a._pix/a._opt.step)*a._opt.step;0!==g&&(d=g*a._pix+d,"minimum"===c.type?a._state.from+=g:a._state.to+=g,a.recalculate(c),a.update(!0))}},g=function(){c=null,b=!1};this._sliders.min.addEventListener("mousedown",e),this._sliders.max.addEventListener("mousedown",e),document.addEventListener("mousemove",f),document.addEventListener("mouseup",g)},update:function(a){var b=this._sliders.min.offsetWidth,c=this._sliders.max.offsetWidth;if(!this._pix){var d=this._element.offsetWidth,e=this._opt.max-this._opt.min,f=(d-b-c)/e;this._pix=f}var g=(this._state.from-this._opt.min)*this._pix,h=(this._state.to-this._opt.min)*this._pix+b+c;this._track.style.left=g+b/2+"px",this._track.style.width=h-g-b/2-c/2+"px",this._sliders.min.style.left=g+"px",this._sliders.max.style.left=h+"px",this._opt.change&&a&&this._opt.change(this._state)},recalculate:function(a){this._state.to>=this._opt.max&&(this._state.to=this._opt.max),this._state.from<=this._opt.min&&(this._state.from=this._opt.min),a&&("maximum"===a.type&&this._state.to<=this._state.from&&(this._state.to=this._state.from),"minimum"===a.type&&this._state.from>=this._state.to&&(this._state.from=this._state.to))},getProgress:function(){return this._state},setProgress:function(a){this._state=a,this.recalculate(),this.update(!1)}},oa.multipleRange=wa;var xa=function(){function a(a,b){this.$input=null,this.$type="prompt","object"==d(a)?b=a:this.$promptType=a,b=X.extend(!0,{},g.prompt.DEFAULT_OPTIONS,b),this.$options=this._processInput(b),this._init(),this.debug(this)}function b(a){this.$type="confirm",this.$options=this._processInput(a),this._init(),this.debug(this)}function c(a,b){this.$type=a,this.$options=this._processInput(b),this._init(),this.debug(this)}function e(a){this.$type="progress",this.$progressBarElement=null,this.$options=this._processInput(a),this.$progress=0,this._init(),this.debug(this)}function f(a,b){this.$type=a,this.$options=this._processInput(b),this._init(),this.debug(this)}var g=this;Math.randomString=function(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;d<a;d+=1)b+=c.charAt(Math.floor(Math.random()*c.length));return b},g.viewport=document.body,g.counter=0,g.prompt=function(b,c){return new a(b,c)},g.confirm=function(a){return new b(a)},g.progress=function(a){return new e(a)},g.error={},g.success={},g.warning={},g.info={},g.alert=function(a,b){if(["success","error","warning","info"].indexOf(a)>-1)return new c(a,b)},g.window=function(a){return new f("window",a)};var h={$type:null,$el:null,$options:null,debug:function(){this.$options.debug&&window.console.debug.apply(window.console,arguments)},_processInput:function(a){if(Array.isArray(a.buttons)){for(var b={},c=0;c<a.buttons.length;c+=1)b[a.buttons[c]]=g.base.OPTIONS.buttons[a.buttons[c]];a.buttons=b}a.customBtnClass=a.customBtnClass?a.customBtnClass:g.base.DEFAULTS.customBtnClass;for(var c in a.buttons)if(a.buttons.hasOwnProperty(c)){var d=a.buttons[c];d=X.extend(!0,{},g.base.OPTIONS.buttons[c],d),d["class"]||(d["class"]=a.customBtnClass),a.buttons[c]=d}return a=X.extend(!0,{},g.base.DEFAULTS,a),void 0===a.showClass&&(a.showClass=g.base.OPTIONS.showClass),void 0===a.hideClass&&(a.hideClass=g.base.OPTIONS.hideClass),void 0===a.baseClass&&(a.baseClass=g.base.OPTIONS.baseClass),void 0===a.delayToRemove&&(a.delayToRemove=g.base.OPTIONS.delayToRemove),a.iconClass||(a.iconClass=g.base.OPTIONS.icons[a.iconSource][this.$type]),a},_init:function(){var a=this;a._createMarkup(),a.setTitle(a.$options.title),a.$options.draggable&&!a._isMobileScreen()&&(a.$el.classList.add("draggable"),a._enableDrag()),a.$options.closeButton&&a._addCloseButton(),a.$options.closeOnEsc&&document.addEventListener("keyup.lobibox",function(b){27===b.which&&a.destroy()}),a.$options.baseClass&&a.$el.classList.add(a.$options.baseClass),a.$options.showClass&&(a.$el.classList.remove(a.$options.hideClass),a.$el.classList.add(a.$options.showClass)),a.$options.id&&a.$el.setAttribute("id",a.$options.id),a.$el.dataset.lobibox=a},_calculatePosition:function(a){var b,c=this;b="top"===a?30:"bottom"===a?window.outerHeight-oa.outerHeight(c.$el)-30:(window.outerHeight-oa.outerHeight(c.$el))/2;var d=(window.outerWidth-oa.outerWidth(c.$el))/2;return"left:"+d+"px;top:"+b+"px;"},_createButton:function(a,b){var c=this,d=document.createElement("button"),e=[];return b&&b["class"]&&(e=b["class"].split(" ")),e.map(function(a,b){d.classList.add(a)}),d.dataset.type=a,d.innerHTML=b.text,c.$options.callback&&"function"==typeof c.$options.callback&&d.addEventListener("click",function(b){var d=this;c._onButtonClick(c.$options.buttons[a],a),c.$options.callback(c,d.dataset.type,b)}),d},_onButtonClick:function(a,b){var c=this;("ok"===b&&"prompt"===c.$type&&c.isValid()||"prompt"!==c.$type||"ok"!==b)&&a&&a.closeOnClick&&c.destroy()},_generateButtons:function(){var a=this,b=[];for(var c in a.$options.buttons)if(a.$options.buttons.hasOwnProperty(c)){var d=a.$options.buttons[c],e=a._createButton(c,d);b.push(e)}return b},_createMarkup:function(){var a=this,b=document.createElement("div");b.className="lobibox",b.dataset.isModal=a.$options.modal,a.$options.backdrop?b.dataset.backdrop=!0:b.dataset.backdrop=!1;var c=document.createElement("div");c.className="lobibox-header",b.appendChild(c);var d=document.createElement("span");d.className="lobibox-title",c.appendChild(d);var e=document.createElement("div");if(e.className="lobibox-body",b.appendChild(e),a.$options.buttons&&!X.isEmptyObject(a.$options.buttons)){var f=document.createElement("div");f.className="lobibox-footer";var h=a._generateButtons();h.map(function(a,b){f.appendChild(a)}),b.appendChild(f),g.base.OPTIONS.buttonsAlign.indexOf(a.$options.buttonsAlign)>-1&&f.classList.add("text-"+a.$options.buttonsAlign)}b.classList.add(g.base.OPTIONS.modalClasses[a.$type]),a.$el=b},_setSize:function(){var a=this;a.setWidth(a.$options.width),"auto"===a.$options.height?a.setHeight(oa.outerHeight(a.$el)):a.setHeight(a.$options.height)},_calculateBodyHeight:function(a){var b=this,c=b.$el.querySelector(".lobibox-header").outerHeight,d=b.$el.querySelector(".lobibox-footer").outerHeight;return a-(c?c:0)-(d?d:0)},_addBackdrop:function(){if(0===document.querySelectorAll(".lobibox-backdrop").length){var a=document.createElement("div");a.className="lobibox-backdrop",g.viewport.appendChild(a)}},_removeBackdrop:function(){for(var a=document.querySelectorAll(".lobibox-backdrop"),b=0;b<a.length;b+=1)a[b].remove()},_triggerEvent:function(a){var b=this;b.$options[a]&&"function"==typeof b.$options[a]&&b.$options[a](b)},_calculateWidth:function(a){var b=this;return a=Math.min(Math.max(a,b.$options.width),window.outerWidth),a===window.outerWidth&&(a-=2*b.$options.horizontalOffset),a},_calculateHeight:function(a){var b=this;return a=Math.min(Math.max(a,b.$options.height),window.outerHeight),a===window.outerHeight&&(a-=2*b.$options.verticalOffset),a},_addCloseButton:function(){var a=this,b=document.createElement("span");b.className="btn-close",b.innerHTML="&times;",a.$el.querySelector(".lobibox-header").appendChild(b),b.addEventListener("mousedown",function(a){a.stopPropagation()}),b.addEventListener("click",function(){a.destroy()})},_position:function(){var a=this;a._setSize();var b=a._calculatePosition();a.setPosition(b.left,b.top)},_isMobileScreen:function(){return window.outerHeight<768},_enableDrag:function(){var a=this.$el,b=a.querySelector(".lobibox-header");b.addEventListener("mousedown",function(b){b.preventDefault(),a.setAttribute("offset-left",b.offsetX),a.setAttribute("offset-top",b.offsetY),a.setAttribute("allow-drag","true")}),document.addEventListener("mouseup",function(){a.setAttribute("allow-drag","false")}),document.addEventListener("mousemove",function(b){if("true"===a.getAttribute("allow-drag")){var c=b.clientX,d=b.clientY;d<0&&(d=5),d>document.body.clientHeight&&(d=document.body.clientHeight-10),c<0&&(c=5),c>document.body.clientWidth-a.offsetWidth&&(c=document.body.clientWidth-a.offsetWidth),a.style.cssText+="left:"+c+"px;top:"+d+"px;"}}),b.addEventListener("touchstart",function(b){var c=a.style.left,d=a.style.top,e=b.originalEvent.targetTouches[0].clientX,f=b.originalEvent.targetTouches[0].clientY;a.setAttribute("offset-left",e-c),a.setAttribute("offset-top",f-d),a.setAttribute("allow-drag","true")}),document.addEventListener("touchend",function(){a.setAttribute("allow-drag","false")}),document.addEventListener("touchmove",function(b){if("true"===a.getAttribute("allow-drag")){var c=b.originalEvent.targetTouches[0].clientX,d=b.originalEvent.targetTouches[0].clientY;d<0&&(d=5),d>document.body.clientHeight&&(d=document.body.clientHeight-10),c<0&&(c=5),c>document.body.clientWidth-a.offsetWidth&&(c=document.body.clientWidth-a.offsetWidth),a.style.cssText+="left:"+c+"px;top:"+d+"px;"}})},_setContent:function(a){var b=this;return a&&("string"==typeof a&&a.constructor==String?b.$el.querySelector(".lobibox-body").innerHTML=a:b.$el.querySelector(".lobibox-body").appendChild(a)),b},_beforeShow:function(){var a=this;a._triggerEvent("onShow")},_afterShow:function(){var a=this;g.counter++,a.$el.setAttribute("data-nth",g.counter),a.$options.draggable||window.addEventListener("resize.lobibox-"+a.$el.getAttribute("data-nth"),function(){a.refreshWidth(),a.refreshHeight(),a.$el.style.cssText+="left:50%;top:50%;margin-left:"+-a.$el.width/2+"px;margin-top:"+-a.$el.height/2+"px;"}),a._triggerEvent("shown")},_beforeClose:function(){var a=this;a._triggerEvent("beforeClose")},_afterClose:function(){var a=this;a.$options.draggable||window.removeEventListener("resize.lobibox-"+a.$el.getAttribute("data-nth")),a._triggerEvent("closed")},_beforeHide:function(){var a=this;a._triggerEvent("beforeHide")},_afterHide:function(){var a=this;a._triggerEvent("afterHide")},hide:function(){function a(){b.$el.classList.add("lobibox-hidden");for(var a=document.querySelectorAll(".lobibox"),c=[].slice.call(a),d=0;d<c.length;d+=1)c[d].dataset.isModal!==!0&&c.splice(d,1);for(var d=0;d<c.length;d+=1)c[d].classList.contains("lobibox-hidden")&&c.splice(d,1);if(0===c.length){for(var e=document.querySelectorAll(".lobibox-backdrop"),d=0;d<e.length;d+=1)g.viewport.removeChild(e[d]);g.viewport.classList.remove(g.base.OPTIONS.bodyClass)}b._afterHide()}var b=this;return b._beforeHide(),b.$options.hideClass?(b.$el.classList.remove(b.$options.showClass),b.$el.classList.add(b.$options.hideClass),setTimeout(function(){a()},b.$options.delayToRemove)):a(),this},destroy:function(){function a(){b.$el.remove();for(var a=document.querySelectorAll(".lobibox"),c=[].slice.call(a),d=0;d<c.length;d+=1)"true"!==c[d].dataset.isModal&&c.splice(d,1);if(0===c.length){for(var e=document.querySelectorAll(".lobibox-backdrop"),d=0;d<e.length;d+=1)g.viewport.removeChild(e[d]);g.viewport.classList.remove(g.base.OPTIONS.bodyClass)}var f=!1;for(d=0;d<c.length;d+=1)if("true"===c[d].dataset.backdrop){f=!0;break}f||b._removeBackdrop(),b._afterClose()}var b=this;return b._beforeClose(),b.$options.hideClass?(oa.removeClass(b.$el,b.$options.showClass),oa.addClass(b.$el,b.$options.hideClass),setTimeout(function(){a()},b.$options.delayToRemove)):a(),this},setWidth:function(a){var b=this;return b.$el.style.cssText+="width:"+b._calculateWidth(a)+"px;",b},refreshWidth:function(){this.setWidth(this.$el.style.width)},refreshHeight:function(){this.setHeight(this.$el.style.height)},setHeight:function(a){var b=this;return b.$el.style.cssText+="height:"+b._calculateHeight(a)+"px",b.$el.querySelector(".lobibox-body").style.cssText+="height:"+(b.$options.height-41)+"px",b},setSize:function(a,b){var c=this;return c.setWidth(a),c.setHeight(b),c},setPosition:function(a,b){var c;return"number"==typeof a&&"number"==typeof b?c="left:"+a+"px;top:"+b+"px;":"string"==typeof a?c=this._calculatePosition(a):"object"===d(a)&&(c="left:"+a.left+"px;top:"+a.top+"px;right:"+a.right+"px;bottom:"+a.bottom+"px;"),this.$el.style.cssText+=c,this},setTitle:function(a){return this.$el.querySelector(".lobibox-title").innerHTML=a},getTitle:function(){return this.$el.querySelector(".lobibox-title").innerHTML},show:function(){var a=this,b=g.viewport;if(a._beforeShow(),a.$el.classList.remove("lobibox-hidden"),b.appendChild(a.$el),a.$options.buttons){var c=a.$el.querySelector(".lobibox-footer").children;c[0].focus()}return(a.$options.modal||a.$options.backdrop)&&(b.classList.add(g.base.OPTIONS.bodyClass),a._addBackdrop()),a.$options.delay!==!1&&setTimeout(function(){a.destroy()},a.$options.delay),a._afterShow(),a}};g.base={},g.base.OPTIONS={bodyClass:"lobibox-open",modalClasses:{error:"lobibox-error",success:"lobibox-success",info:"lobibox-info",warning:"lobibox-warning",confirm:"lobibox-confirm",progress:"lobibox-progress",prompt:"lobibox-prompt","default":"lobibox-default",window:"lobibox-window"},buttonsAlign:["left","center","right"],buttons:{ok:{"class":"lobibox-btn lobibox-btn-default",text:"OK",closeOnClick:!0},cancel:{"class":"lobibox-btn lobibox-btn-cancel",text:"Cancel",closeOnClick:!0},yes:{"class":"lobibox-btn lobibox-btn-yes",text:"确定",closeOnClick:!0},no:{"class":"lobibox-btn lobibox-btn-no",text:"取消",closeOnClick:!0}},icons:{bootstrap:{confirm:"glyphicon glyphicon-question-sign",success:"glyphicon glyphicon-ok-sign",error:"glyphicon glyphicon-remove-sign",warning:"glyphicon glyphicon-exclamation-sign",info:"glyphicon glyphicon-info-sign"},fontAwesome:{confirm:"fa fa-question-circle",success:"fa fa-check-circle",error:"fa fa-times-circle",warning:"fa fa-exclamation-circle",info:"fa fa-info-circle"}}},g.base.DEFAULTS={horizontalOffset:5,verticalOffset:5,width:600,height:"auto",closeButton:!0,draggable:!0,customBtnClass:"lobibox-btn lobibox-btn-default",modal:!1,debug:!1,buttonsAlign:"center",closeOnEsc:!0,delayToRemove:200,delay:!1,baseClass:"animated-super-fast",showClass:"zoomIn",hideClass:"zoomOut",iconSource:"bootstrap",onShow:null,shown:null,beforeClose:null,closed:null},a.prototype=X.extend(!0,{},h,{constructor:a,_processInput:function(b){var c=this,d=h._processInput.call(c,b);return d.buttons={ok:g.base.OPTIONS.buttons.ok,cancel:g.base.OPTIONS.buttons.cancel},b=X.extend(!0,{},d,a.DEFAULT_OPTIONS,b)},_init:function(){var a=this;h._init.call(a),a._setContent(a.$options.content),a.show()},_afterShow:function(){var a=this;a._setContent(a._createInput())._position(),a.$input&&a.$input.focus();var b=(window.innerHeight-oa.outerHeight(a.$el))/2,c=(window.innerWidth-oa.outerWidth(a.$el))/2;a.setPosition(c,b),h._afterShow.call(a)},_createInput:function(){var a,b=this;if(b.$options.multiline)b.$input=document.createElement("textarea"),b.$input.setAttribute("rows",b.$options.lines);else{if(!b.$promptType)return;b.$input=document.createElement("input"),b.$input.setAttribute("type","' + me.$promptType + '")}if(b.$input.classList.add("lobibox-input"),"[object Object]"===Object.prototype.toString.call(b.$options.attrs))for(var c in b.$options.attrs)b.$input.setAttribute(c,b.$options.attrs[c]);b.$options.value&&b.setValue(b.$options.value),b.$options.label&&(a=document.createElement("label"),a.innerHTML=b.$options.label);var d=document.createElement("div");return b.$options.label&&d.appendChild(a),d.appendChild(b.$input),d},setValue:function(a){return this.$input.value=a,this},getValue:function(){return this.$input.value},isValid:function(){var a=this,b=a.$el.querySelectorAll(".lobibox-input-error-message");if(a.$options.required&&!a.getValue()){if(a.$input.classList.add("invalid"),0===b.length){var c=document.createElement("p");c.className="lobibox-input-error-message",c.innerHTML=a.$options.errorMessage,a.$el.querySelector(".lobibox-body").appendChild(c),a._position(),a.$input.focus()}return!1}a.$input.classList.remove("invalid");for(var d=0;d<b.length;d+=1)b[d].remove();return a._position(),a.$input.focus(),a._removeBackdrop(),!0},_beforePromptShow:function(){var a=this;a._triggerEvent("beforeWindowShow")},_beforePromptHide:function(){var a=this;a._triggerEvent("beforeWindowHide")},_afterPromptShow:function(){var a=this;a._triggerEvent("afterWindowShow")},_afterPromptHide:function(){var a=this;a._triggerEvent("afterWindowHide")},promptHide:function(){var a=this;return a._beforePromptHide(),a.$el.classList.add("hide"),a._afterPromptHide(),this},promptShow:function(){var a=this;return a._beforePromptShow(),a.$el.classList.remove("hide"),a._afterPromptShow(),a.$el.style.zIndex=(new Date).getTime()-g.window.startTime,this}}),a.DEFAULT_OPTIONS={width:400,attrs:{},value:"",multiline:!1,lines:3,type:"text",label:"",required:!0,errorMessage:"The field is required"},b.prototype=X.extend(!0,{},h,{constructor:b,_processInput:function(a){var b=this,c=h._processInput.call(b,a);return c.buttons={yes:g.base.OPTIONS.buttons.yes,no:g.base.OPTIONS.buttons.no},a=X.extend(!0,{},c,g.confirm.DEFAULTS,a)},_init:function(){var a=this;h._init.call(a),a.show()},_afterShow:function(){var a=this,b=document.createElement("div");if(a.$options.iconClass){var c=document.createElement("div");c.className="lobibox-icon-wrapper",b.appendChild(c);var d=document.createElement("i");d.className="lobibox-icon"+a.$options.iconClass,b.appendChild(d)}var e=document.createElement("div");e.className="lobibox-body-text-wrapper",b.appendChild(e);var f=document.createElement("span");f.className="lobibox-body-text",f.innerHTML=a.$options.msg,e.appendChild(f),a._setContent(b.innerHTML),a._position(),h._afterShow.call(a)},_beforeConfirmShow:function(){var a=this;a._triggerEvent("beforeWindowShow")},_beforeConfirmHide:function(){var a=this;a._triggerEvent("beforeWindowHide")},_afterConfirmShow:function(){var a=this;a._triggerEvent("afterWindowShow")},_afterConfirmHide:function(){var a=this;a._triggerEvent("afterWindowHide")},confirmHide:function(){var a=this;return a._beforeConfirmHide(),a.$el.classList.add("hide"),a._afterConfirmHide(),this},confirmShow:function(){var a=this;return a._beforeConfirmShow(),a.$el.classList.remove("hide"),a._afterConfirmShow(),a.$el.style.zIndex=(new Date).getTime()-g.window.startTime,this}}),g.confirm.DEFAULTS={title:"Question",width:500},c.prototype=X.extend(!0,{},h,{constructor:c,_processInput:function(a){var b=this,c=h._processInput.call(b,a);return c.buttons={},a=X.extend(!0,{},c,g.alert.OPTIONS[b.$type],g.alert.DEFAULTS,a)},_init:function(){var a=this;h._init.call(a),a.show()},_afterShow:function(){var a=this,b=document.createElement("div");if(a.$options.iconClass){var c=document.createElement("div");c.className="lobibox-icon-wrapper",b.appendChild(c);var d=document.createElement("i");d.className="lobibox-icon"+a.$options.iconClass,b.appendChild(d)}var e=document.createElement("div");e.className="lobibox-body-text-wrapper",b.appendChild(e);var f=document.createElement("span");f.className="lobibox-body-text",f.innerHTML=a.$options.msg,e.appendChild(f),a._setContent(b.innerHTML),a._setSize();var g=(window.innerHeight-oa.outerHeight(a.$el))/2,i=(window.innerWidth-oa.outerWidth(a.$el))/2;a.setPosition(i,g),h._afterShow.call(a)}}),g.alert.OPTIONS={warning:{title:"Warning"},info:{title:"Information"},success:{title:"Success"},error:{title:"Error"}},g.alert.DEFAULTS={},e.prototype=X.extend(!0,{},h,{constructor:e,_processInput:function(a){var b=this,c=h._processInput.call(b,a);return a=X.extend(!0,{},c,g.progress.DEFAULTS,a)},_init:function(){var a=this;h._init.call(a),a.show()},_afterShow:function(){var a=this;a.$options.progressTpl?a.$progressBarElement=a.$options.progressTpl:a.$progressBarElement=a._createProgressbar();var b;a.$options.label&&(b=document.createElement("label"),b.innerHTML=a.$options.label);var c=document.createElement("div").appendChild(b);c.appendChild(a.$progressBarElement),a._setContent(c),a._position(),h._afterShow.call(a)},_createProgressbar:function(){var a=this,b=document.createElement("div");b.classList.add("lobibox-progress-bar-wrapper"),b.classList.add("lobibox-progress-outer");var c=document.createElement("div");if(c.classList.add("lobibox-progress-bar"),c.classList.add("lobibox-progress-element"),b.appendChild(c),a.$options.showProgressLabel){var d=document.createElement("span");d.className="lobibox-progress-text",d.dataset.role="progress-text",b.appendChild(d)}return b},setProgress:function(a){var b=this;if(100!==b.$progress)return a=Math.min(100,Math.max(0,a)),b.$progress=a,b._triggerEvent("progressUpdated"),100===b.$progress&&b._triggerEvent("progressCompleted"),b.$el.querySelector(".lobibox-progress-element").style.cssText+="width"+a.toFixed(1)+"%",b.$el.querySelector(".lobibox-progress-text").innerHTML=a.toFixed(1)+"%",b},getProgress:function(){return this.$progress}}),g.progress.DEFAULTS={width:500,showProgressLabel:!0,label:"",progressTpl:!1,progressUpdated:null,progressCompleted:null},f.prototype=X.extend(!0,{},h,{constructor:f,_processInput:function(a){var b=this,c=h._processInput.call(b,a);return a.content&&"function"==typeof a.content&&(a.content=a.content()),a=X.extend(!0,{},c,g.window.DEFAULTS,a)},_init:function(){var a=this;h._init.call(a),a.setContent(a.$options.content),a.$options.url&&a.$options.autoload?(a.$options.showAfterLoad||a.show(),a.load(function(){a.$options.showAfterLoad&&a.show()})):a.show()},_afterShow:function(){var a=this;a._position(),h._afterShow.call(a)},_addCloseButton:function(){var a=this,b=document.createElement("span");b.className="btn-close",b.innerHTML="&times;",a.$el.querySelector(".lobibox-header").appendChild(b),b.addEventListener("mousedown",function(a){a.stopPropagation()}),b.addEventListener("click",function(){a.windowHide()})},_beforeWindowShow:function(){var a=this;a._triggerEvent("beforeWindowShow")},_beforeWindowHide:function(){var a=this;a._triggerEvent("beforeWindowHide")},_afterWindowShow:function(){var a=this;a._triggerEvent("afterWindowShow")},_afterWindowHide:function(){var a=this;a._triggerEvent("afterWindowHide")},windowHide:function(){var a=this;return a._beforeWindowHide(),a.$el.classList.add("hide"),a._afterWindowHide(),this},windowShow:function(){var a=this;return a._beforeWindowShow(),a.$el.classList.remove("hide"),a._afterWindowShow(),a.$el.style.zIndex=(new Date).getTime()-g.window.startTime,this},setParams:function(a){var b=this;return b.$options.params=a,b},getParams:function(){var a=this;return a.$options.params},setLoadMethod:function(a){var b=this;return b.$options.loadMethod=a,b},getLoadMethod:function(){var a=this;return a.$options.loadMethod},setContent:function(a){var b=this;return b.$options.content=a,b.$el.querySelector(".lobibox-body").innerHTML="",oa.append(b.$el.querySelector(".lobibox-body"),a),b},getContent:function(){var a=this;return a.$options.content},setUrl:function(a){return this.$options.url=a,this},getUrl:function(){return this.$options.url},load:function(a){var b=this;return b.$options.url?($.ajax(b.$options.url,{method:b.$options.loadMethod,data:b.$options.params}).done(function(c){b.setContent(c),a&&"function"==typeof a&&a(c)}),b):b}}),g.window.DEFAULTS={width:480,height:600,content:"",url:"",draggable:!0,autoload:!0,loadMethod:"GET",showAfterLoad:!0,params:{}},g.window.startTime=(new Date).getTime();var i=function(a,b){this.$type=null,this.$options=null,this.$el=null;var c=this,d=function(a){return"mini"!==a.size&&"large"!==a.size||(a=X.extend(!0,{},g.notify.OPTIONS[a.size],a)),a=X.extend(!0,{},g.notify.OPTIONS[c.$type],g.notify.DEFAULTS,a),"mini"!==a.size&&a.title===!0?a.title=g.notify.OPTIONS[c.$type].title:"mini"===a.size&&a.title===!0&&(a.title=!1),a.icon===!0&&(a.icon=g.notify.OPTIONS.icons[a.iconSource][c.$type]),a.sound===!0&&(a.sound=g.notify.OPTIONS[c.$type].sound),a.sound&&(a.sound=a.soundPath+a.sound+a.soundExt),a},e=function(a,b){if("normal"===c.$options.size)b.classList.contains("bottom")?b.insertBefore(a,b.firstChild):b.appendChild(a);else if("mini"===c.$options.size)b.classList.contains("bottom")?b.insertBefore(a,b.firstChild):b.appendChild(a);else if("large"===c.$options.size){
var d=i().appendChild(a),e=h(d.getAttribute("id"));b.querySelector(".lb-notify-wrapper").appendChild(d),b.querySelector(".lb-notify-tabs").appendChild(e),f(e);for(var g=e.querySelectorAll("a"),j=0;j<g.length;j+=1)g[j].click(function(){f(e)})}},f=function(a){for(var b=oa.closest(a,".lb-notify-tabs"),c=b.childNodes,d=0;d<c.length;d+=1)"li"==c[d].nodeType&&c[d].classList.remove("active");a.classList.add("active");for(var e=a.querySelector("a").getAttribute("href"),f=oa.closest(e,".lb-notify-wrapper").querySelectorAll(".lb-tab-pane"),d=0;d<f.length;d+=1)f[d].classList.remove("active");e.addClass("active")},h=function(a){var b=document.createElement("li");b.className=g.notify.OPTIONS[c.$type]["class"];var d=document.createElement("a");d.setAttribute("href","#"+a),b.appendChild(d);var e=document.createElement("i");return e.className="tab-control-icon"+c.$options.icon,d.appendChild(e),b},i=function(){var a=document.createElement("div");return a.className="lb-tab-pane",a.id=Math.randomString(10),a},j=function(){var a,b=("large"===c.$options.size?".lobibox-notify-wrapper-large":".lobibox-notify-wrapper")+"."+c.$options.position.replace(/\s/gi,".");if(a=document.querySelectorAll(b),0!==a.length)return a[0];a=document.createElement("div");for(var d=b.split("."),e=1;e<d.length;e+=1)a.classList.add(d[e]);if(g.viewport.appendChild(a),"large"===c.$options.size){var f=document.createElement("ul");f.className="lb-notify-tabs";var h=document.createElement("div");h.className="lb-notify-wrapper",a.appendChild(f),a.appendChild(h)}return a},k=function(){var a,b,d,e,f,h=g.notify.OPTIONS,i=document.createElement("div");if(i.classList.add("lobibox-notify"),i.classList.add(h[c.$type]["class"]),i.classList.add(h["class"]),i.classList.add(c.$options.showClass),d=document.createElement("div"),d.className="lobibox-notify-icon-wrapper",i.appendChild(d),a=document.createElement("div"),a.className="lobibox-notify-icon",d.appendChild(a),b=document.createElement("div"),a.appendChild(b),c.$options.img){var j=document.createElement("img");j.src=c.$options.img,b.appendChild(j)}else if(c.$options.icon){var k=document.createElement("div");k.className="icon-el";var o=document.createElement("i");o.className=c.$options.icon,k.appendChild(o),b.appendChild(k)}else i.classList.add("without-icon");if(f=document.createElement("div"),f.className="lobibox-notify-msg",f.innerHTML=c.$options.msg,c.$options.messageHeight!==!1&&(f.style.cssText+="max-height:"+c.$options.messageHeight+"px;"),e=document.createElement("div"),e.className="lobibox-notify-body",e.appendChild(f),i.appendChild(e),c.$options.title){var q=document.createElement("div");q.className="lobibox-notify-title",q.innerHTML=c.$options.title,e.insertBefore(q,f)}return l(i),"normal"!==c.$options.size&&"mini"!==c.$options.size||(m(i),n(i)),c.$options.width&&(i.style.cssText+="width:"+p(c.$options.width)+"px"),i},l=function(a){if(c.$options.closable){var b=document.createElement("span");b.className="lobibox-close",b.innerHTML="&times;",a.appendChild(b),b.addEventListener("click",function(){c.remove()})}},m=function(a){c.$options.closeOnClick&&a.click(function(){c.remove()})},n=function(a){if(c.$options.delay){if(c.$options.delayIndicator){var b=document.createElement("div");b.className="lobibox-delay-indicator";var d=document.createElement("div");b.appendChild(d),a.appendChild(b)}var e=0,f=1e3/30,g=(new Date).getTime(),h=setInterval(function(){c.$options.continueDelayOnInactiveTab?e=(new Date).getTime()-g:e+=f;var a=100*e/c.$options.delay;if(a>=100&&(a=100,c.remove(),h=clearInterval(h)),c.$options.delayIndicator)for(var d=b.querySelectorAll("div"),i=0;i<d.length;i+=1)d[i].style.cssText+="width:"+a+"%"},f);c.$options.pauseDelayOnHover&&(a.addEventListener("mouseenter.lobibox",function(){f=0}),a.addEventListener("mouseleave.lobibox",function(){f=1e3/30}))}},o=function(a){var b=a.prev();return 0===b.length&&(b=a.next()),0===b.length?null:b},p=function(a){return a=Math.min(window.outerWidth,a)};this.remove=function(){c.$el.classList.remove(c.$options.showClass),c.$el.classList.add(c.$options.hideClass);var a=c.$el.parentNode,b=oa.closest(a,".lobibox-notify-wrapper-large")||oa.closest(a,".lobibox-notify-wrapper");if(a){for(var d="#"+a.getAttribute("id"),e=b.querySelectorAll(".lb-notify-tabs li"),h=0;h<e.length;h+=1)e[h].querySelector("a").getAttribute("href")!==d&&e.splice(1,h);if(e.length>0)for(var h=0;h<e.length;h+=1)e[h].classList.remove(g.notify.OPTIONS["class"]),e[h].classList.add(c.$options.hideClass);return setTimeout(function(){if("normal"===c.$options.size||"mini"===c.$options.size)c.$el.parentElement.removeChild(c.$el);else if("large"===c.$options.size){var b=o(e);b&&f(b),e.parentElement.removeChild(e),a.parentElement.removeChild(a)}var d=g.notify.list,h=d.indexOf(c);d.splice(h,1);var i=d[h];i&&i.$options.showAfterPrevious&&i._init()},500),c}},c._init=function(){var a=k();if("mini"===c.$options.size&&a.classList.add("notify-mini"),"string"==typeof c.$options.position){var b=j();e(a,b),b.classList.contains("center")&&(b.style.cssText+="margin-left:"+-(b.offsetWidth/2)+"px")}else g.viewport.appendChild(a),a.style.cssText+="position:fixed;left:"+c.$options.position.left+"px;top:"+c.$options.position.top+"px;";if(c.$el=a,c.$options.sound){var d=new Audio(c.$options.sound);d.play()}c.$options.rounded&&c.$el.classList.add("rounded"),c.$el.addEventListener("click",function(a){c.$options.onClickUrl&&(window.location.href=c.$options.onClickUrl),c.$options.onClick&&"function"==typeof c.$options.onClick&&c.$options.onClick.call(c,a)}),c.$el.dataset.lobibox=c},this.$type=a,this.$options=d(b),c.$options.showAfterPrevious&&0!==g.notify.list.length||this._init()};g.notify=function(a,b){if(["default","info","warning","error","success"].indexOf(a)>-1){var c=new i(a,b);return g.notify.list.push(c),c}},g.notify.list=[],g.notify.closeAll=function(){var a=g.notify.list;for(var b in a){var c=a[b].parentNode;c.removeChild(a[b])}},g.notify.DEFAULTS={title:!0,size:"normal",soundPath:"sounds/",soundExt:".ogg",showClass:"fadeInDown",hideClass:"zoomOut",icon:!0,msg:"",img:null,closable:!0,hideCloseButton:!1,delay:5e3,delayIndicator:!0,closeOnClick:!0,width:400,sound:!0,position:"bottom right",iconSource:"bootstrap",rounded:!1,messageHeight:60,pauseDelayOnHover:!0,onClickUrl:null,showAfterPrevious:!1,continueDelayOnInactiveTab:!0,onClick:null},g.notify.OPTIONS={"class":"animated-fast",large:{width:500,messageHeight:96},mini:{"class":"notify-mini",messageHeight:32},"default":{"class":"lobibox-notify-default",title:"Default",sound:!1},success:{"class":"lobibox-notify-success",title:"Success",sound:"sound2"},error:{"class":"lobibox-notify-error",title:"Error",sound:"sound4"},warning:{"class":"lobibox-notify-warning",title:"Warning",sound:"sound5"},info:{"class":"lobibox-notify-info",title:"Information",sound:"sound6"},icons:{bootstrap:{success:"glyphicon glyphicon-ok-sign",error:"glyphicon glyphicon-remove-sign",warning:"glyphicon glyphicon-exclamation-sign",info:"glyphicon glyphicon-info-sign"},fontAwesome:{success:"fa fa-check-circle",error:"fa fa-times-circle",warning:"fa fa-exclamation-circle",info:"fa fa-info-circle"}}}},ya=new xa,za=function(){var a="Success",b="",c="",d=!1,e=0,f=null;return function(g,h,i){return 5===g?document.querySelector(".loading").classList.add("hide"):a=g,"error"===g&&(d=!1),void 0!==h&&(b=h,void 0!==i&&(d=i)),(new Date).getTime()-e<5e3?b!==c&&(f=ya.notify(a,{size:"mini",rounded:!0,position:"center top",sound:!1,delay:d,msg:b}),e=(new Date).getTime(),f.$el.childNodes[1].childNodes[0].title=b):(f=ya.notify(a,{size:"mini",rounded:!0,position:"center top",sound:!1,delay:d,msg:b}),e=(new Date).getTime(),f.$el.childNodes[1].childNodes[0].title=b),c=b,f}}(),Aa={};Aa.getAndroidVersion=function(a){a=a||navigator.userAgent;var b=a.match(/Android\s([0-9.]*)/);return!!b&&b[1]},Aa.isTouchDevice=function(){return"undefined"!=typeof window&&"ontouchstart"in window},Aa.isBrowser=function(){return"undefined"!=typeof navigator},Aa.isIE11=function(){return Aa.isBrowser()&&Boolean(navigator.userAgent.match(/Edge|Trident\/7\./))},Aa.isIOSDevice=function(){return!!Aa.isBrowser()&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())},Aa.isAndroidDevice=function(){return!!Aa.isBrowser()&&navigator.userAgent.toLowerCase().indexOf("android")!==-1},Aa.isMobileDevice=function(){return!!Aa.isBrowser()&&(Aa.isIOSDevice()||Aa.isAndroidDevice())},Aa.isSafari=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("safari")!==-1&&a.indexOf("chrome")===-1},Aa.isFirefox=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("firefox")!==-1},Aa.isChrome=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("chrome")!==-1},Aa.isMac=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("mac os")!==-1},Aa.isLinux=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("linux x86_64")!==-1},Aa.isWindows=function(){if(!Aa.isBrowser())return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("win32")!==-1||a.indexOf("windows")!==-1},Aa.isWindowsPhone=function(){var a=navigator.userAgent.toLowerCase();return/(?:Windows Phone)/.test(a)},Aa.isSymbian=function(){var a=navigator.userAgent.toLowerCase();return/(?:SymbianOS)/.test(a)||Aa.isWindowsPhone()},Aa.isTablet=function(){var a=navigator.userAgent.toLowerCase();return/(?:iPad|PlayBook)/.test(a)||Aa.isAndroidDevice()&&!/(?:Mobile)/.test(a)||Aa.isFirefox()&&/(?:Tablet)/.test(a)},Aa.isPc=function(){return!Aa.isMobileDevice()&&!Aa.isTablet()&&!Aa.isSymbian()},Aa.isOpera=function(){var a=navigator.userAgent;return a.indexOf("Opera")>-1},Aa.language=function(){return(navigator.browserLanguage||navigator.language).toLowerCase()},Aa.isSupportIndexedDB=function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},Aa.isSupportWorker=function(){return window.Worker};var Ba=function(a){function b(a){var c;return e(this,b),c=l(this,i(b).call(this,a)),c.mobileMode=Aa.isMobileDevice(),c.mobileMode&&(c.mobileTool=new la({viewer2D:a.viewer2D})),c}return h(b,a),g(b,[{key:"changeMode",value:function(a){n(i(b.prototype),"changeMode",this).call(this,a),a===n(i(b.prototype),"valueOf",this).call(this).name&&n(i(b.prototype),"valueOf",this).call(this).enable?this.mobileMode?this.mobileTool.show(!0):za("info","按住'Ctrl'键,框选模式为增选;按住'Alt'键,框选模式为减选",5e3):this.mobileMode&&this.mobileTool.show(!1)}}]),b}(ka),Ca=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.container=document,this.modal={},this.onOk=b.onOk,this.onCancel=b.onCancel,this.size=0,this._init()}return g(a,[{key:"_init",value:function(){var a=this,b='\n            <form>\n              <div class="viewer2D-item">\n                <label>定义尺寸</label>\n                <input type="text" name="size" />\n              </div>\n              <div class="viewer2D-item">\n                <label>单位类型</label>\n                <select name="unit">\n                  <option selected value="m">米</option>\n                  <option value="cm">厘米</option>\n                  <option value="mm">毫米</option>\n                </select>\n              </div>\n              <div class="viewer2D-item viewer2D-button-group">\n                <button id="__viewer2D-cancelMeasureAdjust">清除</button>\n                <button type="submit">确定</button>\n              </div>\n            </form>\n        ';b=b.replace(/\s{2,}/g,"");var c=(new DOMParser).parseFromString(b,"text/html");this.container=c.body.firstElementChild.cloneNode(!0),this.modal=new ia({children:this.container,title:"测量校准",className:"viewer2D-measure-dialog",expandMode:!1,parent:this.viewer2D.getViewerImpl().domElement,onClose:this.onCancel}),this.container.onsubmit=function(b){a.onSubmit(b)},this.container.querySelector("input[name=size]").addEventListener("input",function(b){a.onInput(b)}),this.container.querySelector("#__viewer2D-cancelMeasureAdjust").addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),a.onCancel(),a.modal.switchModalShow(!1)})}},{key:"showModal",value:function(a){this.modal.switchModalShow(a)}},{key:"onInput",value:function(a){a.stopPropagation(),a.preventDefault();var b=a.target.value;/[^\d.]/.test(b)?a.target.value=this.size:this.size=parseFloat(b||0)}},{key:"onSubmit",value:function(a){a.preventDefault(),a.stopPropagation();var b=new FormData(a.target);this.onOk({size:parseFloat(b.get("size")||0),unit:b.get("unit")}),this.showModal(!1)}}]),a}(),Da=function(){function a(b,c){e(this,a),this.props=c,this._rootDiv=void 0,this._confirmDiv=void 0,this._moveDiv=void 0,this._cancelDiv=void 0,this._init(b),this._onTouchMove=this._onTouchMove.bind(this)}return g(a,[{key:"_init",value:function(a){var b=this,c='\n        <div class="viewer2d-measure-control-container">\n            <div class="viewer2d-measure-control-control">\n              <div class="viewer2d-measure-control-confirm"></div>\n              <div class="viewer2d-measure-control-move"></div>\n              <div class="viewer2d-measure-control-cancel"></div>\n            </div>\n            <div class="viewer2d-measure-control-target"></div>\n      </div>\n        ';c=c.replace(/\s{2,}/g,"");var d=(new DOMParser).parseFromString(c,"text/html"),e=d.body.firstElementChild.cloneNode(!0);this._rootDiv=e,this._confirmDiv=e.getElementsByClassName("viewer2d-measure-control-confirm")[0],this._moveDiv=e.getElementsByClassName("viewer2d-measure-control-move")[0],this._cancelDiv=e.getElementsByClassName("viewer2d-measure-control-cancel")[0],this._targetDiv=e.getElementsByClassName("viewer2d-measure-control-target")[0],this._confirmDiv.onclick=function(a){a.preventDefault(),a.stopPropagation(),b._confirm(a)},this._moveDiv.ontouchstart=function(a){a.preventDefault(),a.stopPropagation(),b._onTouchStart(a)},this._moveDiv.ontouchend=function(a){a.preventDefault(),a.stopPropagation(),b._onTouchEnd(a)},this._cancelDiv.onclick=function(a){a.preventDefault(),a.stopPropagation(),b._cancel()},e.style.display="none",a.appendChild(e)}},{key:"_onTouchStart",value:function(a){if(!(a.touches.length>1)){document.addEventListener("touchmove",this._onTouchMove,{passive:!1});var b=this._rootDiv,c=b.getBoundingClientRect(),d=a.touches[0];this._touchInfo={offsetX:d.clientX-c.left,offsetY:d.clientY-c.top,identifier:d.identifier}}}},{key:"_onTouchMove",value:function(a){a.preventDefault(),a.stopPropagation();var b=a.changedTouches[0];if(b){var c=b.identifier;if(this._touchInfo&&this._touchInfo.identifier===c){var d=this._rootDiv,e=d.parentNode,f=b.clientX-this._touchInfo.offsetX,g=b.clientY-this._touchInfo.offsetY;f>0&&f<e.clientWidth-d.clientWidth&&(d.style.left="".concat(f,"px")),g>0&&g<e.clientHeight-d.clientHeight&&(d.style.top="".concat(g,"px"));var h=this._targetDiv.getBoundingClientRect(),i=h.left+(h.right-h.left)/2,j=h.top+(h.bottom-h.top)/2;this.props.onTouchMove(i,j)}}}},{key:"_onTouchEnd",value:function(){document.removeEventListener("touchmove",this._onTouchMove)}},{key:"_confirm",value:function(a){var b=this._targetDiv,c=b.getBoundingClientRect(),d=c.left+(c.right-c.left)/2,e=c.top+(c.bottom-c.top)/2;this.props.onOk(d,e)}},{key:"_cancel",value:function(){this.props.onCancel()}},{key:"_layout",value:function(){var a=this._rootDiv,b=a.parentNode;b&&(a.style.left="".concat((b.clientWidth-a.clientWidth)/2,"px"),a.style.top="".concat((b.clientHeight-a.clientHeight)/2,"px"))}},{key:"show",value:function(){this._rootDiv&&(this._rootDiv.style.display="block",this._layout())}},{key:"hide",value:function(){this._rootDiv&&(this._rootDiv.style.display="none")}}]),a}(),Ea=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.container=document,this.modal={},this.onOk=b.onOk,this.onCancel=b.onCancel,this.size=0,this._init()}return g(a,[{key:"_init",value:function(){var a=this,b='\n            <form>\n              <div class="viewer2D-item">\n                <label>单位</label>\n                <select name="unit">\n                  <option selected value="m">米</option>\n                  <option value="cm">厘米</option>\n                  <option value="mm">毫米</option>\n                </select>\n              </div>\n              <div class="viewer2D-item">\n                <label>精度</label>\n                <select name="precision">\n                  <option value="1">0.1</option>\n                  <option value="2">0.01</option>\n                  <option selected value="3">0.001</option>\n                  <option value="4">0.0001</option>\n                  <option value="5">0.00001</option>\n                </select>\n              </div>\n              <div class="viewer2D-item viewer2D-button-group">\n                <button id="__viewer2D-cancelMeasureSetting">取消</button>\n                <button type="submit">确定</button>\n              </div>\n            </form>\n        ';b=b.replace(/\s{2,}/g,"");var c=(new DOMParser).parseFromString(b,"text/html");this.container=c.body.firstElementChild.cloneNode(!0),this.modal=new ia({children:this.container,title:"测量设置",className:"viewer2D-measure-dialog",expandMode:!1,parent:this.viewer2D.getViewerImpl().domElement,onClose:this.onCancel}),this.container.onsubmit=function(b){a.onSubmit(b)},this.container.querySelector("#__viewer2D-cancelMeasureSetting").addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),a.onCancel(),a.showModal(!1)})}},{key:"showModal",value:function(a){this.modal.switchModalShow(a)}},{key:"onSubmit",value:function(a){a.preventDefault(),a.stopPropagation();var b=new FormData(a.target);this.onOk({precision:Number(b.get("precision")),unit:b.get("unit")}),this.showModal(!1)}}]),a}(),Fa=function(a){function b(a){var c;return e(this,b),c=l(this,i(b).call(this,a)),c.viewer2D=a.viewer2D,c.mode="Distance",c.measure=void 0,c.adjustModal=new Ca({viewer2D:a.viewer2D,onOk:function(a){c.adjustMeasurement(a)},onCancel:function(){c.measure&&c.measure.cancelCurrentAdjust()}}),c.settingModal=new Ea({viewer2D:a.viewer2D,onOk:function(a){c.setMeasurement(a)},onCancel:function(){}}),c}return h(b,a),g(b,[{key:"_init",value:function(){var a=this;n(i(b.prototype),"_init",this).call(this);var c='\n            <div id="__viewer2D-measurement" class="viewer2D-measure-option">\n              <div class="viewer2D-icon measure-distance enable" title="长度测量" data-mode="Distance"></div>\n              <div class="viewer2D-icon measure-area" title="面积测量" data-mode="Area"></div>\n              <div class="viewer2D-icon measure-angle" title="角度测量" data-mode="Angle"></div>\n              <div class="viewer2D-icon measure-adjust" title="测量校准" data-mode="Adjust"></div>\n              <div class="viewer2D-icon measure-setting" title="测量设置" data-mode="Setting"></div>\n              <div class="viewer2D-icon measure-delete" title="删除测量" data-mode="Delete"></div>\n            </div>\n        ';c=c.replace(/\s{2,}/g,"");var d=(new DOMParser).parseFromString(c,"text/html");this.container=d.body.firstElementChild.cloneNode(!0),this.viewer2D.getViewerImpl().domElement.appendChild(this.container),this.container.addEventListener("click",function(b){b.stopPropagation(),a.changeMeasureMode(b.target.getAttribute("data-mode"))}),Aa.isMobileDevice()&&(this.measureControl=new Da(this.viewer2D.getViewerImpl().domElement,{onOk:function(b,c){var d=a.viewer2D.getViewerImpl().controlManager.getToolByName("pickByMeasure");d&&d.touchPointEnd({clientX:b,clientY:c})},onTouchMove:function(b,c){var d=a.viewer2D.getViewerImpl().controlManager.getToolByName("pickByMeasure");d&&d.touchPointMove({clientX:b,clientY:c})},onCancel:function(b,c){a.measure&&a.measure.cancelCurrentMeasure()}}))}},{key:"showOption",value:function(a){a?(this.container.style.display="block",this.measureControl&&this.measureControl.show()):(this.container.style.removeProperty("display"),this.measureControl&&this.measureControl.hide())}},{key:"changeMode",value:function(a){n(i(b.prototype),"changeMode",this).call(this,a),a===n(i(b.prototype),"valueOf",this).call(this).name&&n(i(b.prototype),"valueOf",this).call(this).enable?(this.showOption(!0),this.measure=this.viewer2D.getViewerImpl().measure,this.measure&&(this.changeMeasureMode("Distance"),this.measure.didEndMeasureCallback=this.didEndMeasureCallback.bind(this))):this.showOption(!1)}},{key:"changeMeasureMode",value:function(a){if(this.measure)switch(a){case"Delete":this.measure.removeSelectedMeasure();break;case"Setting":this.settingModal.showModal(!0);break;default:this.measure.setCurrentMode(a),this.container.querySelector("[data-mode=".concat(a,"]")).classList.add("enable"),this.container.querySelectorAll(":not([data-mode=".concat(a,"])")).forEach(function(a){a.classList.remove("enable")}),this.mode=a}}},{key:"didEndMeasureCallback",value:function(){"Adjust"===this.measure.getCurrentMode()&&this.adjustModal.showModal(!0)}},{key:"adjustMeasurement",value:function(a){this.measure.setAdjustForCurrentAdjustItem(a.unit,a.size)}},{key:"setMeasurement",value:function(a){this.measure&&(this.measure.setUnit(a.unit),this.measure.setPrecision(a.precision))}}]),b}(ka),Ga=function(){function a(){e(this,a),this.ui=document.createElement("div"),this.enable=!1,this._init()}return g(a,[{key:"_init",value:function(){var a=this;this.ui.className="viewer2D-icon show-layer",this.ui.setAttribute("title","显示/隐藏图层选择"),this.ui.setAttribute("data-name","showLayer"),this.ui.onclick=function(b){b.preventDefault(),b.stopPropagation(),a._changeMode()}}},{key:"_changeMode",value:function(){this.enable?(document.querySelector(".viewer2D-js-layer").style.display="",this.ui.classList.remove("enable")):(document.querySelector(".viewer2D-js-layer").style.display="block",this.ui.classList.add("enable")),this.enable=!this.enable}},{key:"changeMode",value:function(){}}]),a}(),Ha=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.modal={},this.ui=document.createElement("div"),this.showModal=!1,this._init()}return g(a,[{key:"_init",value:function(){var a=this;this.ui.className="viewer2D-icon setting",this.ui.setAttribute("title","设置"),this.ui.setAttribute("data-name","setting"),this.ui.onclick=function(b){b.preventDefault(),b.stopPropagation(),a.modal.switchModalShow(!a.showModal),a._changeMode(!a.showModal)};var b='\n            <div class="setting-container">\n              <span>显示效果：</span>\n              <select>\n                <option value="normal">普通模式</option>\n                <option value="whiteBased">白底模式</option>\n                <option value="blackWhite">黑白模式</option>\n              </select>\n            </div>\n        ';b=b.replace(/\s{2,}/g,"");var c=(new DOMParser).parseFromString(b,"text/html").body.firstElementChild.cloneNode(!0);c.querySelector("select").onchange=function(b){switch(b.stopPropagation(),b.preventDefault(),b.target.value){case"normal":a.viewer2D.closeBlackWhiteMode(),a.viewer2D.setBackGroundColor("#4a4a4a");break;case"whiteBased":a.viewer2D.closeBlackWhiteMode(),a.viewer2D.setBackGroundColor("#ffffff");break;case"blackWhite":a.viewer2D.openBlackWhiteMode()}},this.modal=new ia({title:"设置",className:"viewer2D-setting",expandMode:!1,parent:this.viewer2D.viewerImpl.domElement,children:c,onClose:function(){a._changeMode(!1)}})}},{key:"_changeMode",value:function(a){this.showModal=a,a?this.ui.classList.add("enable"):this.ui.classList.remove("enable")}},{key:"changeMode",value:function(){}}]),a}(),Ia=function(a){var b={type:"get",cache:!0,headers:{"Content-type":"application/x-www-form-urlencoded"},data:null,async:!0,success:null,error:null,beforeSend:null},c=Object.assign(b,a),d=null;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=function(){if(4===d.readyState||"4"===d.readyState){var a=d.status;a>=200&&a<300||0===a?c.success&&c.success(d.response||d.responseText,""===d.responseType||"document"===d.responseType&&d.responseXML):c.error&&c.error(a,d.response||d.responseText,""===d.responseType||"document"===d.responseType&&d.responseXML)}},d.open(c.type,c.url,c.async);for(var e in c.headers)d.setRequestHeader(e,c.headers[e]);c.responseType&&(d.responseType=c.responseType),c.beforeSend?c.beforeSend(d,function(){d.send(c.data)}):d.send(c.data)},Ja=function(a,b){return new Promise(function(c,d){Ia({url:a,method:"GET",success:function(a){var e=JSON.parse(a);"success"===e.code.toLowerCase()||"noCode"===b?c("noCode"===b?e:e.data):d("requestError，dataCode:"+e.code+", dataMessage:"+e.message)},failure:function(a){d(a)}})})},Ka=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.BOS2D=b.BOS2D,this.isShow=!1,this.ui=document.createElement("div"),this._init()}return g(a,[{key:"_init",value:function(){var a=this;this.ui.className="viewer2D-icon cpt-info",this.ui.setAttribute("title","特性"),this.ui.setAttribute("data-name","cptInfo"),this.ui.onclick=function(b){b.preventDefault(),b.stopPropagation(),a.switchModal(!a.isShow)};var b=document.createElement("div");b.className="table",this.tableDOM=b,this.modal=new ia({title:"特性",className:"viewer2D-cptInfo",expandMode:!1,parent:this.viewer2D.getViewerImpl().domElement,children:b,onClose:function(){a.switchModal(!1)}}),this.viewer2D.getViewerImpl().drawManager.addEventListener(this.BOS2D.EVENTS.ON_SELECTION_CHANGED,function(){a.isShow&&a.switchModalBody()})}},{key:"switchModal",value:function(a){a?(this.switchModalBody(),this.ui.classList.add("enable")):this.ui.classList.remove("enable"),this.modal.switchModalShow(a),this.isShow=a}},{key:"switchModalBody",value:function(){var a=this,b=this.viewer2D.getSelectedComponentPartKeys();if(this.tableDOM.innerHTML="",0===b.length)this.tableDOM.appendChild(w(this.genTipStr("未选择图元/图块"))),this.tableDOM.appendChild(w(this.genTipStr("请选择一个图元/图块以查看其特性")));else{var c=b[0],d=c.split("_"),e=d[0],f=this.viewer2D.getViewerImpl().drawManager.drawPackages[e],g=f.serverUrl,h=f.dbName,i="".concat(g,"/api/").concat(h),j=w(this.genTipStr("正在获取特性..."));this.tableDOM.appendChild(j),x(i,d[2]+"_"+d[1]+"_"+d[3]).then(function(b){var c=b.Property;if(c){a.tableDOM.innerHTML="";var d=w("<div>".concat(a.genTableStr(c),"</div>"));d.childNodes.forEach(function(b){a.tableDOM.appendChild(b.cloneNode(!0))}),a.tableDOM.querySelectorAll(".js-expand").forEach(function(b){b.addEventListener("click",function(b){return a.switchExpand(b.target)})})}else{a.tableDOM.innerHTML="";var e=w(a.genTipStr("未查询到图元/图块属性"));a.tableDOM.appendChild(e)}})["catch"](function(){a.tableDOM.innerHTML="";var b=w(a.genTipStr("获取特性失败"));a.tableDOM.appendChild(b)})}}},{key:"genTipStr",value:function(a){return'\n            <div style="text-align: center; margin: 5px 0;">'.concat(a,"</div>\n        ")}},{key:"genTableStr",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=[],f="".concat(0===c?0:22,"px");return Object.keys(a).forEach(function(g){"object"!==d(a[g])?e.push('\n                    <div class="item" style="margin-left: '.concat(f,'">\n                        <div title=').concat(g,">").concat(g,"</div>\n                        <div title=").concat(a[g].toString(),">").concat(a[g],"</div>\n                    </div>\n                ")):e.push('\n                    <div style="margin-left: '.concat(f,'">\n                        <div class="title collapse js-expand" role="tree">\n                            ').concat(g,"\n                        </div>\n                        <div>\n                            ").concat(b.genTableStr(a[g],c+1),"\n                        </div>\n                    </div>\n                "))}),e.join("")}},{key:"switchExpand",value:function(a){var b=getComputedStyle(a.nextElementSibling).display;"none"===b?(a.classList.add("collapse"),a.nextElementSibling.style.display="block"):(a.classList.remove("collapse"),a.nextElementSibling.style.display="none")}},{key:"changeMode",value:function(){}}]),a}(),La=function(){function a(b){e(this,a),this.viewer2D=b.viewer2D,this.linkage=b.linkage,this.toolList=[],this.toolList.push(new Ba({viewer2D:b.viewer2D,className:"pick-by-rect",title:"框选",name:b.bos2d.ToolMode.PICK_BY_RECT})),this.toolList.push(new ka({viewer2D:b.viewer2D,className:"zoom-by-rect",title:"框选放大",name:b.bos2d.ToolMode.ZOOM_BY_RECT})),this.toolList.push(new Fa({viewer2D:b.viewer2D,className:"pick-by-measure",title:"测量",name:b.bos2d.ToolMode.PICK_BY_MEASURE})),this.toolList.push(new Ga),this.toolList.push(new Ka({viewer2D:b.viewer2D,BOS2D:b.bos2d})),this.toolList.push(new Ha({viewer2D:b.viewer2D})),this.ui=document.createElement("div"),this._init()}return g(a,[{key:"_init",value:function(){var a=this;if(this.ui.classList.add("viewer2D-toolbar"),this.toolList.forEach(function(b){a.ui.appendChild(b.ui)}),this.ui.onclick=function(b){b.preventDefault(),b.stopPropagation();var c=b.target.getAttribute("data-name");a.toolList.forEach(function(a){a.changeMode(c)})},this.viewer2D.viewerImpl.domElement.appendChild(this.ui),this.linkage){var b=this.linkage.emitter,c=this.linkage.EVENTS;b.on(c.ON_SWITCH_MAIN3D,function(){a.ui.style.display="none"}),b.on(c.ON_SWITCH_BOTH,function(){a.ui.style.display=""}),b.on(c.ON_SWITCH_MAIN2D,function(){a.ui.style.display=""}),b.on(c.ON_SWITCH_ONLY3D,function(){a.ui.style.display=""})}}}]),a}(),Ma=function xc(a){e(this,xc),this.ui=document.createElement("div"),this.ui.className="viewer2D-init-topRight",a.viewer2D.viewerImpl.domElement.appendChild(this.ui),this.ui.addEventListener("click",function(){a.viewer2D.restoreCameraStatus()})},Na=function yc(a){e(this,yc),new Ma(a)},Oa=function(){function a(b){var c=this;e(this,a),b.viewer2D.getViewerImpl().domElement.classList.add("bos2dui"),new ha({viewer2D:b.viewer2D,passLayerCB:function(a){c.passLayer(a)}}),this.layerSwitcher=new ja({viewer2D:b.viewer2D}),new La({viewer2D:b.viewer2D,bos2d:b.BOS2D,linkage:b.linkage}),new Na({viewer2D:b.viewer2D})}return g(a,[{key:"passLayer",value:function(a){this.layerSwitcher.passDrawer(a)}}]),a}(),Pa=function(a){this.viewer=a,this.viewportDIV=a.viewerImpl.getViewerDiv(),this.creatSVG=function(){var a=document.getElementById("svgid");a||(this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("id","svgid"+this.viewer.getViewerImpl().uuid),this.svg.setAttribute("style","width: 100%; height: 100%; position:absolute; left: 0; top:0;"),this.viewportDIV.appendChild(this.svg))},this.creatRect=function(a){var b=(a.data.dir,a.data.left),c=a.data.top,d=a.data.width,e=a.data.height,f=a.data.visible;this.deleteRect(),f&&(this.rect=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rect.setAttribute("id","rectid"),this.rect.setAttribute("x",b),this.rect.setAttribute("y",c),this.rect.setAttribute("width",d),this.rect.setAttribute("height",e),this.rect.setAttribute("style","fill:#0DFFB2;stroke-width:2;stroke:rgb(0,255,0);fill-opacity:0.1;stroke-opacity:0.9"),this.svg.appendChild(this.rect))},this.deleteRect=function(){var a=document.getElementById("rectid");a&&this.svg.removeChild(a)},this.deleteSVG=function(){if(this.svg){var a=document.getElementById("rectid");a&&this.svg.removeChild(a),this.viewportDIV.removeChild(this.svg)}},this.creatMoveCircle=function(a){var b=a.x,c=a.y;this.circleMov=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.circleMov.setAttribute("id","circleMove"),this.circleMov.setAttribute("cx",b),this.circleMov.setAttribute("cy",c),this.circleMov.setAttribute("r","5"),this.circleMov.setAttribute("style","fill:#500A11;stroke-width:2;stroke:rgb(0,255,0);fill-opacity:0.9;stroke-opacity:0.9"),this.svg.appendChild(this.circleMov)},this.changeMoveCircleStyle=function(a){var b=document.getElementById("circleMove");b.setAttribute("cx",a[0]),b.setAttribute("cy",a[1]),b.setAttribute("style","fill:#00ff00;stroke-width:1;stroke:rgb(60,240,240);fill-opacity:0.9;stroke-opacity:0.9")},this.deleteCircle=function(){var a=document.getElementById("circleMove");a&&this.svg.removeChild(a)},this.createMoveLine=function(a,b){var c=a.x,d=a.y,e=b.x,f=b.y;this.deleteMoveLine(),
this.moveline=document.createElementNS("http://www.w3.org/2000/svg","line"),this.moveline.setAttribute("id","moveLine"),this.moveline.setAttribute("class","moveLine"),this.moveline.setAttribute("x1",c),this.moveline.setAttribute("y1",d),this.moveline.setAttribute("x2",e),this.moveline.setAttribute("y2",f),this.moveline.setAttribute("stroke","#0AEA06"),this.moveline.setAttribute("stroke-width","2"),this.svg.appendChild(this.moveline)},this.deleteMoveLine=function(){var a=document.getElementById("moveLine");a&&this.svg.removeChild(a)},this.creatPickCircle=function(a,b){var c=a.x,d=a.y;this.circlePic=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.circlePic.setAttribute("id","circlePick"+b),this.circlePic.setAttribute("class","circlePick"),this.circlePic.setAttribute("cx",c),this.circlePic.setAttribute("cy",d),this.circlePic.setAttribute("r","5"),this.circlePic.setAttribute("style","fill:#00ff00;stroke-width:1;stroke:rgb(60,240,240);fill-opacity:0.9;stroke-opacity:0.9"),this.svg.appendChild(this.circlePic)},this.creatLine=function(a,b,c,d){var e=a.x,f=a.y,g=b.x,h=b.y;this.line=document.createElementNS("http://www.w3.org/2000/svg","line"),this.line.setAttribute("id","pickline"+d),this.line.setAttribute("class","pickline"),this.line.setAttribute("x1",e),this.line.setAttribute("y1",f),this.line.setAttribute("x2",g),this.line.setAttribute("y2",h),this.line.setAttribute("stroke",c),this.line.setAttribute("stroke-width","2"),this.svg.appendChild(this.line)},this.deleteLineAndCircle=function(){for(var a=document.getElementsByClassName("pickline"),b=document.getElementsByClassName("circlePick");a.length;)this.svg.removeChild(a[a.length-1]);for(;b.length;)this.svg.removeChild(b[b.length-1])}},Qa={getClientHeight:function(){var a=0;return a=document.body.clientHeight&&document.documentElement.clientHeight?document.body.clientHeight<document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight:document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight},getClientWidth:function(){var a=0;return a=document.body.clientWidth&&document.documentElement.clientWidth?document.body.clientWidth<document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth:document.body.clientWidth>document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth},getDomOffsetToClient:function(a){var b=null,c=function(a){for(var b=0,c=0;a;)b+=a.offsetTop,c+=a.offsetLeft,a=a.offsetParent;var d=document.body,e=document.documentElement,f=window.pageYOffset||e.scrollTop||d.scrollTop,g=window.pageXOffset||e.scrollLeft||d.scrollLeft;return b-=f,c-=g,{top:b,left:c}},d=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=d.clientTop||c.clientTop,f=d.clientLeft||c.clientLeft,g=b.top-e,h=b.left-f;return{top:Math.round(g),left:Math.round(h)}},e=function(a){return a.getBoundingClientRect?d(a):c(a)};if(a!==document){var f=e(a);b={width:a.offsetWidth,height:a.offsetHeight,left:f.left,top:f.top}}else b={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return b},setClassName:function(a,b){var c=document.getElementById(a);c&&(c.className=b)},addClassName:function(a,b){var c=null,d=null,e=null,f=null,g=null,h=/\s+/,i=document.getElementById(a);if(i&&(d=i,b&&"string"==typeof b&&(c=b.split(h),1===d.nodeType)))if(d.className||1!==c.length){for(e=" "+d.className+" ",f=0,g=c.length;f<g;f+=1)e.indexOf(" "+c[f]+" ")<0&&(e+=c[0]+" ");d.className=String.trim(e)}else d.className=b},removeClassName:function(a,b){var c=null,d=null,e=null,f=null,g=null,h=/\s+/,i=document.getElementById(a);if(i&&(e=i,b&&"string"==typeof b&&(c=(b||"").split(h),1===e.nodeType&&e.className))){for(d=(" "+e.className+" ").replace(0," "),f=0,g=c.length;f<g;f+=1)for(;d.indexOf(" "+c[f]+" ")>=0;)d=d.replace(" "+c[f]+" "," ");e.className=b?String.trim(d):""}},showOrHideElement:function(a,b){var c=document.getElementById(a);c&&(b?c.style.display="":c.style.display="none")},getStyleString:function(a){var b=[];for(var c in a){var d=a[c];b.push(c),b.push(":"),b.push(d),b.push("; ")}return b.join("")},cloneStyle:function(a){var b={};for(var c in a)b[c]=a[c];return b},removeStyleAttribute:function(a,b){Array.isArray(b)||(b=[b]),b.forEach(function(b){b in a&&delete a[b]})},trimRight:function(a){if(0===a.length)return"";for(var b=a.length-1,c=b;c>=0;c-=1)if(" "!==a.charAt(c)){b=c;break}return a.substr(0,b+1)},trimLeft:function(a){if(0===a.length)return"";for(var b=0,c=0;c<a.length;c+=1)if(" "!==a.charAt(c)){b=c;break}return a.substr(b)},trim:function(a){return a.replace(/(^\s*)|(\s*$)/g,"")},matchesSelector:function(a,b){if(a.matches)return a.matches(b);if(a.matchesSelector)return a.matchesSelector(b);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(b);if(a.msMatchesSelector)return a.msMatchesSelector(b);if(a.mozMatchesSelector)return a.mozMatchesSelector(b);if(a.oMatchesSelector)return a.oMatchesSelector(b);if(a.querySelectorAll){for(var c=(a.document||a.ownerDocument).querySelectorAll(b),d=0;c[d]&&void 0!==c[d];)d+=1;return!!c[d]}return!1},toTranslate3d:function(a,b){return"translate3d("+a+"px,"+b+"px,0)"},setCursorStyle:function(a,b){var c=null;switch(b){case"n":case"s":c="ns-resize";break;case"w":case"e":c="ew-resize";break;case"ne":case"sw":c="nesw-resize";break;case"nw":case"se":c="nwse-resize"}a.style.cursor=c},css:function(a,b){for(var c=a.getAttribute("style")||"",d=Object.keys(b),e=c.split(";"),f=[],g=0,h=e.length;g<h;g+=1){var i=e[g];""!==i?f.push(i.replace(/:.+/,"")):e.splice(g,1)}for(var g=0,h=d.length;g<h;g+=1){var i=d[g],j=-1;e.map(function(a,b){return a.indexOf(i)>-1&&(j=b),null}),j>-1?e[j]=i+":"+b[i]:e.push(i+":"+b[i])}var k=e.join(";");a.setAttribute("style",k+";")},append:function(a,b){if("string"==typeof b){var c=document.createElement("div");c.innerHTML=b;for(var d=document.createDocumentFragment();c.firstChild;)d.appendChild(c.firstChild);a.appendChild(d)}else a.appendChild(b)},scrollTop:function(a,b){var c=a.scrollTop;if(c>b)var d=setInterval(function(){var c=a.scrollTop,e=Math.floor(-c/6);a.scrollTop=c=e+c,a.scrollTop<=b&&(a.scrollTop=a.scrollTop=b,clearTimeout(d))},20);else if(0===c)var e=setInterval(function(){var d=a.scrollTop,f=Math.floor(70);a.scrollTop=d=f+d,a.scrollTop<c&&(a.scrollTop=b,clearTimeout(e))},20);else if(c<b)var f=setInterval(function(){var d=a.scrollTop,e=Math.floor(d/6);a.scrollTop=d=e+d,a.scrollTop<c&&(a.scrollTop=b,clearTimeout(f))},20);else if(b===c)return!1},closest:function(a,b){if(!a)return null;for(var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;a&&!c.call(a,b);)a=a.parentElement;return a},addEventListener:function(a,b,c){if(a)if(a.length)for(var d=0;d<a.length;d+=1)a[d].addEventListener(b,function(a){c&&"function"==typeof c&&c(a)});else a.addEventListener(b,function(a){c&&"function"==typeof c&&c(a)})},remove:function(a){if(a)if(a.removeNode=[],void 0!==a.length){for(var b=a.length,c=0;c<b;c+=1)a.removeNode.push({parent:a[c].parentNode,inner:a[c].outerHTML,next:a[c].nextSibling});for(var c=0;c<b;c+=1)a[0].parentNode.removeChild(a[0])}else a.removeNode.push({parent:a.parentNode,inner:a.outerHTML,next:a.nextSibling}),a.parentNode.removeChild(a)},getStyleValue:function(a,b){var c=a.ownerDocument.defaultView;return c&&c.opener||(c=window),a.currentStyle?a.currentStyle[b]:c.getComputedStyle(a)[b]},isShow:function(a){var b=this.getStyleValue(a,"display");return"none"!==b},getHeight:function(a){if(null!==a&&void 0!==a&&this.isShow(a)){if(null!==a.style.height&&void 0!==a.style.height&&a.style.height.length>0)return parseFloat(a.style.height);if(parseFloat(this.getStyleValue(a,"height"))>0)return parseFloat(this.getStyleValue(a,"height"));if(a.offsetHeight>0){var b=this.getStyleValue(a,"borderTopWidth"),c=this.getStyleValue(a,"borderBottomWidth"),d=this.getStyleValue(a,"paddingTop"),e=this.getStyleValue(a,"paddingBottom"),f=parseFloat(a.offsetHeight)-parseFloat(b)-parseFloat(c)-parseFloat(d)-parseFloat(e);return parseFloat(f)}return 0}var g=a.getAttribute("style")||"",h=g+"visibility:hidden;display:block !important;";a.setAttribute("style",h);var i=this.getHeight(a);return a.setAttribute("style",g),Math.ceil(i)},getWidth:function(a){if(null!==a&&void 0!==a&&this.isShow(a)){if(null!==a.style.width&&void 0!==a.style.width&&a.style.width.length>0)return parseFloat(a.style.width);if(parseFloat(this.getStyleValue(a,"width"))>0)return parseFloat(this.getStyleValue(a,"width"));if(a.offsetWidth>0){var b=this.getStyleValue(a,"borderLeftWidth"),c=this.getStyleValue(a,"borderRightWidth"),d=this.getStyleValue(a,"paddingLeft"),e=this.getStyleValue(a,"paddingRight"),f=parseFloat(a.offsetWidth)-parseFloat(b)-parseFloat(c)-parseFloat(d)-parseFloat(e);return parseFloat(f)}return 0}var g=a.getAttribute("style")||"",h=g+"visibility:hidden;display:inline-block !important;";a.setAttribute("style",h);var i=this.getWidth(a);return a.setAttribute("style",g),Math.ceil(i)},outerHeight:function(a,b){var c=a.offsetHeight;if(b){var d=a.currentStyle||getComputedStyle(a);c+=parseInt(d.marginTop,0)+parseInt(d.marginBottom,0)}return c},outerWidth:function(a,b){var c=a.offsetWidth;if(b){var d=a.currentStyle||getComputedStyle(a);c+=parseInt(d.marginLeft,0)+parseInt(d.marginRight,0)}return c},isEmptyObject:function(a){var b=null;for(b in a)return!1;return!0},hasClass:function(a,b){if(a){var c=a.className.match&&a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"));return Boolean(c)}return!1},addClass:function(a,b){a&&(this.hasClass(a,b)||(a.className+=" "+b))},removeClass:function(a,b){if(this.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}},toggleClass:function(a,b){this.hasClass(a,b)?this.removeClass(a,b):this.addClass(a,b)},simulateEvent:function(a,b){var c=document.createEvent("Event");c.initEvent(b,!0,!0);!a.dispatchEvent(c)},bind:function(a,b,c){a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)},delegate:function(a,b,c,d){if(a)if(a.length)for(var e=0;e<a.length;e+=1)this.delegateFn(a[e],b,c,d);else this.delegateFn(a,b,c,d)},delegateFn:function(a,b,c,d){function e(a){var a=a||window.event,e=a.target||a.srcElement;f.matchSelector(e,b)&&d&&("mouseenter"===c||"mouseleave"===c?f.fixedMouse(a,e)&&d.call(e,a):d.call(e,a))}var f=this;c=c.toLowerCase(),a.addEventListener?"mouseenter"===c?a.addEventListener("mouseover",e):"mouseleave"===c?a.addEventListener("mouseout",e):a.addEventListener(c,e):"mouseenter"===c?a.attachEvent("onmouseover",e):"mouseleave"===c?a.attachEvent("onmouseout",e):a.attachEvent("on"+c,e)},matchSelector:function(a,b){return"#"===b.charAt(0)?a.id===b.slice(1):"."===b.charAt(0)?(" "+a.className+" ").indexOf(" "+b.slice(1)+" ")!==-1:a.tagName.toLowerCase()===b.toLowerCase()},contains:function(a,b){return a.contains?a!==b&&a.contains(b):Boolean(16&a.compareDocumentPosition(b))},fixedMouse:function(a,b){var c=null,d=a.type.toLowerCase();if("mouseover"===d)c=a.relatedTarget||a.fromElement;else{if("mouseout"!==d)return!0;c=a.relatedTarget||a.toElement}return c&&"xul"!==c.prefix&&!this.contains(b,c)&&c!==b},fireEvent:function(a,b){var c=null;if(a.ownerDocument)c=a.ownerDocument;else{if(9!==a.nodeType)throw new Error("Invalid node passed to fireEvent: "+a.id);c=a}if(a.dispatchEvent){var d="";switch(b){case"click":case"mousedown":case"mouseup":d="MouseEvents";break;case"focus":case"change":case"blur":case"select":d="HTMLEvents";break;default:G.error("fireEvent: Couldn't find an event class for event '"+b+"'.")}var e=c.createEvent(d),f="change"!==b;e.initEvent(b,f,!0),e.synthetic=!0,a.dispatchEvent(e,!0)}else if(a.fireEvent){var e=c.createEventObject();e.synthetic=!0,a.fireEvent("on"+b,e)}}};Object.assign(y.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"==typeof performance?Date:performance).now();a=(b-this.oldTime)/1e3,this.oldTime=b,this.elapsedTime+=a}return a}});var Ra=function(){this.elements=[1,0,0,0,1,0,0,0,1]};Ra.prototype.clear=function(){return this.elements=[1,0,0,0,1,0,0,0,1],this},Ra.prototype.set=function(a,b,c,d,e,f,g,h,i){var j=this.elements;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this},Ra.prototype.clone=function(){return(new this.constructor).fromArray(this.elements)},Ra.prototype.fromArray=function(a,b){void 0===b&&(b=0);for(var c=0;c<9;c+=1)this.elements[c]=a[c+b];return this},Ra.prototype.multiply=function(a){return this.multiplyMatrices(this,a)},Ra.prototype.multiplyMatrices=function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=d[0],p=d[3],q=d[6],r=d[1],s=d[4],t=d[7],u=d[2],v=d[5],w=d[8];return e[0]=f*o+g*r+h*u,e[3]=f*p+g*s+h*v,e[6]=f*q+g*t+h*w,e[1]=i*o+j*r+k*u,e[4]=i*p+j*s+k*v,e[7]=i*q+j*t+k*w,e[2]=l*o+m*r+n*u,e[5]=l*p+m*s+n*v,e[8]=l*q+m*t+n*w,this},Ra.prototype.scale=function(a,b){var c=this.elements;return c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=b,c[4]*=b,c[7]*=b,this},Ra.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.elements,e=d[0],f=d[3],g=d[6],h=d[1],i=d[4],j=d[7];return d[0]=b*e+c*h,d[3]=b*f+c*i,d[6]=b*g+c*j,d[1]=-c*e+b*h,d[4]=-c*f+b*i,d[7]=-c*g+b*j,this},Ra.prototype.translate=function(a,b){var c=this.elements;return c[0]+=a*c[2],c[3]+=a*c[5],c[6]+=a*c[8],c[1]+=b*c[2],c[4]+=b*c[5],c[7]+=b*c[8],this},Ra.prototype.fromCanvasTransform=function(a,b,c,d,e,f){this.elements;return this.set(a,c,e,b,d,f,0,0,1),this},Ra.prototype.toCanvasTransform=function(){var a=this.elements;return[a[0],a[3],a[1],a[4],a[6],a[7]]},Ra.prototype.getInverse=function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements,d=this.elements,e=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=c[8],n=m*i-j*l,o=j*k-m*h,p=l*h-i*k,q=e*n+f*o+g*p;if(0===q){var r="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(b===!0)throw new Error(r);return console.warn(r),this.identity()}var s=1/q;return d[0]=n*s,d[1]=(g*l-m*f)*s,d[2]=(j*f-g*i)*s,d[3]=o*s,d[4]=(m*e-g*k)*s,d[5]=(g*h-j*e)*s,d[6]=p*s,d[7]=(f*k-l*e)*s,d[8]=(i*e-f*h)*s,this};var Sa=function(a){this.viewportTransform=a||[1,0,0,1,0,0],this.position=void 0,this.rotate=void 0};Object.assign(Sa.prototype,{constructor:Sa,getViewportTransform:function(){return this.viewportTransform.concat()},setViewportTransform:function(a){this.viewportTransform[0]=a[0],this.viewportTransform[1]=a[1],this.viewportTransform[2]=a[2],this.viewportTransform[3]=a[3],this.viewportTransform[4]=a[4],this.viewportTransform[5]=a[5]},render:function(a,b,c,d){var e=10;if(this.position){var f=this.position.clone().applyMatrix3(b).toArray();f[0]<0&&(f[0]=0),f[1]<0&&(f[1]=0),f[0]>c&&(f[0]=c),f[1]>d&&(f[1]=d);var g=new Ra;if(g.translate(f[0],f[1]),this.rotate){var h=new Ra;h.rotate(this.rotate),g.multiply(h)}var i=g.toCanvasTransform();a.save(),a.setTransform(i[0],i[1],i[2],i[3],i[4],i[5]),a.beginPath(),a.arc(0,0,e,0,2*Math.PI),a.fillStyle="#00ff00",a.moveTo(e,-e),a.lineTo(3*e,0),a.lineTo(e,e),a.arcTo(1.5*e,0,e,-e,e),a.closePath(),a.fill(),a.restore()}}});var Ta=function(a,b){this.x=a,this.y=b};Ta.prototype={type:"point",constructor:Ta,add:function(a){return new Ta(this.x+a.x,this.y+a.y)},addEquals:function(a){return this.x+=a.x,this.y+=a.y,this},scalarAdd:function(a){return new Ta(this.x+a,this.y+a)},scalarAddEquals:function(a){return this.x+=a,this.y+=a,this},subtract:function(a){return new Ta(this.x-a.x,this.y-a.y)},subtractEquals:function(a){return this.x-=a.x,this.y-=a.y,this},scalarSubtract:function(a){return new Ta(this.x-a,this.y-a)},scalarSubtractEquals:function(a){return this.x-=a,this.y-=a,this},multiply:function(a){return new Ta(this.x*a,this.y*a)},multiplyEquals:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return new Ta(this.x/a,this.y/a)},divideEquals:function(a){return this.x/=a,this.y/=a,this},equal:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(a,b){return"undefined"==typeof b&&(b=.5),b=Math.max(Math.min(1,b),0),new Ta(this.x+(a.x-this.x)*b,this.y+(a.y-this.y)*b)},distanceFrom:function(a){var b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)},midPointFrom:function(a){return this.lerp(a)},min:function(a){return new Ta(Math.min(this.x,a.x),Math.min(this.y,a.y))},max:function(a){return new Ta(Math.max(this.x,a.x),Math.max(this.y,a.y))},toString:function(){return this.x+","+this.y},setXY:function(a,b){return this.x=a,this.y=b,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setFromPoint:function(a){return this.x=a.x,this.y=a.y,this},swap:function(a){var b=this.x,c=this.y;this.x=a.x,this.y=a.y,a.x=b,a.y=c},clone:function(){return new Ta(this.x,this.y)}};var Ua=Math.sqrt,Va=Math.atan2,Wa=Math.pow,Xa=Math.abs,Ya=Math.PI/180,Za=Math.PI/2,$a={cos:function(a){if(0===a)return 1;a<0&&(a=-a);var b=a/Za;switch(b){case 1:case 3:return 0;case 2:return-1;default:return Math.cos(a)}},sin:function(a){if(0===a)return 0;var b=a/Za,c=1;switch(a<0&&(c=-1),b){case 1:return c;case 2:return 0;case 3:return-c;default:return Math.sin(a)}},removeFromArray:function(a,b){var c=a.indexOf(b);return c!==-1&&a.splice(c,1),a},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},degreesToRadians:function(a){return a*Ya},radiansToDegrees:function(a){return a/Ya},identityMatrix2D:function(){return[1,0,0,1,0,0]},rotatePoint:function(a,b,c){a.subtractEquals(b);var d=$a.rotateVector(a,c);return new Ta(d.x,d.y).addEquals(b)},rotateVector:function(a,b){var c=$a.sin(b),d=$a.cos(b),e=a.x*d-a.y*c,f=a.x*c+a.y*d;return{x:e,y:f}},transformPoint:function(a,b,c){return c?new Ta(b[0]*a.x+b[2]*a.y,b[1]*a.x+b[3]*a.y):new Ta(b[0]*a.x+b[2]*a.y+b[4],b[1]*a.x+b[3]*a.y+b[5])},makeBoundingBoxFromPoints:function(a){var b=[a[0].x,a[1].x,a[2].x,a[3].x],c=$a.array.min(b),d=$a.array.max(b),e=d-c,f=[a[0].y,a[1].y,a[2].y,a[3].y],g=$a.array.min(f),h=$a.array.max(f),i=h-g;return{left:c,top:g,width:e,height:i}},invertTransform:function(a){var b=1/(a[0]*a[3]-a[1]*a[2]),c=[b*a[3],-b*a[1],-b*a[2],b*a[0]],d=$a.transformPoint({x:a[4],y:a[5]},c,!0);return c[4]=-d.x,c[5]=-d.y,c},toFixed:function(a,b){return parseFloat(Number(a).toFixed(b))},parseUnit:function(a,b){var c=/\D{0,2}$/.exec(a),d=parseFloat(a);switch(b||(b=Text.DEFAULT_SVG_FONT_SIZE),c[0]){case"mm":return d*aa/25.4;case"cm":return d*aa/2.54;case"in":return d*aa;case"pt":return d*aa/72;case"pc":return d*aa/72*12;case"em":return d*b;default:return d}},falseFunction:function(){return!1},getKlass:function(a,b){return a=$a.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),$a.resolveNamespace(b)[a]},loadImage:function(a,b,c,d){if(!a)return void(b&&b.call(c,a));var e=$a.createImage(),f=function(){b&&b.call(c,e),e=e.onload=e.onerror=null};e.onload=f,e.onerror=function(){G("Error loading "+e.src),b&&b.call(c,null,!0),e=e.onload=e.onerror=null},0!==a.indexOf("data")&&d&&(e.crossOrigin=d),"data:image/svg"===a.substring(0,14)&&(e.onload=null,$a.loadImageInDom(e,f)),e.src=a},loadImageInDom:function(a,b){var c=document.createElement("div");c.style.width=c.style.height="1px",c.style.left=c.style.top="-100%",c.style.position="absolute",c.appendChild(a),document.querySelector("body").appendChild(c),a.onload=function(){b(),c.parentNode.removeChild(c),c=null}},drawDashedLine:function(a,b,c,d,e,f){var g=d-b,h=e-c,i=Math.sqrt(g*g+h*h),j=Math.atan2(h,g),k=f.length,l=0,m=!0;for(a.save(),a.translate(b,c),a.moveTo(0,0),a.rotate(j),b=0;i>b;)b+=f[l++%k],b>i&&(b=i),a[m?"lineTo":"moveTo"](b,0),m=!m;a.restore()},createCanvasElement:function(){return document.createElement("canvas")},copyCanvasElement:function(a){var b=$a.createCanvasElement();return b.width=a.width,b.height=a.height,b.getContext("2d").drawImage(a,0,0),b},toDataURL:function(a,b,c){return a.toDataURL("image/"+b,c)},createImage:function(){return document.createElement("img")},clipContext:function(a,b){b.save(),b.beginPath(),a.clipTo(b),b.clip()},multiplyTransformMatrices:function(a,b,c){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3],c?0:a[0]*b[4]+a[2]*b[5]+a[4],c?0:a[1]*b[4]+a[3]*b[5]+a[5]]},qrDecompose:function(a){var b=Va(a[1],a[0]),c=Wa(a[0],2)+Wa(a[1],2),d=Ua(c),e=(a[0]*a[3]-a[2]*a[1])/d,f=Va(a[0]*a[2]+a[1]*a[3],c);return{angle:b/Ya,scaleX:d,scaleY:e,skewX:f/Ya,skewY:0,translateX:a[4],translateY:a[5]}},customTransformMatrix:function(a,b,c){var d=[1,0,Xa(Math.tan(c*Ya)),1],e=[Xa(a),0,0,Xa(b)];return $a.multiplyTransformMatrices(e,d,!0)},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},getFunctionBody:function(a){return(String(a).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(a,b,c,d){d>0&&(b>d?b-=d:b=0,c>d?c-=d:c=0);var e=!0,f=null,g=null,h=a.getImageData(b,c,2*d||1,2*d||1),i=h.data.length;for(f=3;f<i&&(g=h.data[f],e=g<=0,e!==!1);f+=4);return h=null,e},parsePreserveAspectRatioAttribute:function(a){var b="meet",c="Mid",d="Mid",e=a.split(" "),f=null;return e&&e.length&&(b=e.pop(),"meet"!==b&&"slice"!==b?(f=b,b="meet"):e.length&&(f=e.pop())),c="none"!==f?f.slice(1,4):"none",d="none"!==f?f.slice(5,8):"none",{meetOrSlice:b,alignX:c,alignY:d}},limitDimsByArea:function(a,b){var c=Math.sqrt(b*a),d=Math.floor(b/c);return{x:Math.floor(c),y:d}},capValue:function(a,b,c){return Math.max(a,Math.min(b,c))},findScaleToFit:function(a,b){return Math.min(b.width/a.width,b.height/a.height)},findScaleToCover:function(a,b){return Math.max(b.width/a.width,b.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(a){return $a.toFixed(a,Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},getBox2FromPath:function(a){var b=new D,c=[],d=[];if(c=a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),c&&c.length>0)for(var e=0,f=0,g=[],h=null,i=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,j=null,k=null,l={},m=0,n=c.length;m<n;m+=1){for(h=c[m],k=h.slice(1).trim(),g.length=0;j=i.exec(k);)g.push(j[0]);e=parseFloat(g[0]),f=parseFloat(g[1]),isNaN(e)||isNaN(f)||(l.x=e,l.y=f,d.push({x:e,y:f}),b.expandByPoint(l))}return{box:b,keyPoints:d}},canvasRotateAngleOfVector:function(a,b){var c=2*Math.PI,d=Math.atan2(b,a);return d<0&&(d+=c),d>=c&&(d-=c),d},decodeUTF8:function(a){for(var b="",c=0;c<a.length;c+=1)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))}},_a=function(){this.scene=null,this.viewportTransform=null,this.ctx=null,this.octantMap=null,this.mouse=new B},ab=function(a){this.viewer=a,this.filter=a.filter,this.recursive=!0,this.lastIntersect=null};ab.prototype.destroy=function(){this.raycaster=null,this.lastIntersect=null},ab.prototype.intersect=function(a,b,c,d){var e=void 0,f=void 0,g=void 0,h=void 0,i=this.viewer.drawManager,j=this.viewer.camera.getViewportTransform(),k=this.viewer.canvas.width,l=this.viewer.canvas.height,m=this.viewer.viewingBox,n=i.getCurrentDraw();if(n){var o=n.components;if(o){var p=n.localMatrixWithCanvasSize(k,l),q=new Ra;q.fromCanvasTransform(j[0],j[1],j[2],j[3],j[4],j[5]);var r=n.hiddenLayers(),s=Object.keys(o),t=!1;if(n.quadTree&&n.quadTree.isValid()){var u=new Ra;u.multiplyMatrices(q,p);var v=(new Ra).getInverse(u),w=m.clone().applyMatrix3(v),x=n.quadTree.allComponentsInBox(w);x&&(s=x,t=!0)}for(var y=0,z=s.length;y<z;y+=1){var A=s[y];t&&(A=n.modelKey+"_"+A);var B=o[A];if(B){var C=B.hitTest(3,m,a.mouse,q,p,r);if(C){var D=C.path;if(!$a.isTransparent(a.ctx,a.mouse.x,a.mouse.y,3))if(e){var E=e.max.x-e.min.x,F=e.max.y-e.min.y,H=D.boundingBox.max.x-D.boundingBox.min.x,I=D.boundingBox.max.y-D.boundingBox.min.y;(E>H||F>I)&&(e=D.boundingBox,f=B.componentKey,g=C.part.partKey,h=D)}else e=D.boundingBox,f=B.componentKey,g=C.part.partKey,h=D}}}if(f){G.debug(h);var J=n.getVisiblePathsOfComponentPart(g);return J&&(J.path=h),J}}}},ab.prototype.hitTest=function(a){var b=this.intersect(a,null,!1);return null!==b?b.point:null},ab.prototype.pick=function(a,b){var c=this.intersect(a,null,!0);return b&&b(c),c},ab.prototype.getIntersectByRay=function(a,b){return this.intersect(a,b,!0)};var bb=function(a,b,c,d){var e=this;this.camera=b,this.viewer=a,this.domElement=c,this.drawManager=a.drawManager,this.intersector=new ab(a),this.minZoom=.05,this.maxZoom=10,this.update=function(){this.dispatchEvent({type:ga.ON_CAMERA_CHANGE}),d(!0)},this.getIntersectContext=function(a){var b=new _a;return b.camera=this.camera,null!==a&&this.mapWindowToViewport(a.x,a.y,b.mouse),b.viewportSize=new B(e.viewer.canvas.width,e.viewer.canvas.height),b.ctx=e.viewer.ctx,b},this.mapWindowToViewport=function(a,b,c){var d=this.getContainerDimensions(),e=c||new B;return e.x=a-d.left,e.y=b-d.top,e},this.updateView=function(){this.dispatchEvent({type:ga.ON_CAMERA_CHANGE}),d(!1)}};Object.assign(bb.prototype,{constructor:bb,getContainerDimensions:function(){return Qa.getDomOffsetToClient(this.domElement)},screenToCanvas:function(a,b){var c=this.getContainerDimensions();return{x:a-c.left,y:b-c.top}},getZoom:function(){return this.camera.viewportTransform[0]},setViewportTransform:function(a){return this.camera.viewportTransform=a,this.update(),this},calcViewportBoundaries:function(){var a={},b=this.width,c=this.height,d=$a.invertTransform(this.camera.viewportTransform);return a.tl=$a.transformPoint({x:0,y:0},d),a.br=$a.transformPoint({x:b,y:c},d),a.tr=new Ta(a.br.x,a.tl.y),a.bl=new Ta(a.tl.x,a.br.y),this.vptCoords=a,a},zoomToPoint:function(a,b){var c=a,d=this.camera.viewportTransform.slice(0);a=$a.transformPoint(a,$a.invertTransform(this.camera.viewportTransform)),d[0]=b,d[3]=b;var e=$a.transformPoint(a,d);return d[4]+=c.x-e.x,d[5]+=c.y-e.y,this.setViewportTransform(d)},zoom:function zc(a,b,c){var zc=this.getZoom();if(zc*=a,Z.ConstraintZoom&&(zc<this.minZoom||zc>this.maxZoom))return!1;void 0!==b&&void 0!==c||(b=0,c=0);var d=new Ta(b,c);return this.zoomToPoint(d,zc),!0},setZoom:function(a){return this.zoomToPoint(new Ta(0,0),a),this},absolutePan:function(a){var b=this.camera.viewportTransform.slice(0);return b[4]=-a.x,b[5]=-a.y,this.setViewportTransform(b)},relativePan:function(a){return this.absolutePan(new Ta(-a.x-this.camera.viewportTransform[4],-a.y-this.camera.viewportTransform[5]))},zoomToScreenBox:function(a){if(a){var b=this.viewer.viewingBox,c=a.getSize(new B),d=b.getSize(new B),e=d.divide(c),f=b.getCenter(new B),g=a.getCenter(new B),h=1;h=e.x>e.y?e.y:e.x;var i=f.clone().sub(g);this.relativePan(i),this.zoomToPoint(f,this.getZoom()*h)}}}),Object.assign(bb.prototype,J.prototype);var cb={ALT:18,CTRL:17,SHIFTLEFT:16,BACKSPACE:8,LEFT:37,UP:38,RIGHT:39,DOWN:40,A:65,D:68,E:69,Q:81,S:83,W:87,Z:90,PLUS:187,SUB:189,ZERO:48,ESC:27,TAB:9,NUMPADADD:107,NUMPADSUBTRACT:109,NUMPAD0:96},db=function(a){this.name=a,this._mousePressed=!1};db.prototype.getName=function(){return this.name},db.prototype.onExit=function(){},db.prototype.processMouseDown=function(a){return!1},db.prototype.processMouseMove=function(a){return!1},db.prototype.processMouseUp=function(a){return!1},db.prototype.processMouseWheel=function(a){return!1},db.prototype.processMouseDoubleClick=function(a){return!1},db.prototype.processKeyDown=function(a){return!1},db.prototype.processKeyUp=function(a){switch(a.keyCode){case cb.ESC:this._mousePressed=!1}return!1},db.prototype.processTouchstart=function(a){return!1},db.prototype.processTouchmove=function(a){return!1},db.prototype.processTouchend=function(a){return!1},db.prototype.processHover=function(a){return!1},db.prototype.onEvent=function(a){var b=!1;switch(a.type){case"touchmove":b=this.processTouchmove(a);break;case"touchstart":b=this.processTouchstart(a);break;case"touchend":b=this.processTouchend(a);break;case"keydown":b=this.processKeyDown(a);break;case"keyup":b=this.processKeyUp(a);break;case"mousewheel":case"DOMMouseScroll":b=this.processMouseWheel(a);break;case"mousedown":this._mousePressed=!0,b=this.processMouseDown(a);break;case"mousemove":b=this._mousePressed?this.processMouseMove(a):this.processHover(a);break;case"mouseup":this._mousePressed=!1,b=this.processMouseUp(a);break;case"dblclick":b=this.processMouseDoubleClick(a)}return b};var eb=function(a){db.call(this,ea.CLIP_BY_BOX),this.viewer=a,this.enablePick=!1,this.cameraControl=a.cameraControl,this.startPt=new B,this.onClipBox=!1;var b=this.viewer.getClipPlanes(),c=a.drawManager.getCurrentDraw().boundingBox.clone();b.init(c),b.enable(!0,!0),this.selectIndex=null,this.planeDistance=0,this.offsetSpeed=.02,this.toggle=function(a,c){b.enable(a,c)},this.visible=function(a){b.visible=a},this.rotatable=function(a){b.rotatable=a},this.store=function(){return b.store()},this.restore=function(a){b.restore(a)},this.reset=function(){b.reset()},this.pointToScreen=function(a){},this.getPlaneDistanceInScreen=function(){},this.getPickPoint=function(a,b){},this.getSelectIndex=function(){return b.selectIndex},this.setSelectIndex=function(a){b.selectIndex=a},this._isVisible=function(){return b.visible},this.isRotate=function(){return b.rotatable},this.offset=function(a){var c=Math.floor(this.selectIndex/2);this.selectIndex<=3?b.offset(this.selectIndex,-a*b.cubeSize.getComponent(c)*2):this.selectIndex%2===1?b.offset(this.selectIndex,-a*b.cubeSize.getComponent(c)*2):b.offset(this.selectIndex,a*b.cubeSize.getComponent(c)*2)},this.setSectionBox=function(a,c){var d=new D(new B(a.x,a.y),new B(c.x,c.y));b.setSectionBox(d.min,d.max)},this.calculateOffsetByBox=function(a,c){var d=new D(new B(a.x,a.y),new B(c.x,c.y));d.setFromCenterAndSize(d.getCenter(),d.getSize()),b.calculateOffsetByBox(d.min,d.max)},this.moveSectionPlane=function(a,c){b.moveSectionPlane(a,c)},this.rotateSectionBox=function(a,c){b.rotateSectionBox(a,c)},this.rotate=function(a,c){2===this.selectIndex||3===this.selectIndex?b.rotX(c/180*Math.PI*.1):b.rotY(a/180*Math.PI*.1)},this.update=function(a){b.update(a)},this.cancelHighLight=function(){b.cancelHighLight()},this.highLight=function(){b.highLight()},this.setProcess=function(a,c){b.setProcess(a,c)},this.getProcess=function(a){return b.getProcess(a)}};eb.prototype=Object.create(db.prototype),eb.prototype.constructor=eb,eb.prototype.destroy=function(){this.cameraControl=null,this.intersectPoint=null,this.selectIndex=null,this.normal=null,this.plane=null,this.pickHelper=null,this.scene=null,this.viewer=null},eb.prototype.onExit=function(){this.toggle(!1,!1)},eb.prototype.processMouseDown=function(a){if(this.startPt.set(a.clientX,a.clientY),!this.enablePick&&a.button===ca.LEFT){var b=a.target.clipName,c=!1;switch(b){case"topLine":c=!0;break;case"leftLine":c=!0;break;case"rightLine":c=!0;break;case"bottomLine":c=!0}if(c)return this.selectIndex=this.getSelectIndex(),null!==this.selectIndex?(this.highLight(),this.enablePick=!0,this.clipStartPoint=null,!0):db.prototype.processMouseDown(this,a)}return db.prototype.processMouseDown(this,a)},eb.prototype.processHover=function(a){if(!this.enablePick){var b=!1,c=a.target.clipName,d=!1;switch(c){case"topLine":d=!0;break;case"leftLine":d=!0;break;case"rightLine":d=!0;break;case"bottomLine":d=!0}var e=this.getSelectIndex();if(null!==e&&this.cancelHighLight(),d||(c=null),this.setSelectIndex(c),this.selectIndex=this.getSelectIndex(),null!==this.selectIndex){if(this.highLight(),!this.onClipBox){this.onClipBox=!0;var f=this.cameraControl.viewer.drawManager;f.dispatchEvent({type:ga.ON_CLIP_HOVER,onClipBox:!0,event:a})}b=!0}else if(this.onClipBox){this.onClipBox=!1;
var g=this.cameraControl.viewer.drawManager;g.dispatchEvent({type:ga.ON_CLIP_HOVER,onClipBox:!1,event:a})}return b}return db.prototype.processHover(this,a)},eb.prototype.processMouseUp=function(a){if(a.button===ca.LEFT){var b=this.viewer.getClipPlanes(),c=this.getSelectIndex();if(null!==c&&this.cancelHighLight(),this.selectIndex=this.getSelectIndex(),null!==this.selectIndex){if(this.highLight(),!this.onClipBox){this.onClipBox=!0;var d=this.cameraControl.viewer.drawManager;d.dispatchEvent({type:ga.ON_CLIP_HOVER,onClipBox:!0,event:a})}}else if(this.onClipBox){this.onClipBox=!1;var d=this.cameraControl.viewer.drawManager;d.dispatchEvent({type:ga.ON_CLIP_HOVER,onClipBox:!1,event:a})}if(b.update(),this.enablePick)return this.planeDistance=0,this.enablePick=!1,!0}return db.prototype.processMouseUp(this,a)},eb.prototype.processMouseMove=function(a){if(this.enablePick){if(this.isRotate())this.rotate(a.clientX-this.startPt.x,a.clientY-this.startPt.y),this.startPt.set(a.clientX,a.clientY);else{var b=a.clientX===this.startPt.x&&a.clientY===this.startPt.y;if(!b){var c=this.viewer.getClipPlanes(),d=c.boundingBox.applyMatrix3(this.viewer.getSceneToScreenMatrix()),e=d.getSize(new B),f=this.selectIndex,g=new B(a.clientX-this.startPt.x,a.clientY-this.startPt.y),h=g.x,i=g.y;switch(f){case"leftLine":e.x-h<=7&&(h=0),d.min.x+=h;break;case"topLine":e.y-i<=7&&(i=0),d.min.y+=i;break;case"bottomLine":e.y+i<=7&&(i=0),d.max.y+=i;break;case"rightLine":e.x+h<=7&&(h=0),d.max.x+=h}d.applyMatrix3(this.viewer.getScreenToSceneMatrix()),this.startPt.set(a.clientX,a.clientY),this.cameraControl.update(!0)}}return!0}return db.prototype.processMouseMove(this,a)},eb.prototype.processTouchstart=function(a){if(this.startPt.set(a.touches[0].clientX,a.touches[0].clientY),!this.enablePick){var b=this.viewer.getClipPlanes(),c=b.selectedLineNameAtPosition(a.touches[0].clientX,a.touches[0].clientY);if(c)return this.setSelectIndex(c),this.selectIndex=this.getSelectIndex(),this.highLight(),this.enablePick=!0,this.clipStartPoint=null,!0}return db.prototype.processTouchstart(this,a)},eb.prototype.processTouchmove=function(a){if(this.enablePick){if(this.isRotate())this.rotate(a.touches[0].clientX-this.startPt.x,a.touches[0].clientY-this.startPt.y),this.startPt.set(a.touches[0].clientX,a.touches[0].clientY);else{var b=a.touches[0].clientX===this.startPt.x&&a.touches[0].clientY===this.startPt.y;if(!b){var c=this.viewer.getClipPlanes(),d=c.boundingBox.applyMatrix3(this.viewer.getSceneToScreenMatrix()),e=d.getSize(new B),f=this.selectIndex,g=new B(a.touches[0].clientX-this.startPt.x,a.touches[0].clientY-this.startPt.y),h=g.x,i=g.y;switch(f){case"leftLine":e.x-h<=7&&(h=0),d.min.x+=h;break;case"topLine":e.y-i<=7&&(i=0),d.min.y+=i;break;case"bottomLine":e.y+i<=7&&(i=0),d.max.y+=i;break;case"rightLine":e.x+h<=7&&(h=0),d.max.x+=h}d.applyMatrix3(this.viewer.getScreenToSceneMatrix()),this.startPt.set(a.touches[0].clientX,a.touches[0].clientY),this.cameraControl.update(!0)}}return!0}return db.prototype.processMouseMove(this,a)},eb.prototype.processTouchend=function(a){this.selectIndex=null;var b=this.viewer.getClipPlanes();return b.update(),this.cancelHighLight(),this.enablePick?(this.planeDistance=0,this.enablePick=!1,!0):db.prototype.processTouchend(this,a)};var fb=function(a){this.cameraControl=a,this.scene=a.scene,this.timerId=null,this.lastIntersected=null};fb.prototype={constructor:fb,destroy:function(){this.cameraControl=null,this.scene=null},click:function(a,b){function c(){b&&b.pickable===!1&&(b=null),d.handleMousePick(a,!1,b)}var d=this;this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(c,300)},doubleClick:function(a){a.preventDefault(),this.timerId&&clearTimeout(this.timerId),this.handleMousePick(a,!0,null)},handleMousePick:function(a,b,c){function d(c,d){j.dispatchEvent({type:ga.ON_CLICK_PICK,event:a,doubleClick:b,canvasPos:{x:i.x,y:i.y},intersectInfo:c?{selectedObjectId:c.userId,modelKey:c.modelKey,selectable:d,object:c}:null})}var e=this.cameraControl,f=e.viewer.drawManager.sceneState,g=this,h=new B(a.clientX,a.clientY),i=e.screenToCanvas(a.clientX,a.clientY),j=e.viewer.drawManager,k=null;if(c)c.pickable&&(k=c.intersect);else{var l=e.getIntersectContext(h);k=e.intersector.pick(l,null)}if(!k){var m=f.getSelection();if(a.ctrlKey)return;return m.length>0&&f.clearSelection(),void(c&&!c.pickable?(k=c.intersect,k.cx=h.x,k.cy=h.y,d(k,!1)):d(null))}var n=k.userId;if(k.innnerDebugging=a.altKey,k.cx=h.x,k.cy=h.y,g.lastPickedUserId=n,b)Z.EnableDemolishByDClick?(f.setSelection([n]),d(k,!0)):(f.setSelection([n]),d(k,!0));else{var o=f.getSelection();if(a.ctrlKey){var p=o.indexOf(n);p===-1?f.addSelection([n]):(o.splice(p,1),f.setSelection(o))}else o.indexOf(n)===-1?f.setSelection([n]):f.clearSelection();d(k,!0),e.updateView(!0)}},handleShiftMeasure:function(a,b,c){},handleMouseMeasure:function(a,b,c){function d(c,d,g){var h=f.viewer.drawManager;e={type:ga.ON_MEASURE_PICK,event:a,pick:b,pickPoint:c,mouse:i,userId:g,isAbsorbPoint:d,measureUnit:"mm"},h.dispatchEvent(e)}var e=null,f=this.cameraControl,g=(f.scene,new B(a.clientX,a.clientY)),h=f.getIntersectContext(g),i=h.mouse.clone(),j=new B,k=f.viewer.getScreenToSceneMatrix(),l=i.clone().applyMatrix3(k);return j.set(l.x,l.y),f.intersector.pick(h,function(a){var e=!1;if(a){if(a.path&&a.path.keyPoints)for(var g=a.path.keyPoints,h=25,k=0,l=g.length;k<l;k+=1){var m=g[k],n=f.viewer.getScreenCoordFromSceneCoord([m.x,m.y]),o=n[0]-i.x,p=n[1]-i.y,q=o*o+p*p;q<h&&(h=q,e=!0,j.set(m.x,m.y))}b&&c.copy(j),d(j,e,a.userId)}else d(j,!1,null)}),e},handleMouseHover:function(a){function b(b,c){var e=d.viewer.drawManager;e.dispatchEvent({type:ga.ON_HOVER_PICK,event:a,canvasPos:{x:f.x,y:f.y},intersectInfo:b?{selectedObjectId:b.userId,objectType:b.objectType,selectable:c,modelKey:b.modelKey,worldPosition:b.worldPosition,worldBoundingBox:b.worldBoundingBox,point:b.point,innnerDebugging:b.innnerDebugging,object:b.object}:null})}var c=this,d=this.cameraControl,e=d.viewer.drawManager.sceneState;if(Z.Hover){var f=d.screenToCanvas(a.clientX,a.clientY),g=new B(a.clientX,a.clientY),h=d.getIntersectContext(g);d.intersector.pick(h,function(a){if(a){var f=Z.Hover||a.hoverEnabled;c.lastIntersected&&(c.lastIntersected.userId!==a.userId&&e.clearHover(),c.lastIntersected.hoverEnabled&&b(null)),f&&(c.lastIntersected&&c.lastIntersected.userId===a.userId||(e.setHoverId(a.userId,a),c.lastIntersected=a),b(a,!0)),d.updateView(!0)}else c.lastIntersected&&(e.clearHover(),c.lastIntersected=null,d.updateView(!0),b(null))})}}};var gb="http://www.w3.org/2000/svg",hb=function(a,b,c,d){var e=document.createElementNS(gb,"defs"),f=document.createElementNS(gb,"filter");f.id=a,f.setAttributeNS(null,"x","-30%"),f.setAttributeNS(null,"y","-30%"),f.setAttributeNS(null,"width","200%"),f.setAttributeNS(null,"height","200%");var g=document.createElementNS(gb,"feGaussianBlur");g.setAttributeNS(null,"in","SourceAlpha"),g.setAttributeNS(null,"stdDeviation","4");var h=document.createElementNS(gb,"feOffset");h.setAttributeNS(null,"result","offsetblur");var i=document.createElementNS(gb,"feMerge"),j=document.createElementNS(gb,"feMergeNode"),k=document.createElementNS(gb,"feMergeNode");return k.setAttributeNS(null,"in","SourceGraphic"),i.appendChild(j),i.appendChild(k),f.appendChild(g),f.appendChild(h),f.appendChild(i),e.appendChild(f),e},ib=function(){var a=document.createElementNS(gb,"svg"),b=hb("drop-shadow");return a.appendChild(b),a},jb=function(){var a=document.createElementNS(gb,"line");return a},kb=function(){var a=document.createElementNS(gb,"path");return a},lb=function(a){var b=document.createElementNS(gb,"circle");return b.setAttributeNS(null,"r",a?a:0),b.setAttributeNS(null,"fill","none"),b},mb=function(){var a=document.createElementNS(gb,"text");return a},nb=function(){var a=document.createElementNS(gb,"polygon");return a},ob=function(){var a=document.createElementNS(gb,"g");return a},pb=function(a,b,c,d,e){return"M"+a+","+(b+e)+"a"+e+","+e+" 0 0 1 "+e+","+-e+"h"+(c-e)+"v"+d+"h"+(e-c)+"a"+e+","+e+" 0 0 1 "+-e+","+-e+"v"+(2*e-d)+"z"},qb=function(a,b,c,d,e){return"M"+a+","+(b+e)+"a"+e+","+e+" 0 0 1 "+e+","+-e+"h"+(c-2*e)+"a"+e+","+e+" 0 0 1 "+e+","+e+"v"+(d-2*e)+"a"+e+","+e+" 0 0 1 "+-e+","+e+"h"+(2*e-c)+"a"+e+","+e+" 0 0 1 "+-e+","+-e+"v"+(2*e-d)+"z"},rb=function(a,b){var c=Math.pow(a[0]-b[0],2),d=Math.pow(a[1]-b[1],2),e=0;3===a.length&&3===b.length&&(e=Math.pow(a[2]-b[2],2));var f=Math.sqrt(c+d+e);return f},sb=function(a){var b=Math.pow(a[0],2),c=Math.pow(a[1],2),d=0;a.length>2&&(d=Math.pow(a[2],2));var e=Math.sqrt(b+c+d),f=[a[0]/e,a[1]/e];return a.length>2&&f.push(a[2]/e),f},tb=function(a,b){var c=a[0]*b[0],d=a[1]*b[1],e=0;return a.length>2&&b.length>2&&(e=a[2]*b[2]),c+d+e},ub=function(a,b){var c=a[0],d=a[1],e=a[2],f=b[0],g=b[1],h=b[2];return[d*h-e*g,e*f-c*h,c*g-d*f]},vb=function(a,b){var c=sb(a),d=sb(b),e=tb(c,d),f=Math.acos(e);return f/Math.PI*180},wb=function(a){return"mm"===a?1:"cm"===a?10:"m"===a?1e3:1},xb=function(a,b,c,d){var e=wb(a);2===d?e*=e:3===d&&(e=e*e*e);var f=wb(b);return 2===d?f*=f:3===d&&(f=f*f*f),c*e/f},yb=function(a,b){var c=a.x+a.width,d=a.y+a.height,e=b.x+b.width,f=b.y+b.height;return!(c<b.x||a.x>e||d<b.y||a.y>f)},zb=function(){return"undefined"!=typeof window&&"ontouchstart"in window},Ab=function(a){this.svg=a,this.maxPointsNeed=0,this.pickedPoints=[],this.svgGroup=ob(),this.svg.appendChild(this.svgGroup),this.unitOfModel=void 0,this.unitOnUI=void 0,this.precision=3,this.adjustOption=void 0,this.is3DMode=!1,this.isSelected=!1,this.onclickCallback=void 0};Ab.prototype.addPickedPoint=function(a,b,c){return!this.isDone()&&(!!a&&(this.pickedPoints.push(a),b&&(this.unitOfModel&&this.unitOfModel!==b?this.unitOfModel=void 0:this.unitOfModel=b),!0))},Ab.prototype.getAllPickedPoint=function(){return this.pickedPoints},Ab.prototype.draw=function(a,b){},Ab.prototype.adjustWithOption=function(a){this.adjustOption=a,a&&this.updateTexts()},Ab.prototype.unAdjustWithOption=function(a){this.adjustOption=void 0,this.updateTexts()},Ab.prototype.changeUnit=function(a){a&&(this.unitOnUI=a,this.updateTexts())},Ab.prototype.changePrecision=function(a){this.precision=a,a&&this.updateTexts()},Ab.prototype.updateTexts=function(){},Ab.prototype.isVisible=function(){return!!(this.svg&&this.svgGroup&&this.svgGroup.parentNode)},Ab.prototype.remove=function(){this.svg&&this.svgGroup&&this.svgGroup.parentNode&&(this.svg.removeChild(this.svgGroup),this.onclickCallback=void 0)},Ab.prototype.add=function(){this.svg&&this.svgGroup&&this.svg.appendChild(this.svgGroup)},Ab.prototype.isDone=function(){return this.pickedPoints.length===this.maxPointsNeed},Ab.prototype.setClickCallback=function(a){this.onclickCallback=a},Ab.prototype.measureResult=function(){},Ab.prototype.createCircle=function(){var a=lb(5);return a.setAttributeNS(null,"fill","#ff9800"),a.setAttributeNS(null,"stroke","#ffffff"),a.setAttributeNS(null,"stroke-width",2),a.style.display="none",a},Ab.prototype.createLine=function(){var a=jb();return a.setAttributeNS(null,"stroke-width",2),a.setAttributeNS(null,"stroke","#ffff00"),a.style.display="none",a},Ab.prototype.createText=function(){var a=mb();return a.style.fontSize="14",a.style.display="none",a.style.textAnchor="middle",a.setAttributeNS(null,"fill","#ffffff"),a},Ab.prototype.createPath=function(){var a=kb();return a.style.display="none",a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"stroke","#0aea06"),a},Ab.prototype.resultToDisplayOfLength=function(a){var b=a,c=this.unitOfModel;return this.adjustOption&&(b=this.adjustOption.adjustLength(a),c=this.adjustOption.unit),this.unitOnUI&&(c&&(b=xb(c,this.unitOnUI,b,0)),c=this.unitOnUI),c||(c=""),b=b.toFixed(this.precision),{value:Number(b),unit:c,text:b+c}},Ab.prototype.setSelected=function(a){return this.isSelected!==a&&(this.isSelected=a,!0)};var Bb=function(){this.group=ob(),this.group.style.display="none";var a=kb();this.textBackground=a,this.group.appendChild(a),a=kb(),this.prefixTextBackground=a,this.prefixTextBackground.style.display="none",this.group.appendChild(a);var b=mb();b.style.fontSize="12",b.style.textAnchor="middle",b.style.dominantBaseline="central",b.style.cursor="default",b.setAttributeNS(null,"fill","#ffffff"),this.group.appendChild(b),this.text=b,b=mb(),b.style.fontSize="12",b.style.textAnchor="middle",b.style.dominantBaseline="central",b.style.display="none",b.setAttributeNS(null,"fill","#ffffff"),this.group.appendChild(b),this.prefixText=b,this.textColor="#ffffff",this.prefixTextColor="#ffffff",this.textBackgroundColor="#ffffff",this.prefixTextBackgroundColor="blue",this.textContent=void 0,this.prefixTextContent=void 0,this.textPosition={x:0,y:0},this.isShowShadow=!1,this.onclickCallback=void 0,this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this)};Bb.prototype.draw=function(a){if(this.textContent&&this.textContent.length){this.group.style.display="",this.text.textContent=this.textContent;var b=null;this.prefixTextContent?(this.prefixText.textContent=this.prefixTextContent,this.prefixText.style.display="",b=this.prefixText.getBBox()):(this.prefixText.style.display="none",b={width:0,height:0});var c=5,d=this.text.getBBox(),e=c+d.width+c;this.prefixTextContent&&this.prefixTextContent.length>0&&(e=e+c+b.width+c),a&&(e=Math.max(a,e));var f=c+d.height+c,g=this.textPosition.x-e/2,h=this.textPosition.y-f/2,i=qb(g,h,e,d.height+2*c,5);this.textBackground.setAttributeNS(null,"d",i),this.textBackground.setAttributeNS(null,"fill",this.textBackgroundColor),this.isShowShadow?this.group.setAttributeNS(null,"filter","url(#drop-shadow)"):this.group.removeAttributeNS(null,"filter"),this.prefixTextContent&&this.prefixTextContent.length>0?(i=pb(g,h,b.width+2*c,b.height+2*c,5),this.prefixTextBackground.setAttributeNS(null,"d",i),this.prefixTextBackground.setAttributeNS(null,"fill",this.prefixTextBackgroundColor),this.prefixTextBackground.style.display="",this.prefixText.setAttributeNS(null,"x",g+c+b.width/2),this.prefixText.setAttributeNS(null,"y",h+c+b.height/2),g=g+(2*c+b.width)/2+e/2):g+=e/2,this.text.setAttributeNS(null,"x",g),this.text.setAttributeNS(null,"y",h+c+d.height/2),this.text.setAttributeNS(null,"fill",this.textColor),this.prefixText.setAttributeNS(null,"fill",this.prefixTextColor)}},Bb.prototype.setText=function(a,b){this.textContent=a,this.prefixTextContent=b},Bb.prototype.setPosition=function(a,b){this.textPosition={x:a,y:b}},Bb.prototype.hide=function(){this.group.style.display="none"},Bb.prototype.show=function(){this.group.style.display=""},Bb.prototype.setClickCallback=function(a){this.onclickCallback=a,a?(this.group.style.cursor="pointer",this.text.style.cursor="pointer",zb()?(this.group.addEventListener("touchstart",this._onMouseDown),this.group.addEventListener("touchend",this._onMouseUp),this.group.addEventListener("touchmove",this._onMouseMove)):(this.group.addEventListener("mousedown",this._onMouseDown),this.group.addEventListener("mouseup",this._onMouseUp),this.group.addEventListener("mousemove",this._onMouseMove))):(this.group.style.cursor="default",this.text.style.cursor="default",zb()?(this.group.removeEventListener("touchstart",this._onMouseDown),this.group.removeEventListener("touchend",this._onMouseUp),this.group.removeEventListener("touchmove",this._onMouseMove)):(this.group.removeEventListener("mousedown",this._onMouseDown),this.group.removeEventListener("mouseup",this._onMouseUp),this.group.removeEventListener("mousemove",this._onMouseMove)))},Bb.prototype._onMouseMove=function(a){a.stopPropagation(),a.preventDefault()},Bb.prototype._onMouseDown=function(a){a.stopPropagation(),a.preventDefault()},Bb.prototype._onMouseUp=function(a){a.stopPropagation(),a.preventDefault(),this.onclickCallback&&this.onclickCallback()};var Cb=function(a){Ab.call(this,a),this.maxPointsNeed=2,this.startCircle=this.createCircle(),this.startCircle.setAttributeNS(null,"fill","#ffffff"),this.endCircle=this.createCircle(),this.endCircle.setAttributeNS(null,"fill","#ffffff"),this.svgGroup.appendChild(this.startCircle),this.svgGroup.appendChild(this.endCircle),this.line=this.createLine(),this.line.setAttributeNS(null,"stroke","#ffffff"),this.line.setAttributeNS(null,"strokd-width",2),this.svgGroup.appendChild(this.line),this.text=new Bb,this.text.textBackgroundColor="#ffffff",this.text.textColor="#000000",this.svgGroup.appendChild(this.text.group),this._distance=void 0};Cb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Cb}),Cb.prototype.addPickedPoint=function(a,b,c){var d=Ab.prototype.addPickedPoint.call(this,a,b,c);d&&this.isDone()&&(this._enableSelect(),this._distance=rb(this.pickedPoints[0],this.pickedPoints[1]))},Cb.prototype.draw=function(a,b){if(this.svgGroup.parentNode){var c=this.pickedPoints;if(c.length>0){a&&!this.isDone()&&(c=c.concat([a]));var d=c;if(b){for(var e=[],f=0,g=c.length;f<g;f+=1)e[f]=b(c[f]);d=e}var h=d[0],i=d.length>1?d[1]:h;if(this.startCircle.setAttributeNS(null,"cx",h[0]),this.startCircle.setAttributeNS(null,"cy",h[1]),this.startCircle.style.display="",this.line.setAttributeNS(null,"x1",h[0]),this.line.setAttributeNS(null,"y1",h[1]),this.line.setAttributeNS(null,"x2",i[0]),this.line.setAttributeNS(null,"y2",i[1]),this.line.style.display="",this.text.setPosition((h[0]+i[0])/2,(h[1]+i[1])/2),c.length>1){var j=rb(c[0],c[1]);this._distance=j}2===this.pickedPoints.length?(this.endCircle.setAttributeNS(null,"cx",i[0]),this.endCircle.setAttributeNS(null,"cy",i[1]),this.endCircle.style.display=""):this.endCircle.style.display="none",this._updateText()}}},Cb.prototype.measureResult=function(){if(this.isDone()){var a={};if(a.distance=this._distance,this.adjustOption){var b=this.resultToDisplayOfLength(this._distance);a.unit=b.unit,a.value=b.value}return a}},Cb.prototype.adjustWithOption=function(a){Ab.prototype.adjustWithOption.call(this,a),this._updateText(),this._disableSelect()},Cb.prototype.changeUnit=function(a){Ab.prototype.changeUnit.call(this,a),a&&this._updateText()},Cb.prototype.changePrecision=function(a){Ab.prototype.changePrecision.call(this,a),a&&this._updateText()},Cb.prototype._enableSelect=function(){var a=this;this.startCircle.onmousedown=function(b){a.isDone()&&(a.pickedPoints=a.pickedPoints.slice(1),b.stopPropagation(),a._disableSelect())},this.endCircle.onmousedown=function(b){a.isDone()&&(a.pickedPoints=a.pickedPoints.slice(0,1),b.stopPropagation(),a._disableSelect())}},Cb.prototype._disableSelect=function(){this.startCircle.onmousedown=void 0,this.endCircle.onmousedown=void 0},Cb.prototype._updateText=function(){this.isDone()&&this._distance&&this.adjustOption&&(this.text.setText(this.resultToDisplayOfLength(this._distance).text),this.text.draw())};var Db=function(){this.unit=void 0,this.valueBeforeAdjust=void 0,this.valueAfterAdjust=void 0};Db.prototype.adjustLength=function(a){if(this.valueAfterAdjust&&this.valueBeforeAdjust){var b=a*this.valueAfterAdjust/this.valueBeforeAdjust;return b}return a},Db.prototype.adjustArea=function(a){if(this.valueAfterAdjust&&this.valueBeforeAdjust){var b=a*Math.pow(this.valueAfterAdjust/this.valueBeforeAdjust,2);return b}return a},Db.prototype.adjustVolume=function(a){if(this.valueAfterAdjust&&this.valueBeforeAdjust){var b=a*Math.pow(this.valueAfterAdjust/this.valueBeforeAdjust,3);return b}return a};var Eb=function(a){Ab.call(this,a),this.maxPointsNeed=3,this._angle=void 0,this.circle1=this.createCircle(),this.circle2=this.createCircle(),this.circle3=this.createCircle(),this.svgGroup.appendChild(this.circle1),this.svgGroup.appendChild(this.circle2),this.svgGroup.appendChild(this.circle3),this.line1=this.createLine(),this.line1.setAttributeNS(null,"stroke-width",2),this.svgGroup.appendChild(this.line1),this.line2=this.createLine(),this.line2.setAttributeNS(null,"stroke-width",2),this.svgGroup.appendChild(this.line2),this.arc=this.createPath(),this.svgGroup.appendChild(this.arc),this.angleText=new Bb,this.angleText.textBackgroundColor="#009bff",this.svgGroup.appendChild(this.angleText.group);var b=this;this.angleText.setClickCallback(function(){b.onclickCallback&&b.onclickCallback(b)})};Eb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Eb}),Eb.prototype.addPickedPoint=function(a,b,c){if(Ab.prototype.addPickedPoint.call(this,a,b,c)&&this.isDone()){var d=this.pickedPoints[0],e=this.pickedPoints[1],f=this.pickedPoints[2],g=[d[0]-e[0],d[1]-e[1],d[2]-e[2]],h=[f[0]-e[0],f[1]-e[1],f[2]-e[2]],i=vb(g,h);this._angle=i}},Eb.prototype.draw=function(a,b){if(this.svgGroup.parentNode){var c=this.pickedPoints;if(c.length>0){a&&!this.isDone()&&(c=c.concat([a]));var d=c;if(b){for(var e=[],f=0,g=c.length;f<g;f+=1)e[f]=b(c[f]);d=e}if(this.pickedPoints.length>=1){var h=d[0],i=d[1];this.circle1.setAttributeNS(null,"cx",h[0]),this.circle1.setAttributeNS(null,"cy",h[1]),this.circle1.style.display="",(a||this.pickedPoints.length>1)&&(this.line1.setAttributeNS(null,"x1",h[0]),this.line1.setAttributeNS(null,"y1",h[1]),this.line1.setAttributeNS(null,"x2",i[0]),this.line1.setAttributeNS(null,"y2",i[1]),this.line1.style.display="")}if(this.pickedPoints.length>=2){var j=d[1],k=d[2];this.circle2.setAttributeNS(null,"cx",j[0]),this.circle2.setAttributeNS(null,"cy",j[1]),this.circle2.style.display="",(a||this.pickedPoints.length>2)&&(this.line2.setAttributeNS(null,"x1",j[0]),this.line2.setAttributeNS(null,"y1",j[1]),this.line2.setAttributeNS(null,"x2",k[0]),this.line2.setAttributeNS(null,"y2",k[1]),this.line2.style.display="")}if(3===this.pickedPoints.length){var l=d[2];this.circle3.setAttributeNS(null,"cx",l[0]),this.circle3.setAttributeNS(null,"cy",l[1]),this.circle3.style.display="";var m=d[0].slice(0,2),n=d[1].slice(0,2),o=d[2].slice(0,2),p=rb(m,n),q=rb(n,o),r=Math.min(Math.min(p,q),30),s=[m[0]-n[0],m[1]-n[1]],t=sb(s),u=[n[0]+t[0]*r,n[1]+t[1]*r],v=[o[0]-n[0],o[1]-n[1]],w=sb(v),x=[n[0]+w[0]*r,n[1]+w[1]*r],y=[(u[0]+x[0])/2,(u[1]+x[1])/2],z=[y[0]-n[0],y[1]-n[1]];z=[1.5*z[0],1.5*z[1]];var A=[n[0]+z[0],n[1]+z[1]],B="M"+u[0]+","+u[1];B+="Q"+A[0]+","+A[1],B+=" "+x[0]+","+x[1],this.arc.setAttributeNS(null,"d",B),this.arc.style.display="",this.angleText.setText(this._angle.toFixed(this.precision)+"°"),this.angleText.setPosition(A[0],A[1]),this.angleText.draw()}}}},Eb.prototype.setSelected=function(a){Ab.prototype.setSelected.call(this,a)&&(a?(this.angleText.isShowShadow=!0,this.angleText.textBackgroundColor="#ffffff",this.angleText.textColor="#009bff",this.angleText.draw()):(this.angleText.isShowShadow=!1,this.angleText.textBackgroundColor="#009bff",this.angleText.textColor="#ffffff",this.angleText.draw()))},Eb.prototype.measureResult=function(){return this._angle};var Fb=function(a){Ab.call(this,a),this.path=kb(),this.path.setAttributeNS(null,"fill","none"),this.path.setAttributeNS(null,"stroke","rgb(69,195,69)"),this.svgGroup.appendChild(this.path),this._isDone=!1,this._circles=[],this._area=-1,this.resultText=new Bb,this.resultText.textBackgroundColor="#009bff",this.svgGroup.appendChild(this.resultText.group);var b=this;this.resultText.setClickCallback(function(){b.onclickCallback&&b.onclickCallback(b)})};Fb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Fb}),Fb.prototype.addPickedPoint=function(a,b,c){if(this._pointCanClosePath(a,c))this._isDone=!0,this.is3DMode?this._area=this._calculateArea3D():this._area=this._calculateArea2D();else if(Ab.prototype.addPickedPoint.call(this,a,b,c)){var d=this.createCircle();this.svgGroup.appendChild(d),this._circles.push(d)}},Fb.prototype.isDone=function(){return this._isDone},Fb.prototype.draw=function(a,b){if(this.svgGroup.parentNode){var c=this.pickedPoints;if(c.length>0){if(a&&!this.isDone()){if(this._pointCanClosePath(a,b)){var d=this.pickedPoints[0];a=[d[0],d[1],d[2]]}c=c.concat([a])}var e=c;if(b){for(var f=[],g=0,h=c.length;g<h;g+=1)f[g]=b(c[g]);e=f}var i=this._pathString(e);if(this.path.setAttributeNS(null,"d",i),this.isDone()){this.path.setAttributeNS(null,"fill","rgba(69,195,69,0.5)");var j=this._getPointsCenter(this.pickedPoints);b&&(j=b(j)),this.resultText.setPosition(j[0],j[1]),this.updateTexts()}for(var k=0,l=this._circles.length;k<l;k+=1){var m=this._circles[k],n=e[k];m.setAttributeNS(null,"cx",n[0]),m.setAttributeNS(null,"cy",n[1]),m.style.display=""}}}},Fb.prototype.measureResult=function(){return this._area},Fb.prototype.updateTexts=function(){this.isDone()&&(this.resultText.setText(this.resultToDisplayOfArea(this._area).text),this.resultText.draw())},Fb.prototype.setSelected=function(a){Ab.prototype.setSelected.call(this,a)&&(a?(this.resultText.isShowShadow=!0,this.resultText.textBackgroundColor="#ffffff",this.resultText.textColor="#009bff",this.resultText.draw()):(this.resultText.isShowShadow=!1,this.resultText.textBackgroundColor="#009bff",this.resultText.textColor="#ffffff",this.resultText.draw()))},Fb.prototype.resultToDisplayOfArea=function(a){var b=a,c=this.unitOfModel;return this.adjustOption&&(b=this.adjustOption.adjustArea(a),c=this.adjustOption.unit),this.unitOnUI&&(c&&(b=xb(c,this.unitOnUI,b,2)),c=this.unitOnUI),c||(c=""),b=b.toFixed(this.precision),"mm"===c?c="mm²":"m"===c?c="m²":"cm"===c&&(c="cm²"),{value:Number(b),unit:c,text:b+c}},Fb.prototype._pointCanClosePath=function(a,b){if(this.pickedPoints.length>0){var c=this.pickedPoints[0];b&&(c=b(c),a=b(a));var d=a[0]-c[0],e=a[1]-c[1],f=0;if(d*d+e*e+f*f<=200)return!0}return!1},Fb.prototype._pathString=function(a){if(!a||0===a.length)return"";for(var b="M"+a[0][0]+" "+a[0][1],c=1,d=a.length;c<d;c+=1)b=b+"L"+a[c][0]+" "+a[c][1];return this.isDone()&&(b+="Z"),b},Fb.prototype._calculateArea2D=function(){if(this.isDone()&&this.pickedPoints.length>=3){for(var a=this.pickedPoints,b=this.pickedPoints[0],c=[],d=1,e=a.length;d<e;d+=1)c.push([a[d][0]-b[0],a[d][1]-b[1]]);for(var f=0,g=0,h=c.length;g<h-1;g+=1){var i=c[g],j=c[g+1];f+=i[0]*j[1]-i[1]*j[0]}return Math.abs(f/2)}return 0},Fb.prototype._calculateArea3D=function(){if(this.isDone()&&this.pickedPoints.length>=3){for(var a=this.pickedPoints,b=this.pickedPoints[0],c=[this.pickedPoints[1][0]-b[0],this.pickedPoints[1][1]-b[1],this.pickedPoints[1][2]-b[2]],d=[this.pickedPoints[2][0]-b[0],this.pickedPoints[2][1]-b[1],this.pickedPoints[2][2]-b[2]],e=sb(ub(c,d)),f=0,g=1,h=a.length;g<h;g+=1){var i=[this.pickedPoints[g-1][0]-b[0],this.pickedPoints[g-1][1]-b[1],this.pickedPoints[g-1][2]-b[2]],j=[this.pickedPoints[g][0]-b[0],this.pickedPoints[g][1]-b[1],this.pickedPoints[g][2]-b[2]];f+=tb(ub(i,j),e)}return Math.abs(f/2)}return 0},Fb.prototype._getPointsCenter=function(a){var b=a.length,c=a.reduce(function(a,b){return a+b[0]},0)/b,d=a.reduce(function(a,b){return a+b[1]},0)/b,e=a.reduce(function(a,b){return a+b[2]},0)/b;return[c,d,e]},Fb.prototype._crossProduct=function(a,b){var c=a[0],d=a[1],e=a[2],f=b[0],g=b[1],h=b[2];return[d*h-e*g,e*f-c*h,c*g-d*f]};var Gb=function(a){Ab.call(this,a),this.maxPointsNeed=2,this._drawPoints=[],this.startCircle=this.createCircle(),this.endCircle=this.createCircle(),this.svgGroup.appendChild(this.startCircle),this.svgGroup.appendChild(this.endCircle),this.distanceLine=this.createLine(),this.svgGroup.appendChild(this.distanceLine),this.deltaXLine=this.createLine(),this.deltaXLine.setAttributeNS(null,"stroke","#ec4545"),this.deltaXLine.setAttributeNS(null,"stroke-dasharray","6,4"),this.svgGroup.appendChild(this.deltaXLine),this.deltaYLine=this.createLine(),this.deltaYLine.setAttributeNS(null,"stroke","#45c345"),this.deltaYLine.setAttributeNS(null,"stroke-dasharray","6,4"),this.svgGroup.appendChild(this.deltaYLine),this.deltaZLine=this.createLine(),this.deltaZLine.setAttributeNS(null,"stroke","#5757da"),this.deltaZLine.setAttributeNS(null,"stroke-dasharray","6,4"),this.svgGroup.appendChild(this.deltaZLine),this.deltaXText=new Bb,this.deltaXText.textColor="#ec4545",this.deltaXText.prefixTextBackgroundColor="#ec4545",this.svgGroup.appendChild(this.deltaXText.group),this.deltaYText=new Bb,this.deltaYText.textColor="#45c345",this.deltaYText.prefixTextBackgroundColor="#45c345",this.svgGroup.appendChild(this.deltaYText.group),this.deltaZText=new Bb,this.deltaZText.textColor="#5757da",this.deltaZText.prefixTextBackgroundColor="#5757da",this.svgGroup.appendChild(this.deltaZText.group),this.distanceText=new Bb,this.distanceText.textBackgroundColor="#009bff";var b=this;this.distanceText.setClickCallback(function(){b.onclickCallback&&b.onclickCallback(b)}),this.svgGroup.appendChild(this.distanceText.group),this._distance=void 0,this._deltaXDistance=void 0,this._deltaYDistance=void 0,this._deltaZDistance=void 0};Gb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Gb}),Gb.prototype.addPickedPoint=function(a,b,c){if(Ab.prototype.addPickedPoint.call(this,a,b,c)&&(this._drawPoints.push(a),this.isDone())){if(3===a.length){var d=[];d[0]=this.pickedPoints[1][0],d[1]=this.pickedPoints[0][1],d[2]=this.pickedPoints[1][2];var e=[];e[0]=this.pickedPoints[1][0],e[1]=this.pickedPoints[0][1],e[2]=this.pickedPoints[0][2],this._drawPoints.push(d),this._drawPoints.push(e)}this._distance=rb(this._drawPoints[0],this._drawPoints[1]),this._deltaYDistance=rb(this._drawPoints[1],this._drawPoints[2]),this._deltaZDistance=rb(this._drawPoints[2],this._drawPoints[3]),this._deltaXDistance=rb(this._drawPoints[3],this._drawPoints[0]),this.updateTexts()}},Gb.prototype.draw=function(a,b){if(this.svgGroup.parentNode){var c=this._drawPoints;if(c.length>0){a&&!this.isDone()&&(c=c.concat([a]));var d=c;if(b){for(var e=[],f=0,g=c.length;f<g;f+=1)e[f]=b(c[f]);d=e}var h=d[0],i=d.length>1?d[1]:h;if(this.startCircle.setAttributeNS(null,"cx",h[0]),this.startCircle.setAttributeNS(null,"cy",h[1]),this.startCircle.style.display="",this.distanceLine.setAttributeNS(null,"x1",h[0]),this.distanceLine.setAttributeNS(null,"y1",h[1]),this.distanceLine.setAttributeNS(null,"x2",i[0]),this.distanceLine.setAttributeNS(null,"y2",i[1]),this.distanceLine.style.display="",c.length<2)return;if(this.distanceText.setPosition((h[0]+i[0])/2,(h[1]+i[1])/2),!this.isDone()){var j=rb(c[0],c[1]);this._distance=j}if(4===c.length){this.isSelected?(this.distanceText.isShowShadow=!0,this.distanceText.textBackgroundColor="#ffffff",this.distanceText.textColor="#009bff"):(this.distanceText.isShowShadow=!1,this.distanceText.textBackgroundColor="#009bff",this.distanceText.textColor="#ffffff"),this.distanceText.draw(),this.endCircle.style.display="",this.deltaYLine.style.display="",this.deltaXLine.style.display="",this.deltaZLine.style.display="",this.endCircle.setAttributeNS(null,"cx",i[0]),this.endCircle.setAttributeNS(null,"cy",i[1]);var k=d[2],l=d[3];this.deltaYLine.setAttributeNS(null,"x1",i[0]),this.deltaYLine.setAttributeNS(null,"y1",i[1]),this.deltaYLine.setAttributeNS(null,"x2",k[0]),this.deltaYLine.setAttributeNS(null,"y2",k[1]),this.deltaYText.setPosition((k[0]+i[0])/2,(k[1]+i[1])/2),this.deltaZLine.setAttributeNS(null,"x1",k[0]),this.deltaZLine.setAttributeNS(null,"y1",k[1]),this.deltaZLine.setAttributeNS(null,"x2",l[0]),this.deltaZLine.setAttributeNS(null,"y2",l[1]),this.deltaZText.setPosition((k[0]+l[0])/2,(k[1]+l[1])/2),this.deltaXLine.setAttributeNS(null,"x1",l[0]),this.deltaXLine.setAttributeNS(null,"y1",l[1]),this.deltaXLine.setAttributeNS(null,"x2",h[0]),this.deltaXLine.setAttributeNS(null,"y2",h[1]),this.deltaXText.setPosition((l[0]+h[0])/2,(l[1]+h[1])/2),this.isSelected&&(this.deltaXText.draw(),this.deltaYText.draw(),this.deltaZText.draw(),this.layoutResultText())}}}},Gb.prototype.layoutResultText=function(){for(var a=this.distanceText.group.getBBox(),b=this.deltaXText.group.getBBox(),c=this.deltaYText.group.getBBox(),d=this.deltaZText.group.getBBox(),e=[b,c,d],f=!1,g=0;g<e.length;g+=1)if(yb(a,e[g])){f=!0;break}if(f||(f=yb(b,c)),f||(f=yb(b,d)),f||(f=yb(c,d)),f){var h=Math.max(a.width,b.width,c.width,d.width),i=a.x+a.width/2,j=a.y+a.height+8;return this.deltaXText.setPosition(i,j+b.height/2),j+=b.height,this.deltaYText.setPosition(i,j+c.height/2),j+=c.height,this.deltaZText.setPosition(i,j+d.height/2),this.deltaXText.draw(h),this.deltaYText.draw(h),this.deltaZText.draw(h),this.distanceText.draw(h),f}},Gb.prototype.measureResult=function(){if(this._distance)return[this._distance,this._deltaXDistance,this._deltaYDistance,this._deltaZDistance];
},Gb.prototype.updateTexts=function(){this._distance&&(this.distanceText.setText(this.resultToDisplayOfLength(this._distance).text,void 0),this.distanceText.draw(),this.isDone()&&(0!==this._deltaXDistance&&this.deltaXText.setText(this.resultToDisplayOfLength(this._deltaXDistance).text,"X"),0!==this._deltaYDistance&&this.deltaYText.setText(this.resultToDisplayOfLength(this._deltaYDistance).text,"Y"),0!==this._deltaZDistance&&this.deltaZText.setText(this.resultToDisplayOfLength(this._deltaZDistance).text,"Z"),this.isSelected&&(this.deltaXText.draw(),this.deltaYText.draw(),this.deltaZText.draw())))},Gb.prototype.setSelected=function(a){Ab.prototype.setSelected.call(this,a)&&(a?(this.distanceText.isShowShadow=!0,this.distanceText.textBackgroundColor="#ffffff",this.distanceText.textColor="#009bff",this.deltaXText.draw(),this.deltaYText.draw(),this.deltaZText.draw(),this.distanceText.draw(),this.layoutResultText()):(this.deltaXText.hide(),this.deltaYText.hide(),this.deltaZText.hide(),this.distanceText.isShowShadow=!1,this.distanceText.textBackgroundColor="#009bff",this.distanceText.textColor="#ffffff",this.distanceText.draw()))};var Hb=function(a){Ab.call(this,a),this.maxPointsNeed=2,this.startCircle=this.createCircle(),this.endCircle=this.createCircle(),this.svgGroup.appendChild(this.startCircle),this.svgGroup.appendChild(this.endCircle),this.distanceLine=this.createLine(),this.svgGroup.appendChild(this.distanceLine),this.distanceText=new Bb,this.distanceText.textBackgroundColor="#009bff",this.svgGroup.appendChild(this.distanceText.group);var b=this;this.distanceText.setClickCallback(function(){b.onclickCallback&&b.onclickCallback(b)}),this.pickedComponentKeys=[],this._distance=void 0};Hb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Hb}),Hb.prototype.setData=function(a,b,c){this.pickedPoints=a,this._distance=b,c&&(this.unitOfModel&&this.unitOfModel!==c?this.unitOfModel=void 0:this.unitOfModel=c)},Hb.prototype.draw=function(a,b){if(this.svgGroup.parentNode&&this.isDone()){var c=this.pickedPoints;if(b){for(var d=[],e=0,f=c.length;e<f;e+=1)d[e]=b(c[e]);c=d}var g=c[0],h=c[1];this.startCircle.setAttributeNS(null,"cx",g[0]),this.startCircle.setAttributeNS(null,"cy",g[1]),this.startCircle.style.display="",this.endCircle.setAttributeNS(null,"cx",h[0]),this.endCircle.setAttributeNS(null,"cy",h[1]),this.endCircle.style.display="",this.distanceLine.setAttributeNS(null,"x1",g[0]),this.distanceLine.setAttributeNS(null,"y1",g[1]),this.distanceLine.setAttributeNS(null,"x2",h[0]),this.distanceLine.setAttributeNS(null,"y2",h[1]),this.distanceLine.style.display="",this.distanceText.setPosition((g[0]+h[0])/2,(g[1]+h[1])/2),this.updateTexts()}},Hb.prototype.measureResult=function(){if(void 0!==this._distance)return this._distance},Hb.prototype.updateTexts=function(){void 0!==this._distance&&(this.distanceText.setText(this.resultToDisplayOfLength(this._distance).text,void 0),this.distanceText.draw())},Hb.prototype.setSelected=function(a){Ab.prototype.setSelected.call(this,a)&&(a?(this.distanceText.isShowShadow=!0,this.distanceText.textBackgroundColor="#ffffff",this.distanceText.textColor="#009bff",this.distanceText.draw()):(this.distanceText.isShowShadow=!1,this.distanceText.textBackgroundColor="#009bff",this.distanceText.textColor="#ffffff",this.distanceText.draw()))};var Ib=function(a){Ab.call(this,a),this.maxPointsNeed=2;var b=jb();b.setAttributeNS(null,"stroke-width","2"),b.setAttributeNS(null,"stroke","#0aea06"),this.svgGroup.appendChild(b),this._line=b,this.distanceText=new Bb,this.distanceText.textBackgroundColor="#009bff",this.svgGroup.appendChild(this.distanceText.group)};Ib.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Ib}),Ib.prototype.setData=function(a,b){a&&b&&(this._points=[a,b])},Ib.prototype.draw=function(a,b){if(2===this._points.length){var c=b(this._points[0]),d=b(this._points[1]);this._line.setAttributeNS(null,"x1",c[0]),this._line.setAttributeNS(null,"y1",c[1]),this._line.setAttributeNS(null,"x2",d[0]),this._line.setAttributeNS(null,"y2",d[1]),this.distanceText.setPosition((c[0]+d[0])/2,(c[1]+d[1])/2);var e=rb(this._points[0],this._points[1]);this.distanceText.setText(this.resultToDisplayOfLength(e).text,void 0),this.distanceText.draw()}},Object.assign(z.prototype,{isPlane:!0,set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(){var a=new t,b=new t;return function(c,d,e){var f=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();return this.setFromNormalAndCoplanarPoint(f,c),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return void 0===b&&(console.warn("THREE.Plane: .projectPoint() target is now required"),b=new t),b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new t;return function(b,c){void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new t);var d=b.delta(a),e=this.normal.dot(d);if(0!==e){var f=-(b.start.dot(this.normal)+this.constant)/e;if(!(f<0||f>1))return c.copy(d).multiplyScalar(f).add(b.start)}else if(0===this.distanceToPoint(b.start))return c.copy(b.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new t),a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new t,b=new Ra;return function(c,d){var e=d||b.getNormalMatrix(c),f=this.coplanarPoint(a).applyMatrix4(c),g=this.normal.applyMatrix3(e).normalize();return this.constant=-f.dot(g),this}}(),translate:function(a){return this.constant-=a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});var Jb=function(a,b){this._point=void 0,this._normal=void 0,this.viewer=b,this.svg=a;var c=nb();c.setAttribute("fill","rgba(10,234,6,0.2)"),c.setAttribute("stroke","#0aea06"),c.setAttribute("stroke-width",1),c.style.pointerEvents="none",this._panel=c,this.hoverPanelSize={width:20,height:20}};Jb.prototype.setupWithPoint=function(a,b){this._point=a,this._normal=b},Jb.prototype.remove=function(){this.svg&&this._panel.parentNode&&this.svg.removeChild(this._panel)},Jb.prototype.add=function(){this.svg&&this._panel&&this.svg.appendChild(this._panel)},Jb.prototype.isVisible=function(){return!!this._panel.parentNode},Jb.prototype.stretchOnDirection=function(a,b,c){var d=a.clone().add(b).multiplyScalar(.5),e=b.clone().sub(a).normalize(),f=d.clone().sub(e.clone().multiplyScalar(c/2)),g=d.clone().add(e.clone().multiplyScalar(c/2));return[f,g]},Jb.prototype.draw=function(){var a=this.viewer.getScene().worldToDrawing(this._normal);a.normalize();var b=this.viewer.worldToClient(this._point),c=this.viewer.getScene().worldToDrawing(this._point),d=this.viewer.cameraControl,e=20,f=new z;f.setFromNormalAndCoplanarPoint(a,c);var g=new B(b.x-e/2,b.y-e/2),h=new B(b.x+e/2,b.y-e/2),i=c,j=d.getRaycaster(g.x,g.y),k=new t,l=new t;if(j.ray.intersectPlane(f,k),j=d.getRaycaster(h.x,h.y),j.ray.intersectPlane(f,l),null!==k&&null!==l){var m=new t(1,0,0),n=new t(0,0,1),o=new t(0,1,0),p=Math.abs(a.clone().dot(m))<=.0025,q=Math.abs(a.clone().dot(o))<=.0025;if(p&&q)var r=m.clone(),s=o.clone();else var u=n.clone(),r=u.cross(a).normalize(),s=a.clone().cross(r).normalize();var v=k.distanceTo(l)/2,w=r.clone().multiplyScalar(v),x=s.clone().multiplyScalar(v),y=i.clone().sub(w).add(x),A=i.clone().add(w).add(x),C=i.clone().sub(w).sub(x),D=i.clone().add(w).sub(x),E=[];E.push(y,A,D,C);for(var F=[],G=d.getContainerDimensions(),H=0;H<E.length;H+=1){var I=new t(E[H].x,E[H].y,E[H].z);I.project(d.camera);var J={x:0,y:0,z:0};J.x=Math.floor(.5*(I.x+1)*G.width+.5),J.y=Math.floor(-.5*(I.y-1)*G.height+.5),J.z=I.z||0,F.push(new t(J.x,J.y,0))}var K=this.hoverPanelSize,L=F[0].distanceTo(F[1]),M=F[0].distanceTo(F[3]),N=L/K.width,O=M/K.height;if(1!==N){var P=this.stretchOnDirection(F[0],F[1],K.width),Q=this.stretchOnDirection(F[2],F[3],K.width);F=P.concat(Q)}if(1!==O){var P=this.stretchOnDirection(F[0],F[3],K.height),Q=this.stretchOnDirection(F[1],F[2],K.height);F=[P[0],Q[0],Q[1],P[1]]}for(var R="",S=0;S<F.length;S+=1)R+=F[S].x+",",R+=F[S].y+" ";this._panel.setAttribute("points",R)}};var Kb=function(a){this._point=void 0,this.svg=a;var b=lb(5);b.setAttributeNS(null,"fill","#00ff00"),this._circle=b};Kb.prototype.setupWithPoint=function(a){a&&(this._point=a)},Kb.prototype.remove=function(){this.svg&&this._circle.parentNode&&this.svg.removeChild(this._circle)},Kb.prototype.add=function(){this.svg&&this._circle&&this.svg.appendChild(this._circle)},Kb.prototype.isVisible=function(){return!!this._circle.parentNode},Kb.prototype.draw=function(a){if(this._point){var b=a(this._point);this._circle.setAttributeNS(null,"cx",b[0]),this._circle.setAttributeNS(null,"cy",b[1])}};var Lb=function(a){Ab.call(this,a),this.volumeText=new Bb,this.volumeText.textBackgroundColor="#009bff",this.svgGroup.appendChild(this.volumeText.group);var b=this;this.volumeText.setClickCallback(function(){b.onclickCallback&&b.onclickCallback(b)}),this.pickedComponentKeys=[],this._position=void 0,this._volume=void 0};Lb.prototype=Object.assign(Object.create(Ab.prototype),{constructor:Lb}),Lb.prototype.setData=function(a,b,c){this._position=a,this._volume=b,c&&(this.unitOfModel&&this.unitOfModel!==c?this.unitOfModel=void 0:this.unitOfModel=c)},Lb.prototype.isDone=function(){return this.pickedComponentKeys[0]&&this._position&&this._volume},Lb.prototype.draw=function(a,b){if(this.svgGroup.parentNode&&this.isDone()){var c=this._position;b&&(c=b(c)),this.volumeText.setPosition(c[0],c[1]),this.updateTexts()}},Lb.prototype.measureResult=function(){if(this._volume)return this._volume},Lb.prototype.resultToDisplayOfVolume=function(a){var b=a,c=this.unitOfModel;return this.adjustOption&&(b=this.adjustOption.adjustVolume(a),c=this.adjustOption.unit),this.unitOnUI&&(c&&(b=xb(c,this.unitOnUI,b,3)),c=this.unitOnUI),c||(c=""),b=b.toFixed(this.precision),"mm"===c?c="mm³":"m"===c?c="m³":"cm"===c&&(c="cm³"),{value:Number(b),unit:c,text:b+c}},Lb.prototype.updateTexts=function(){this._volume&&(this.volumeText.setText(this.resultToDisplayOfVolume(this._volume).text,void 0),this.volumeText.draw())},Lb.prototype.setSelected=function(a){Ab.prototype.setSelected.call(this,a)&&(a?(this.volumeText.isShowShadow=!0,this.volumeText.textBackgroundColor="#ffffff",this.volumeText.textColor="#009bff",this.volumeText.draw()):(this.volumeText.isShowShadow=!1,this.volumeText.textBackgroundColor="#009bff",this.volumeText.textColor="#ffffff",this.volumeText.draw()))};var Mb=function(){this.pointTransformer=void 0,this.parentDom=void 0,this.viewer=void 0,this.is3DMode=!1},Nb={Distance:"Distance",Angle:"Angle",Adjust:"Adjust",Area:"Area",MinDistance:"MinDistance",Volume:"Volume"},Ob=function(a){this.config=a,this.config.viewer.measure=this,this.svg=this._createSVG(a.parentDom.clientWidth,a.parentDom.clientHeight),a.parentDom.appendChild(this.svg),this._resize=this._resize.bind(this),this.config.viewer.addEventListener("resize",this._resize),this.setCurrentMode(Nb.Distance),this.isOpen=!1,this.didEndMeasureCallback=void 0,this._items=[],this._adjustItem=void 0,this._adjustOption=void 0,this._precision=3,this._unitSetByUser=void 0,this._pickedLine=void 0,this._pickedPoint=void 0,this._pickedPanel=void 0,this._selectedItem=void 0,this.open()};Ob.prototype.supportUnits=function(){return[{unit:"m",title:"米"},{unit:"cm",title:"厘米"},{unit:"mm",title:"毫米"}]},Ob.prototype.open=function(){this.isOpen||(this.isOpen=!0,this._handleKeyUp=this._handleKeyUp.bind(this),document.addEventListener("keyup",this._handleKeyUp))},Ob.prototype.close=function(){var a=this.svg.parentNode;a.removeChild(this.svg),this.isOpen=!1,this.config.is3DMode&&(this.config.viewer.clearSelection(),this.config.viewer.render()),this.config.viewer.measure=void 0,document.removeEventListener("keyup",this._handleKeyUp),this.config.viewer.removeEventListener("resize",this._resize)},Ob.prototype.setCurrentMode=function(a){if(this.config.is3DMode||a!==Nb.Volume&&a!==Nb.MinDistance)if(this._currentMode!==a&&(this._currentMode=a,this._currentMeasureItem&&(this._currentMeasureItem instanceof Hb&&this.config.is3DMode&&(this.config.viewer.clearSelection(),this.config.viewer.render()),this._currentMeasureItem.remove(),this._currentMeasureItem=void 0)),this._currentMode===Nb.Adjust){var b=this._adjustItem?this._adjustItem:this._currentMeasureItem;(b||b instanceof Cb)&&b.isDone()&&(b.add(),b.draw(void 0,this.config.pointTransformer),this.didEndMeasureCallback&&this.didEndMeasureCallback(b.measureResult()))}else this._adjustItem&&this._adjustItem.remove()},Ob.prototype.getCurrentMode=function(){return this._currentMode},Ob.prototype.getCurrentUnit=function(){return this._unitSetByUser},Ob.prototype.setUnit=function(a){if(a&&this._unitSetByUser!==a){this._unitSetByUser=a;for(var b=0,c=this._items.length;b<c;b+=1){var d=this._items[b];d.changeUnit(a)}this._adjustOption&&(this._adjustOption.valueAfterAdjust=xb(this._adjustOption.unit,a,this._adjustOption.valueAfterAdjust,0),this._adjustOption.unit=a)}},Ob.prototype.getCurrentPrecision=function(){return this._precision},Ob.prototype.setPrecision=function(a){if(a&&this._precision!==a){this._precision=a;for(var b=0,c=this._items.length;b<c;b+=1){var d=this._items[b];d.changePrecision(a)}this._adjustItem&&this._adjustItem.changePrecision(a)}},Ob.prototype.clearAllMeasure=function(){for(var a=0,b=this._items.length;a<b;a+=1){var c=this._items[a];c.remove()}this._items=[],this._selectedItem=void 0},Ob.prototype.removeSelectedMeasure=function(){if(this._selectedItem){for(var a=0,b=this._items.length;a<b;a+=1)if(this._items[a]===this._selectedItem){this._selectedItem.remove(),this._items.splice(a,1);break}(this._selectedItem instanceof Lb||this._selectedItem instanceof Hb)&&this.config.is3DMode&&(this.config.viewer.clearSelection(),this.config.viewer.render()),this._selectedItem=void 0,this._items.length>0&&(this._selectedItem=this._items[this._items.length-1],this._selectedItem.setSelected(!0))}},Ob.prototype.setAdjustForCurrentAdjustItem=function(a,b){if(a&&b&&this._currentMode===Nb.Adjust&&(this._currentMeasureItem&&this._currentMeasureItem instanceof Cb&&this._currentMeasureItem.isDone()&&(this._adjustItem&&this._adjustItem.remove(),this._adjustItem=this._currentMeasureItem,this._currentMeasureItem=void 0),this._adjustItem&&this._adjustItem.isDone())){var c=new Db;c.unit=a,c.valueBeforeAdjust=this._adjustItem.measureResult().distance,c.valueAfterAdjust=b,this._adjustOption=c;for(var d=0,e=this._items.length;d<e;d+=1){var f=this._items[d];f.adjustWithOption(this._adjustOption)}this._adjustItem.adjustWithOption(this._adjustOption)}},Ob.prototype.cancelCurrentAdjust=function(){if(this._adjustItem&&(this._adjustItem.remove(),this._adjustItem=void 0),this._currentMeasureItem instanceof Cb&&(this._currentMeasureItem.remove(),this._currentMeasureItem=void 0),this._adjustOption){for(var a=0,b=this._items.length;a<b;a+=1){var c=this._items[a];c.unAdjustWithOption(this._adjustOption)}this._adjustOption=void 0}},Ob.prototype.cancelCurrentMeasure=function(){!this._currentMeasureItem||this._currentMeasureItem instanceof Cb||(this._currentMeasureItem.remove(),this._currentMeasureItem=void 0)},Ob.prototype.processIntersect=function(a){if(this.isOpen){if(!a)return this._hidePickedLine(),void this._hidePickedPoint();if(a.pickPoint){var b=[a.pickPoint.x,a.pickPoint.y,void 0===a.pickPoint.z?0:a.pickPoint.z],c=b;if(a.pick){if(this._currentMode===Nb.Adjust&&this._currentMeasureItem&&this._currentMeasureItem.isDone()&&(this._currentMeasureItem.remove(),this._currentMeasureItem=void 0),this._currentMeasureItem||this._createNewItem(),!this._currentMeasureItem)return;if(this._currentMeasureItem instanceof Hb){var d=this._currentMeasureItem.pickedComponentKeys;if(d.push(a.userId),2===d.length){var e=this.config.viewer.calculateMinDistance(d[0],d[1]);if(e&&e.start&&e.end){var f=[e.start.x,e.start.y,e.start.z],g=[e.end.x,e.end.y,e.end.z];this._currentMeasureItem.setData([f,g],e.minDistance,a.measureUnit),this._currentMeasureItem.draw(void 0,this.config.pointTransformer)}else this._currentMeasureItem=void 0}this.config.viewer.addToSelection(d),this.config.viewer.render()}else if(this._currentMeasureItem instanceof Lb){var h=this._currentMeasureItem.pickedComponentKeys;if(0===h.length){h.push(a.userId);var i=this.config.viewer.calculateComponentVolume(h[0]);i&&(this._currentMeasureItem.setData(i.position,i.volume,a.measureUnit),this._currentMeasureItem.draw(void 0,this.config.pointTransformer)),this.config.viewer.addToSelection(h),this.config.viewer.render()}}else c=void 0,this._currentMeasureItem.addPickedPoint(b,a.measureUnit,this.config.pointTransformer),this._currentMeasureItem.draw(c,this.config.pointTransformer);if(this._currentMeasureItem&&this._currentMeasureItem.isDone()){this._currentMeasureItem instanceof Cb||!this._adjustOption||this._currentMeasureItem.adjustWithOption(this._adjustOption);var j=this._currentMeasureItem.measureResult();this._currentMeasureItem instanceof Cb||(this._items.push(this._currentMeasureItem),this._selectedItem&&(this._selectedItem.setSelected(!1),this._selectedItem=void 0),this._selectedItem=this._currentMeasureItem,this._selectedItem.setSelected(!0),this._currentMeasureItem=void 0),this.didEndMeasureCallback&&this.didEndMeasureCallback(j)}}else this._currentMeasureItem&&this._currentMeasureItem.draw(c,this.config.pointTransformer)}this._currentMode!==Nb.MinDistance&&this._currentMode!==Nb.Volume&&(a.pickPoint&&a.isAbsorbPoint?this._showPickedPoint(a.pickPoint):this._hidePickedPoint(),a.pickPlane?this._showPickedPanel(a.pickPoint,a.normal):this._hidePickedPanel(),a.pickLine?this._showPickedLine(a.pickLine[0],a.pickLine[1],a.measureUnit):this._hidePickedLine())}},Ob.prototype.update=function(){if(this.isOpen){for(var a=0,b=this._items.length;a<b;a+=1){var c=this._items[a];c.draw(void 0,this.config.pointTransformer)}this._currentMeasureItem&&this._currentMeasureItem.draw(void 0,this.config.pointTransformer),this._adjustItem&&this._adjustItem.draw(void 0,this.config.pointTransformer),this._pickedLine&&this._pickedLine.isVisible()&&this._pickedLine.draw(void 0,this.config.pointTransformer),this._pickedPanel&&this._pickedPanel.isVisible()&&this._pickedPanel.draw(this.config.pointTransformer)}},Ob.prototype.changeSelect=function(){for(var a=0,b=this._items.length;a<b;a+=1){var c=this._items[a];c.setSelected(this._selectedItem===c)}},Ob.prototype._resize=function(){this.svg.style.width=this.config.parentDom.clientWidth,this.svg.style.height=this.config.parentDom.clientHeight},Ob.prototype._createNewItem=function(){switch(this._currentMode){case Nb.Distance:this._currentMeasureItem=new Gb(this.svg);break;case Nb.Angle:this._currentMeasureItem=new Eb(this.svg);break;case Nb.Adjust:this._currentMeasureItem=new Cb(this.svg);break;case Nb.Area:this._currentMeasureItem=new Fb(this.svg);break;case Nb.MinDistance:this._currentMeasureItem=new Hb(this.svg);break;case Nb.Volume:this._currentMeasureItem=new Lb(this.svg)}if(this._currentMeasureItem){this._currentMeasureItem.is3DMode=this.config.is3DMode,this._currentMeasureItem instanceof Cb||(this._adjustOption&&this._currentMeasureItem.adjustWithOption(this._adjustOption),this._unitSetByUser&&this._currentMeasureItem.changeUnit(this._unitSetByUser)),this._currentMeasureItem.changePrecision(this._precision);var a=this;this._currentMeasureItem.setClickCallback(function(b){b.isDone()&&(a._selectedItem=b,a.changeSelect())})}},Ob.prototype._showPickedLine=function(a,b,c){var d=[a.x,a.y,void 0===a.z?0:a.z],e=[b.x,b.y,void 0===b.z?0:b.z];this._pickedLine||(this._pickedLine=new Ib(this.svg),this._pickedLine.unitOfModel=c),this._adjustOption&&this._pickedLine.adjustWithOption(this._adjustOption),this._pickedLine.changeUnit(this._unitSetByUser?this._unitSetByUser:c),this._pickedLine.changePrecision(this._precision),this._pickedLine.add(),this._pickedLine.setData(d,e),this._pickedLine.draw(void 0,this.config.pointTransformer)},Ob.prototype._hidePickedLine=function(){this._pickedLine&&this._pickedLine.remove()},Ob.prototype._showPickedPoint=function(a){this._pickedPoint||(this._pickedPoint=new Kb(this.svg)),this._pickedPoint.add(),this._pickedPoint.setupWithPoint(a),this._pickedPoint.draw(this.config.pointTransformer)},Ob.prototype._hidePickedPoint=function(){this._pickedPoint&&this._pickedPoint.remove()},Ob.prototype._showPickedPanel=function(a,b){this._pickedPanel||(this._pickedPanel=new Jb(this.svg,this.config.viewer)),this._pickedPanel.add(),this._pickedPanel.setupWithPoint(a,b),this._pickedPanel.draw(this.config.pointTransformer)},Ob.prototype._hidePickedPanel=function(){this._pickedPanel&&this._pickedPanel.remove()},Ob.prototype._createSVG=function(a,b){var c=ib();return c.style.width=a+"px",c.style.height=b+"px",c.style.position="absolute",c.style.left="0",c.style.top="0",c},Ob.prototype._handleKeyUp=function(a){var b=a.keyCode;27===b?this.cancelCurrentMeasure():46===b&&this.removeSelectedMeasure()};var Pb=function(a){db.call(this,ea.PICK_BY_MEASURE),this.controlManager=a.controlManager,this.pickHelper=new fb(a.cameraControl),this.mouseDown=new B,this.lastEvent=null,this.pick=!1,this.pickPoint=new B;var b=a.canvas.parentElement,c=new Mb;c.parentDom=b,c.pointTransformer=a.getScreenCoordFromSceneCoord.bind(a),c.viewer=a,this.measure=new Ob(c);var d=this;a.cameraControl.addEventListener(ga.ON_CAMERA_CHANGE,function(){d.measure.update()})};Pb.prototype=Object.create(db.prototype),Pb.prototype.constructor=Pb,Pb.prototype.processMouseDown=function(a){return!!Aa.isMobileDevice()||(a.button===ca.LEFT?(this.mouseDown.x=a.clientX,this.mouseDown.y=a.clientY,!1):db.prototype.processMouseDown.call(this,a))},Pb.prototype.processMouseMove=function(a){return!1},Pb.prototype.processMouseUp=function(a){if(Aa.isMobileDevice())return!0;if(a.button===ca.LEFT){var b=2,c=new B(a.clientX,a.clientY).distanceTo(this.mouseDown);if(c<=b){var d=this.pickPoint.clone(),e=void 0;return e=a.shiftKey?this.pickHelper.handleShiftMeasure(a,!0,d):this.pickHelper.handleMouseMeasure(a,!0,d),this.measure.processIntersect(e),d.equals(this.pickPoint)||(this.pick=!this.pick,this.pickPoint.copy(d)),this.controlManager.isUpdateRenderList=!0,!0}return!0}return db.prototype.processMouseUp.call(this,a)},Pb.prototype.processHover=function(a){if(Aa.isMobileDevice())return!0;var b=void 0;return b=a.shiftKey?this.pickHelper.handleShiftMeasure(a,!1,this.pickPoint):this.pickHelper.handleMouseMeasure(a,!1,this.pickPoint),this.measure.processIntersect(b),!0},Pb.prototype.processTouchstart=function(a){return this.mouseDown.x=a.touches[0].clientX,this.mouseDown.y=a.touches[0].clientY,a.clientX=a.touches[0].clientX,a.clientY=a.touches[0].clientY,this.lastEvent=a,db.prototype.processTouchstart.call(this,a)},Pb.prototype.processTouchmove=function(a){return this.lastEvent=null,db.prototype.processTouchmove.call(this,a)},Pb.prototype.processTouchend=function(a){return null!==this.lastEvent&&(this.pickHelper.handleMouseMeasure(this.lastEvent,!0,this.pickPoint),this.controlManager.isUpdateRenderList=!0),db.prototype.processTouchend.call(this,a)},Pb.prototype.touchPointMove=function(a){this.measure.processIntersect(this.pickHelper.handleMouseMeasure(a,!1,this.pickPoint))},Pb.prototype.touchPointEnd=function(a){var b=this.pickPoint.clone(),c=this.pickHelper.handleMouseMeasure(a,!0,b);return this.measure.processIntersect(c),b.equals(this.pickPoint)||(this.pick=!this.pick,this.pickPoint.copy(b)),this.controlManager.isUpdateRenderList=!0,!0},Pb.prototype.onExit=function(a){this.measure.close()};var Qb=function(a,b,c,d,e){this.name=a,this.scene=c,this.cameraControl=b,this.domElement=void 0!==d&&null!==d?d:document,this.rendererDomElement=e,this.mouseButtons={ORBIT:ca.LEFT,PAN2:ca.MIDDLE,PAN:ca.RIGHT},this.StateType={NONE:-1,ROTATE:0,DOLLY:1,PAN:2},this.state=this.StateType.NONE,this.zoomSpeed=Math.pow(.95,.2),this.defaultMovementSpeed=.005*Z.SceneSize,this.movementSpeed=this.defaultMovementSpeed,this.minMovementSpeed=.001,this.defaultKeyPanSpeed=2,this.keyPanSpeed=this.defaultKeyPanSpeed,this.minKeyPanSpeed=.01,this.wheelZoomFactor=45e-5};Qb.prototype.getName=function(){return this.name},Qb.prototype.destroy=function(){this.scene=null,this.domElement=null,this.cameraControl=null,this.mouseButtons=null},Qb.prototype.onExit=function(){},Qb.prototype.onEnter=function(){},Qb.prototype.processMouseDown=function(a){},Qb.processMouseMove=function(a){},Qb.prototype.processMouseUp=function(a){},Qb.prototype.processMouseWheel=function(a){},Qb.prototype.processMouseDoubleClick=function(a){},Qb.prototype.processKeyDown=function(a){},Qb.prototype.processKeyUp=function(a){},Qb.prototype.processTouchstart=function(a){},Qb.prototype.processTouchmove=function(a){},Qb.prototype.processTouchend=function(a){},Qb.prototype.processHover=function(a){},Qb.prototype.moveTo=function(a,b,c){},Qb.prototype.rotateTo=function(a){},Qb.prototype.dispatchEvent=function(a){var b=this.cameraControl.viewer.drawManager;b.dispatchEvent(a)},Qb.prototype.getDomElement=function(){return this.domElement},Qb.prototype.getRendererDomElement=function(){return this.rendererDomElement},Qb.prototype.updateButtons=function(a){void 0!==a.ORBIT&&(this.mouseButtons.ORBIT=a.ORBIT),void 0!==a.PAN&&(this.mouseButtons.PAN=a.PAN),void 0!==a.PAN2&&(this.mouseButtons.PAN2=a.PAN2),void 0!==a.ZOOM&&(this.mouseButtons.ZOOM=a.ZOOM)};var Rb=function(a,b,c){db.call(this,a),this.cameraControl=b,this.startPt=new B,this.endPt=new B,this.eventDispatcher=c};Rb.prototype=Object.create(db.prototype),Rb.prototype.constructor=Rb,Rb.prototype.onUpdateUI=function(a){this.eventDispatcher.dispatchEvent({type:ga.ON_CONTROL_UPDATEUI,data:a,editor:this.name})},Rb.prototype.updateFrustum=function(a,b){var c=this.startPt.x,d=this.endPt.x,e=this.startPt.y,f=this.endPt.y;if(c>d){var g=c;c=d,d=g}if(e>f){var h=e;e=f,f=h}if(d-c===0||f-e===0)return!1;var i=this.cameraControl,j=i.getContainerDimensions();return a&&i.computeFrustum(c,d,e,f,this.frustum,j),b&&this.onUpdateUI({visible:!0,dir:this.startPt.x<this.endPt.x,left:c-j.left,top:e-j.top,width:d-c,height:f-e}),!0};var Sb=function(a){Rb.call(this,ea.PICK_BY_RECT,a.cameraControl,a.drawManager),this.viewer=a,this.pickHelper=new fb(this.cameraControl),this.activatePick=!1,this.pressKey=""};Sb.prototype=Object.create(Rb.prototype),Sb.prototype.constructor=Sb,Sb.prototype.destroy=function(){Qb.prototype.destroy.call(this),this.pickHelper.destroy(),this.pickHelper=null},Sb.prototype.setPressKey=function(a){this.pressKey=a},Sb.prototype.processMouseDown=function(a){return a.preventDefault(),this.activatePick=a.ctrlKey||a.altKey,this.activatePick&&a.button===ca.LEFT?(this.startPt.set(a.clientX,a.clientY),!0):Rb.prototype.processMouseDown(this,a)},Sb.prototype.processMouseMove=function(a){return this.activatePick&&a.button===ca.LEFT?(this.endPt.set(a.clientX,a.clientY),this.updateFrustum(!1,!0),!0):Rb.prototype.processMouseMove(this,a)},Sb.prototype.processMouseUp=function(a){if(this.onUpdateUI({visible:!1}),this.activatePick&&a.button===ca.LEFT){if(this.activatePick=!1,Math.abs(this.startPt.x-a.clientX)<2&&Math.abs(this.startPt.y-a.clientY)<2)return this.pickHelper.click(a,null),!0;if(this.endPt.set(a.clientX,a.clientY),!this.updateFrustum(!1,!1))return this.pickHelper.click(a),!0;var b=fa.Clear,c=this.pressKey||a.ctrlKey&&"ctrl"||a.altKey&&"alt"||"";"ctrl"===c?b=fa.Add:"alt"===c&&(b=fa.Remove);var d=new B,e=new B;this.cameraControl.mapWindowToViewport(this.startPt.x,this.startPt.y,d),this.cameraControl.mapWindowToViewport(a.clientX,a.clientY,e);var f=d.x,g=d.y,h=e.x,i=e.y;d.x>e.x&&(f=e.x,h=d.x),d.y>e.y&&(g=e.y,i=d.y);var j=new D(new B(f,g),new B(h,i));return this.pickByRect(j,b,this.endPt.x>this.startPt.x),this.pickHelper.lastPickedUserId="",this.cameraControl.updateView(!0),!0}return Rb.prototype.processMouseUp(this,a)},Sb.prototype.processTouchstart=function(a){return a.preventDefault(),this.pressKey?(this.startPt.set(a.changedTouches[0].pageX,a.changedTouches[0].pageY),!0):Rb.prototype.processTouchstart(this,a)},Sb.prototype.processTouchmove=function(a){return this.pressKey?(this.endPt.set(a.changedTouches[0].pageX,a.changedTouches[0].pageY),this.updateFrustum(!1,!0),!0):Rb.prototype.processMouseMove(this,a)},Sb.prototype.processTouchend=function(a){this.onUpdateUI({visible:!1});var b=a.changedTouches[0].pageX,c=a.changedTouches[0].pageY;if(this.pressKey){if(Math.abs(this.startPt.x-b)<2&&Math.abs(this.startPt.y-c)<2)return this.pickHelper.click(a,null),!0;if(this.endPt.set(b,c),!this.updateFrustum(!1,!1))return this.pickHelper.click(a),!0;var d=fa.Clear,e=this.pressKey;"ctrl"===e?d=fa.Add:"alt"===e&&(d=fa.Remove);var f=new B,g=new B;this.cameraControl.mapWindowToViewport(this.startPt.x,this.startPt.y,f),this.cameraControl.mapWindowToViewport(b,c,g);var h=f.x,i=f.y,j=g.x,k=g.y;f.x>g.x&&(h=g.x,j=f.x),f.y>g.y&&(i=g.y,k=f.y);var l=new D(new B(h,i),new B(j,k));return this.pickByRect(l,d,this.endPt.x>this.startPt.x),this.pickHelper.lastPickedUserId="",this.cameraControl.updateView(!0),!0}return Rb.prototype.processTouchend(this,a)},Sb.prototype.pickByRect=function(a,b,c){var d=this.viewer.drawManager,e=this.cameraControl.camera.getViewportTransform(),f=new Ra;f.fromCanvasTransform(e[0],e[1],e[2],e[3],e[4],e[5]);var g=d.getCurrentDraw(),h=d.sceneState,i=g.componentPartsInScreenBox(a,f,c);i&&i.length>0&&(fa.Remove===b?(h.removeSelection(i),d.dispatchEvent({type:ga.ON_RECTPICK_REMOVE,list:i})):fa.Add===b&&(h.addSelection(i),d.dispatchEvent({type:ga.ON_RECTPICK_ADD,list:i})))};var Tb=function(a){Rb.call(this,ea.ZOOM_BY_RECT,a.cameraControl,a.drawManager),this.activateZoom=!1};Tb.prototype=Object.create(Rb.prototype),Tb.prototype.constructor=Tb,Tb.prototype.processMouseDown=function(a){return a.button===ca.LEFT?(this.startPt.set(a.clientX,a.clientY),this.activateZoom=!0,!0):Rb.prototype.processMouseDown.call(this,a)},Tb.prototype.processMouseMove=function(a){return this.activateZoom?(this.endPt.set(a.clientX,a.clientY),this.updateFrustum(!1,!0),!0):Rb.prototype.processMouseMove.call(this,a)},Tb.prototype.processMouseUp=function(a){return this.activateZoom?(this.activateZoom=!1,this.onUpdateUI({visible:!1}),this.endPt.set(a.clientX,a.clientY),this.zoomToRectangle(),!0):Rb.prototype.processMouseUp.call(this,a)},Tb.prototype.zoomToRectangle=function(){if(Math.abs(this.startPt.x-this.endPt.x)>5&&Math.abs(this.startPt.y-this.endPt.y)>5){var a=this.cameraControl.getContainerDimensions();this.startPt.x-=a.left,this.startPt.y-=a.top,this.endPt.x-=a.left,this.endPt.y-=a.top;var b=this.startPt.x,c=this.startPt.y,d=this.endPt.x,e=this.endPt.y;this.startPt.x>this.endPt.x&&(b=this.endPt.x,d=this.startPt.x),this.startPt.y>this.endPt.y&&(c=this.endPt.y,e=this.startPt.y),this.cameraControl.zoomToScreenBox(new D(new B(b,c),new B(d,e)))}},Tb.prototype.processTouchstart=function(a){return 1===a.touches.length?(this.startPt.set(a.touches[0].clientX,a.touches[0].clientY),this.activateZoom=!0,!0):Rb.prototype.processMouseDown.call(this,a)},Tb.prototype.processTouchmove=function(a){return this.activateZoom?(this.endPt.set(a.touches[0].clientX,a.touches[0].clientY),this.updateFrustum(!1,!0),!0):Rb.prototype.processMouseMove.call(this,a);
},Tb.prototype.processTouchend=function(a){return this.activateZoom?(this.activateZoom=!1,this.onUpdateUI({visible:!1}),this.endPt.set(a.changedTouches[0].clientX,a.changedTouches[0].clientY),this.zoomToRectangle(),!0):Rb.prototype.processMouseUp.call(this,a)};var Ub=function(a){db.call(this,ea.VIEWER3D_CAMERA_CONTROL),this.viewer=a};Ub.prototype=Object.create(db.prototype),Ub.prototype.constructor=Ub,Ub.prototype.processMouseUp=function(a){if(a.button===ca.LEFT){var b=a.clientX,c=a.clientY;return this._showViewer3DCamera(b,c),!0}return!1},Ub.prototype.processHover=function(a){return!0},Ub.prototype.processTouchend=function(a){var b=a.touches[0].clientX,c=a.touches[0].clientY;return this._showViewer3DCamera(b,c),!0},Ub.prototype.onExit=function(a){this.viewer=void 0},Ub.prototype._showViewer3DCamera=function(a,b){var c=this.viewer.cameraControl,d=c.screenToCanvas(a,b),e=this.viewer.getSceneCoordFromScreenCoord([d.x,d.y]);e[1]=-e[1],c.dispatchEvent({type:ga.ON_VIEWER3D_CAMERA_CHANGE,position:e})};var Vb=function(a,b,c,d){Qb.call(this,a,b,c,d),this.oldMouseX=-1,this.oldMouseY=-1,this.rotatePivot=null,this._rotateStart=new B,this._rotateEnd=new B,this._rotateDelta=new B,this._lastTrackingPoint=null,this.rotateSpeed=1,this._dollyStart=new B,this._dollyEnd=new B,this._dollyDelta=new B,this._dollyCenter=new B,this.zoomSpeed=Math.pow(.95,.2),this.drawManager=b.viewer.drawManager,this._panStart=new B,this._panEnd=new B,this._panDelta=new B,this._pan=new B,this._worldDimension=new B,this.pickHelper=new fb(b),this.intersectOfMouseDown=null,this.timeId=null,this.longTapFlag=!1,Aa.isMobileDevice()?this.selectPad=null:this.selectPad=null,this.startPt=new B;var e=this;this.longTap=function(){e.longTapFlag=!0,G.log("long tap"),e.selectPad&&e.selectPad.showOverlay(e.startPt)},this._reqid=0,this._animateBinded=this._animate.bind(this),this._clock=new y,this._moving=!1,this.throttleMouseHover=!0,this._throttleMouseHoverTimer=void 0};Vb.prototype=Object.create(Qb.prototype),Vb.prototype.constructor=Vb,Vb.prototype.destroy=function(){Qb.prototype.destroy.call(this),this.pickHelper.destroy(),this.pickHelper=null,this.intersectOfMouseDown=null,this.selectPad&&(this.selectPad=null),this.timeId=null},Vb.prototype.beginPan=function(a,b){this._panStart.set(a,b),this._worldDimension=this.getWorldDimension(a,b)},Vb.prototype.processMouseDown=function(a){this._throttleMouseHoverTimer&&(clearTimeout(this._throttleMouseHoverTimer),this._throttleMouseHoverTimer=void 0),this.oldMouseX=a.clientX,this.oldMouseY=a.clientY;this.cameraControl;this.intersectOfMouseDown=null,a.preventDefault();var b="";a.button===this.mouseButtons.ZOOM?(this.state=this.StateType.DOLLY,this._dollyStart.set(a.clientX,a.clientY),b=da.ZOOM):a.button!==this.mouseButtons.PAN&&a.button!==this.mouseButtons.PAN2||(this._panStart.set(a.clientX,a.clientY),this.state=this.StateType.PAN,b=da.PAN),this.dispatchEvent({type:ga.ON_CONTROL_BEGIN,name:b,editor:this.name})},Vb.prototype.processMouseMove=function(a){this.cameraControl;switch(a.preventDefault(),this.state){case this.StateType.ROTATE:break;case this.StateType.DOLLY:if(this._dollyEnd.set(a.clientX,a.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),0===this._dollyDelta.x&&0===this._dollyDelta.y)return;var b=0;b=this._dollyDelta.y>0?this.zoomSpeed:1/this.zoomSpeed,this.cameraControl.setZoom(b,null),this._dollyStart.copy(this._dollyEnd);break;case this.StateType.PAN:if(this._panEnd.set(a.clientX,a.clientY),this._panDelta.subVectors(this._panEnd,this._panStart),0===this._panDelta.x&&0===this._panDelta.y)return;this.cameraControl.relativePan(this._panDelta),this._panStart.copy(this._panEnd);break;case this.StateType.NONE:}this.state!==this.StateType.NONE&&this.cameraControl.update(!0)},Vb.prototype.processMouseUp=function(a){if(this.state===this.StateType.NONE)return!1;this.intersectOfMouseDown=null;var b=this.cameraControl;this.oldMouseX===a.clientX&&this.oldMouseY===a.clientY||b.update(!0),this.state=this.StateType.NONE,this.rotatePivot=null;var c="";return a.button===this.mouseButtons.ZOOM?c=da.ZOOM:a.button!==this.mouseButtons.PAN&&a.button!==this.mouseButtons.PAN2||(c=da.PAN),this.dispatchEvent({type:ga.ON_CONTROL_END,name:c,editor:this.name}),!0},Vb.prototype.processMouseWheel=function(a){var b=this.cameraControl;a.preventDefault(),a.stopPropagation();var c=0;a.wheelDelta?c=a.wheelDelta:a.deltaY&&(c=40*-a.deltaY),Math.abs(c)>720&&(c=c>0?720:-720),c*=this.wheelZoomFactor;var d=c;d=c>0?1/(1-c):1+c;var e=b.screenToCanvas(a.clientX,a.clientY);b.zoom(d,e.x,e.y),this.drawManager.dispatchEvent({type:ga.ON_CONTROL_ZOOM})},Vb.prototype.processKeyDown=function(a){},Vb.prototype.processKeyUp=function(a){},Vb.prototype.processTouchstart=function(a){this.startPt.set(a.touches[0].clientX,a.touches[0].clientY),this.timeId&&clearTimeout(this.timeId);var b=(this.cameraControl,this);switch(b.timeId=setTimeout(b.longTap,400),this.selectPad&&this.selectPad.hideOverlay(),a.touches.length){case 1:var c=a.touches[0].clientX,d=a.touches[0].clientY;this._panStart.set(c,d);break;case 2:var e=a.touches[0].clientX-a.touches[1].clientX,f=a.touches[0].clientY-a.touches[1].clientY;this._dollyStart.set(0,Math.sqrt(e*e+f*f));break;default:this.state=this.StateType.NONE}},Vb.prototype.processTouchmove=function(a){var b=this.cameraControl;switch(a.preventDefault(),a.touches.length){case 1:if(this._panEnd.set(a.touches[0].clientX,a.touches[0].clientY),this._panDelta.subVectors(this._panEnd,this._panStart),0===this._panDelta.x&&0===this._panDelta.y)return;this.cameraControl.relativePan(this._panDelta),this._panStart.copy(this._panEnd),this.state=this.StateType.PAN;break;case 2:var c=a.touches[0].clientX-a.touches[1].clientX,d=a.touches[0].clientY-a.touches[1].clientY,e=Math.sqrt(c*c+d*d);if(this._dollyEnd.set(0,e),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),Math.abs(this._dollyDelta.y)>3){var f=0;this._dollyDelta.y>0?f=1/Math.pow(this.zoomSpeed,.5*this._dollyDelta.y):this._dollyDelta.y<0&&(f=Math.pow(this.zoomSpeed,.5*-this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd);var g=.5*(a.touches[0].clientX+a.touches[1].clientX),h=.5*(a.touches[0].clientY+a.touches[1].clientY);b.zoom(f,g,h),this.state=this.StateType.DOLLY}}},Vb.prototype.processTouchend=function(a){this.timeId&&clearTimeout(this.timeId),this.longTapFlag&&(this.longTapFlag=!1,a.preventDefault());this.cameraControl;switch(a.touches.length){case 0:this.state=this.StateType.NONE;break;case 1:this._panStart.set(a.touches[0].clientX,a.touches[0].clientY),this.state=this.StateType.PAN}},Vb.prototype.processHover=function(a){if(Z.Hover)if(this.throttleMouseHover){this._throttleMouseHoverTimer&&(clearTimeout(this._throttleMouseHoverTimer),this._throttleMouseHoverTimer=void 0);var b=this;this._throttleMouseHoverTimer=setTimeout(function(){b.pickHelper.handleMouseHover(a)},50)}else this.pickHelper.handleMouseHover(a);else;},Vb.prototype.moveTo=function(a){},Vb.prototype._updateMove=function(){this._moving&&(this._moving=!1,this.cameraControl.update(!0))},Vb.prototype._animate=function(){this._reqid=requestAnimationFrame(this._animateBinded),this._updateMove()},Vb.prototype._start=function(){this._animate()},Vb.prototype._stop=function(){cancelAnimationFrame(this._reqid)},Vb.prototype.onExit=function(){this._stop()};var Wb=function(a,b,c,d){Vb.call(this,da.PICK,b,d)};Wb.prototype=Object.create(Vb.prototype),Wb.prototype.constructor=Wb,Wb.prototype.processMouseUp=function(a){a.preventDefault();var b=Math.abs(this.oldMouseX-a.clientX)<=1&&Math.abs(this.oldMouseY-a.clientY)<=1;if(a.button===ca.LEFT&&b)return this.pickHelper.click(a,this.intersectOfMouseDown),void(this.intersectOfMouseDown=null);b||a.button===this.mouseButtons.ORBIT||a.button===this.mouseButtons.PAN,this.intersectOfMouseDown=null,this.state=this.StateType.NONE;var c="";a.button===this.mouseButtons.ORBIT?c=da.ORBIT:a.button===this.mouseButtons.ZOOM?c=da.ZOOM:a.button!==this.mouseButtons.PAN&&a.button!==this.mouseButtons.PAN2||(c=da.PAN),this.dispatchEvent({type:ga.ON_CONTROL_END,name:c,Control:this.name})},Wb.prototype.processMouseDoubleClick=function(a){a.button===ca.LEFT&&this.pickHelper.doubleClick(a)};var Xb=function(){function a(a){f.setFocuse(),e=!0,f.isUpdateRenderList=!1,f.control?f.control.processMouseDown(a):G.warn("control is null")}function b(a){e?(f.isUpdateRenderList=!1,f.cameraChange=!0,f.control.processMouseMove(a)):f.control.processHover(a)}function c(a){f.isUpdateRenderList=!0,e&&(f.control.processMouseUp(a),e=!1)}function d(d){if(!f.enabled)return void(f.cameraChange=!1);for(var g=f.tools,h=g.length-1;h>=0;h-=1)if(g[h].onEvent(d)){switch(d.type){case"mouseup":e=!1}return}switch(d.type){case"touchmove":f.control.processTouchmove(d);break;case"touchstart":f.control.processTouchstart(d);break;case"touchend":f.control.processTouchend(d);break;case"keydown":f.control.processKeyDown(d);break;case"keyup":f.control.processKeyUp(d);break;case"wheel":case"mousewheel":case"DOMMouseScroll":f.cameraChange=!0,f.control.processMouseWheel(d);break;case"mousedown":a(d);break;case"mousemove":b(d);break;case"mouseup":c(d);break;case"dblclick":f.control.processMouseDoubleClick(d)}}this.control=null,this.controls={},this.tools=[],this.domElement=null,this.enabled=!0,this.isUpdateRenderList=!0;var e=!1,f=this;this.setFocuse=function(){if(f.domElement){var a=f.domElement.querySelector(".main-canvas");a&&a.focus&&a.focus()}},this.registerDomEventListeners=function(a){this.domElement=a,a.addEventListener("contextmenu",function(a){a.preventDefault()},!1),a.addEventListener("mousedown",d,!1),a.addEventListener("mousewheel",d,!1),a.addEventListener("DOMMouseScroll",d,!1),a.addEventListener("wheel",d,!1),a.addEventListener("dblclick",d,!1),a.addEventListener("mousemove",d,!1),a.addEventListener("mouseup",d,!1),a.addEventListener("touchstart",d,!1),a.addEventListener("touchend",d,!1),a.addEventListener("touchmove",d,!1),window.addEventListener("touchmove",function(a){},!1),a.addEventListener("keydown",d,!1),a.addEventListener("keyup",d,!1),this.setFocuse()},this.unregisterDomEventListeners=function(a){a.removeEventListener("contextmenu",function(a){a.preventDefault()},!1),a.removeEventListener("mousedown",d,!1),a.removeEventListener("mousewheel",d,!1),a.removeEventListener("DOMMouseScroll",d,!1),a.removeEventListener("dblclick",d,!1),window.removeEventListener("mousemove",d,!1),window.removeEventListener("mouseup",d,!1),a.removeEventListener("touchstart",d,!1),a.removeEventListener("touchend",d,!1),a.removeEventListener("touchmove",d,!1),a.removeEventListener("keydown",d,!1),a.removeEventListener("keyup",d,!1)}};Xb.prototype={constructor:Xb,destroy:function(){this.control=null;for(var a in this.controls){var b=this.controls[a];b.destroy()}this.controls={}},getCurrentControlName:function(){return this.control?this.control.name:""},_getControlByName:function(a,b){var c=this.controls[b];if(c)return c;var d=da,e=a.cameraControl,f="",g=a.domElement;switch(b){case d.PICK:c=new Wb(d.PICK,e,f,g);break;case d.PAN:break;default:c=null,G.error("invalid control name")}return c&&(c.name=b,this.controls[b]=c),c},getCurrentControlMode:function(){return this.control},setControlMode:function(a,b){var c=this._getControlByName(a,b);c&&this.control!==c&&(null!==this.control&&(this.control.dispatchEvent({type:ga.ON_CONTROL_EXIST,name:this.control.getName()}),this.dispatchEvent({type:ga.ON_CONTROL_EXIST,name:this.control.getName()}),this.control.onExit()),this.control=c,this.control.onEnter(),this.control.dispatchEvent({type:ga.ON_CONTROL_ENTER,name:this.control.getName()}),this.dispatchEvent({type:ga.ON_CONTROL_ENTER,name:this.control.getName()}))},getToolByName:function(a){for(var b=this.tools.length,c=0;c<b;c+=1)if(this.tools[c].name===a)return this.tools[c]},enableTool:function(a,b){for(var c=ea,d=this.tools,e=0,f=d.length;e<f;e+=1)if(d[e].name===b)return;var g=null;switch(b){case c.PICK_BY_RECT:g=new Sb(a);break;case c.ZOOM_BY_RECT:g=new Tb(a);break;case c.CLIP_BY_BOX:g=new eb(a);break;case c.CLIP_FILL:break;case c.PICK_BY_MEASURE:g=new Pb(a);break;case c.COMPONENT_TRANSFORM:break;case c.VIEWER3D_CAMERA_CONTROL:g=new Ub(a)}g&&d.push(g)},disableTool:function(a){for(var b=this.tools,c=0,d=b.length;c<d;c+=1)if(b[c].name===a){b[c].onExit(),b.splice(c,1);break}},setInteractiveState:function(a){this.enabled=a}},Object.assign(Xb.prototype,J.prototype),Object.defineProperties(A.prototype,{width:{get:function(){return this.z},set:function(a){this.z=a}},height:{get:function(){return this.w},set:function(a){this.w=a}}}),Object.assign(A.prototype,{isVector4:!0,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this.w=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setW:function(a){return this.w=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+a)}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,f=a.elements;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},setAxisAngleFromRotationMatrix:function(a){var b,c,d,e,f=.01,g=.1,h=a.elements,i=h[0],j=h[4],k=h[8],l=h[1],m=h[5],n=h[9],o=h[2],p=h[6],q=h[10];if(Math.abs(j-l)<f&&Math.abs(k-o)<f&&Math.abs(n-p)<f){if(Math.abs(j+l)<g&&Math.abs(k+o)<g&&Math.abs(n+p)<g&&Math.abs(i+m+q-3)<g)return this.set(1,0,0,0),this;b=Math.PI;var r=(i+1)/2,s=(m+1)/2,t=(q+1)/2,u=(j+l)/4,v=(k+o)/4,w=(n+p)/4;return r>s&&r>t?r<f?(c=0,d=.707106781,e=.707106781):(c=Math.sqrt(r),d=u/c,e=v/c):s>t?s<f?(c=.707106781,d=0,e=.707106781):(d=Math.sqrt(s),c=u/d,e=w/d):t<f?(c=.707106781,d=.707106781,e=0):(e=Math.sqrt(t),c=v/e,d=w/e),this.set(c,d,e,b),this}var x=Math.sqrt((p-n)*(p-n)+(k-o)*(k-o)+(l-j)*(l-j));return Math.abs(x)<.001&&(x=1),this.x=(p-n)/x,this.y=(k-o)/x,this.z=(l-j)/x,this.w=Math.acos((i+m+q-1)/2),this},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this.w=Math.max(a.w,Math.min(b.w,this.w)),this},clampScalar:function(a,b){return this.x=Math.max(a,Math.min(b,this.x)),this.y=Math.max(a,Math.min(b,this.y)),this.z=Math.max(a,Math.min(b,this.z)),this.w=Math.max(a,Math.min(b,this.w)),this},clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a},fromBufferAttribute:function(a,b,c){return void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}});var Yb=function(a,b,c,d){this.viewer=a,this.cubeSize=c.clone(),this.center=d.clone(),this.visible=!1,this.enabled=!1,this.rotatable=!1,this.selectIndex=null,this.planeOffset=new Array(6),this.planeRotate=[0,0,0],this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("style","width: 100%; height: 100%; position:absolute; left: 0; top:0;"),this.viewer.getViewerDiv().appendChild(this.svg),this.topLine=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.topLine.setAttribute("x",0),this.topLine.clipName="topLine",this.topLine.setAttribute("y",0),this.topLine.setAttribute("width",1),this.topLine.setAttribute("height",1),this.topLine.setAttribute("fill","#05d8ff"),this.leftLine=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.leftLine.clipName="leftLine",this.leftLine.setAttribute("x",0),this.leftLine.setAttribute("y",0),this.leftLine.setAttribute("width",1),this.leftLine.setAttribute("height",1),this.leftLine.setAttribute("fill","#05d8ff"),this.rightLine=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.rightLine.clipName="rightLine",this.rightLine.setAttribute("x",0),this.rightLine.setAttribute("y",0),this.rightLine.setAttribute("width",1),this.rightLine.setAttribute("height",1),this.rightLine.setAttribute("fill","#05d8ff"),this.bottomLine=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.bottomLine.clipName="bottomLine",this.bottomLine.setAttribute("x",0),this.bottomLine.setAttribute("y",0),this.bottomLine.setAttribute("width",1),this.bottomLine.setAttribute("height",1),this.bottomLine.setAttribute("fill","#05d8ff"),this.clipplane=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.clipplane.setAttribute("x",0),this.clipplane.setAttribute("y",0),this.clipplane.setAttribute("width",1),this.clipplane.setAttribute("height",1),this.clipplane.setAttribute("style","fill:#77E3FF;fill-opacity:0.1"),this.clipplanes=null,this.calculation=!0,this.boundingBox=(new D).copy(b),this.calculateClipBoundingBox=function(a){this.boundingBox.makeEmpty();for(var b=new t,c=0;c<a.length;c+=1){var d=a[c].coplanarPoint(b);0!==d.x&&(d.x>this.boundingBox.max.x?this.boundingBox.max.x=d.x:d.x<this.boundingBox.min.x&&(this.boundingBox.min.x=d.x)),0!==d.y&&(d.y>this.boundingBox.max.y?this.boundingBox.max.y=d.y:d.y<this.boundingBox.min.y&&(this.boundingBox.min.y=d.y)),0!==d.z&&(d.z>this.boundingBox.max.z?this.boundingBox.max.z=d.z:d.z<this.boundingBox.min.z&&(this.boundingBox.min.z=d.z))}},this.getClipBoundingBox=function(){return this.boundingBox},this.isVisible=function(){return this.visible},this.getPlaneNormal=function(a){var b=new A,c=Math.floor(a/2),d=a%2;return b.setComponent(c,Math.pow(-1,d)),b.w=.5*-this.cubeSize.getComponent(c),this.planeOffset[a]=0,b},this.planeMaterial={color:"#05d8ff",opacity:1},this.planeHighLightMatrial={color:"#2a55ff",opacity:1},this.initPlaneModel=function(a){},this.initCapsBox=function(){},this.initWireframes=function(){},this.updateClippingParams=function(a){},this.enable=function(a,b){this.visible=b,this.enabled=a,this.update()},this.isEnabled=function(){return this.enabled};var e=function(a,b,c,d,e,f,g,h,i,j,k){this.enable=a,this.visible=b,this.rotatable=c,this.calculation=d,this.planeOffset=e.slice(0),this.planeRotate=f.slice(0),this.position=g,this.scale=h,this.quaternion=i,this.cubeSize=j,this.center=k};this.store=function(){return new e((!!this.uniforms.iClipPlane.value),this.visible,this.rotatable,this.calculation,this.planeOffset,this.planeRotate,this.position.clone(),this.scale.clone(),this.quaternion.clone(),this.cubeSize.clone(),this.center.clone())},this.restore=function(a){this.calculation=!0,this.calculationPlanes(a.cubeSize,a.center),this.enable(a.enable,a.visible),this.rotatable=a.rotatable,this.calculation=a.calculation;for(var b=0;b<6;b+=1)this.planeOffset[b]=a.planeOffset[b];for(var c=0;c<3;c+=1)this.planeRotate[c]=a.planeRotate[c];this.position.copy(a.position),this.scale.copy(a.scale),this.quaternion._w=a.quaternion._w,this.quaternion._x=a.quaternion._x,this.quaternion._y=a.quaternion._y,this.quaternion._z=a.quaternion._z,this.update()},this.reset=function(){this.calculation=!0,this.update()},this.calculationPlanes=function(a,b){this.calculation&&(this.cubeSize.copy(a),this.center.copy(b),this.reset())},this.update=function(){if(this.svg.innerHTML="",this.visible){var a=this.boundingBox.clone();a.applyMatrix3(this.viewer.getSceneToScreenMatrix());var b=a.min.x,c=a.min.y,d=a.getSize(new B);this.topLine.setAttribute("x",b),this.topLine.setAttribute("y",c),this.topLine.setAttribute("width",d.x),this.topLine.setAttribute("height",3),this.svg.appendChild(this.topLine),this.leftLine.setAttribute("x",b),this.leftLine.setAttribute("y",c),this.leftLine.setAttribute("width",3),this.leftLine.setAttribute("height",d.y),this.svg.appendChild(this.leftLine),this.rightLine.setAttribute("x",b+d.x),this.rightLine.setAttribute("y",c),this.rightLine.setAttribute("width",3),this.rightLine.setAttribute("height",d.y),this.svg.appendChild(this.rightLine),this.bottomLine.setAttribute("x",b),this.bottomLine.setAttribute("y",c+d.y),this.bottomLine.setAttribute("width",d.x),this.bottomLine.setAttribute("height",3),this.svg.appendChild(this.bottomLine),this.clipplane.setAttribute("x",b+3),this.clipplane.setAttribute("y",c+3),this.clipplane.setAttribute("width",d.x-6),this.clipplane.setAttribute("height",d.y-6),this.svg.appendChild(this.clipplane)}},this.offset=function(a,b){this.calculation=!1;var c=Math.floor(a/2),d=this.cubeSize.getComponent(c);d=.5*d,this.planeOffset[a]+=b;for(var e=new B,f=0;f<6;f+=1){var g=this.clipplanes[f].clone(),h=this.planeOffset[f],i=new t(g.x*h,g.y*h,g.z*h);e.add(i)}var j=1+e.getComponent(c)/this.cubeSize.getComponent(c);if(j=0===j?1e-5:j,j>0){this.scale.setComponent(c,j);var k=this.uniforms.vClipPlane.value[a].clone(),l=new B(k.x,k.y,k.z);l.normalize();var i=b,m=new B(l.x*i,l.y*i,l.z*i);a%2===1?this.position.sub(m.multiplyScalar(.5)):this.position.add(m.multiplyScalar(.5)),this.update()}else this.planeOffset[a]-=b},this.rotX=function(a){},this.rotY=function(a){},this.setSectionBox=function(a,b){this.calculation=!0;var c=new B(b.x-a.x,b.y-a.y),d=new B(.5*(a.x+b.x),.5*(a.y+b.y));this.calculationPlanes(c,d)},this.calculateOffsetByBox=function(a,b){var c=b.x-this.center.x-.5*this.cubeSize.x;c<this.planeOffset[0]?(this.moveSectionPlane("left",this.center.x-.5*this.cubeSize.x-a.x),this.moveSectionPlane("right",c)):(this.moveSectionPlane("right",c),this.moveSectionPlane("left",this.center.x-.5*this.cubeSize.x-a.x));var d=b.y-this.center.y-.5*this.cubeSize.y;d<this.planeOffset[2]?(this.moveSectionPlane("bottom",this.center.y-.5*this.cubeSize.y-a.y),this.moveSectionPlane("top",d)):(this.moveSectionPlane("top",d),this.moveSectionPlane("bottom",this.center.y-.5*this.cubeSize.y-a.y));var e=b.z-this.center.z-.5*this.cubeSize.z;e<this.planeOffset[4]?(this.moveSectionPlane("back",this.center.z-.5*this.cubeSize.z-a.z),this.moveSectionPlane("front",e)):(this.moveSectionPlane("front",e),this.moveSectionPlane("back",this.center.z-.5*this.cubeSize.z-a.z))},this.getPlaneIndexByName=function(a){var b=-1;return"right"===a?b=0:"left"===a?b=1:"top"===a?b=2:"bottom"===a?b=3:"front"===a?b=4:"back"===a&&(b=5),b},this.moveSectionPlane=function(a,b){var c=this.getPlaneIndexByName(a);if(c!==-1){c%2!==0&&(b=-b);var d=b-this.planeOffset[c];this.offset(c,d)}},this.recalculate=function(){var a=this.filter;return a.getVisibleComponentsBbox()},this.setProcess=function(a,b){var c=this.getPlaneIndexByName(a),d=0;if(c<2?d=this.cubeSize.x:c<4?d=this.cubeSize.y:c<6&&(d=this.cubeSize.z),b>1?b=1:b<0&&(b=0),c!==-1){c%2!==1&&(b=-b);var e=b*d-this.planeOffset[c];this.offset(c,e)}},this.getProcess=function(a){var b=this.getPlaneIndexByName(a);b===-1&&console.log("faceName is illegal");var c=0;b<2?c=this.cubeSize.x:b<4?c=this.cubeSize.y:b<6&&(c=this.cubeSize.z);var d=1;b%2!==1&&(d=-1);var e=d*this.planeOffset[b]/c;return e>1?e=1:e<0&&(e=0),e},this.rotateSectionBox=function(a,b){},this.highLight=function(){null!==this.selectIndex&&this[this.selectIndex].setAttribute("fill",this.planeHighLightMatrial.color)},this.cancelHighLight=function(){null!==this.selectIndex&&(this[this.selectIndex].setAttribute("fill",this.planeMaterial.color),this.selectIndex=null)}};Yb.prototype.constructor=Yb,Yb.prototype.init=function(a){this.boundingBox.copy(a),this.update()},Yb.prototype.hitTest=function(a){},Yb.prototype.selectedLineNameAtPosition=function(a,b){for(var c=void 0,d=1/0,e=[this.leftLine,this.rightLine,this.topLine,this.bottomLine],f=0,g=e.length;f<g;f+=1){var h=e[f],i=h.getBBox();if(h===this.leftLine||h===this.rightLine){var j=i.x+i.width/2,k=Math.abs(a-j);d>k&&(d=k,c=h.clipName)}else{var l=i.y+i.height/2,m=Math.abs(b-l);d>m&&(d=m,c=h.clipName)}}if(d<20)return c},Yb.prototype.raycast=function(a){};var Zb=function(a){this.modelKey=void 0,this.serverUrl=void 0,this.dbName=void 0,this.loaded=!1,this.drawList=void 0,this._draws=void 0,this.visible=!0,this.viewer=a};Zb.prototype.addDraw=function(a){if(a){this._draws||(this._draws={}),this._draws[a.drawKey]=a;for(var b=0,c=this.drawList.length;b<c;b+=1){var d=this.drawList[b];if(d.key===a.drawKey){a.localMatrixWithCanvasSize(this.viewer.canvas.width,this.viewer.canvas.height),d.isLoaded=!0;break}}}},Zb.prototype.containDraw=function(a){return!(!a||!this._draws[a])},Zb.prototype.getDrawByDrawKey=function(a){if(a&&this._draws)return this._draws[a]},Zb.prototype.getAllDraws=function(){var a=[];for(var b in this._draws)if(this._draws.hasOwnProperty(b)){var c=this._draws[b];a.push(c)}return a},Zb.prototype.getAllDrawKey=function(){var a=[];for(var b in this._draws)this._draws.hasOwnProperty(b)&&a.push(b);return a},Zb.prototype.getDrawListItemByFileKey=function(a){var b=void 0;if(this.drawList)for(var c=0;c<this.drawList.length;c+=1)if(a===this.drawList[c].fileKey){b=this.drawList[c];break}return b},Zb.prototype.showDraw=function(a){var b=this._draws[a];if(b){for(var c in this._draws)if(this._draws.hasOwnProperty(c)){var d=this._draws[c];d.setVisible(!1)}return b.setVisible(!0),!0}return!1},Zb.prototype.hideAllDraw=function(){for(var a in this._draws)if(this._draws.hasOwnProperty(a)){var b=this._draws[a];b.setVisible(!1)}},Zb.prototype.isPickable=function(){return this.pickableType},Zb.prototype.isUserIdExist=function(a){return!0};var $b=function Ac(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(b){return}var c=a.bound;if(c&&4===c.length){var d=new D;d.min.x=c[0],d.min.y=c[1],d.max.x=c[2],d.max.y=c[3],this.boundingBox=d}this.componentKeys=a.keys;var e=a.children;if(e&&4===e.length){for(var f=[],g=0;g<4;g+=1){var h=new Ac(e[g]);h&&f.push(h)}this.children=f}};$b.prototype.isValid=function(){return!(!this.boundingBox||!this.children)},$b.prototype.allComponents=function(){var a=[];if(this.componentKeys&&this.componentKeys.length&&(a=a.concat(this.componentKeys)),this.children&&4===this.children.length)for(var b=0;b<4;b+=1)a=a.concat(this.children[b].allComponents());return a},$b.prototype.allComponentsInBox=function(a){var b=[];if(this.componentKeys&&this.componentKeys.length&&this.boundingBox&&this.boundingBox.intersectsBox(a)&&(b=b.concat(this.componentKeys)),this.children&&4===this.children.length)for(var c=0;c<4;c+=1)b=b.concat(this.children[c].allComponentsInBox(a));return b};var _b=function(a){var b={dbName:"bos3d",store:"default",version:1,indexes:["id"],keyPath:"id"},c=this;this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;var d=(window.IDBKeyRange||window.webkitIDBKeyRange,X.extend({},b,a));this.IDBOpenDBRequest=null,this.dbName=d.dbName;var e=this.version=d.version;this.storeName=d.store;var f=d.keyPath,g=this.indexedDB.open(this.dbName,e);g.onupgradeneeded=function(a){G.log("DB version changed to "+e);var b=a.target.result,g=null;if(b.objectStoreNames.contains(c.storeName)===!1){g=b.createObjectStore(c.storeName,{keyPath:f});for(var h=0;h<d.indexes.length;h+=1){var i=d.indexes[h];g.createIndex(i,i,{unique:!1})}}},g.onsuccess=function(a){c.IDBOpenDBRequest=a.target.result,G.log("成功建立并打开数据库:"+c.IDBOpenDBRequest.name+" version "+e),c.dispatchEvent({type:ga.ON_DATABASE_OPEN})},g.onerror=function(a){G.error("IndexedDB",a),c.dispatchEvent({type:ga.ON_DATABASE_EEEOR})},g.onblocked=function(a){console.log("Please close all other tabs with this site open!",a)}};Object.assign(_b.prototype,J.prototype),Object.assign(_b.prototype,{constructor:_b,get:function(a,b,c,d){if(this.IDBOpenDBRequest){var e=this.IDBOpenDBRequest.transaction([b]),f=e.objectStore(b),g=f.get(a);g.onsuccess=function(a){"function"==typeof c&&c(a.target.result?a.target.result.data:null)},g.onerror=function(a){console.error("getDataByKey error"),"function"==typeof d&&d(a)}}},getBatch:function(a,b,c){if(this.IDBOpenDBRequest){for(var d=this.IDBOpenDBRequest.transaction([this.storeName]),e=d.objectStore(this.storeName),f={},g=[],h=0;h<a.length;h+=1)g.push(new Promise(function(b,c){var d=a[h],f=e.index("id"),g=f.get(d);g.onsuccess=function(a){b(a.target.result)},g.onerror=function(a){console.log(d,"failed",a),c(a)}}));Promise.all(g).then(function(a){for(var c=0;c<a.length;c+=1)a[c]&&(f[a[c].id]=a[c].data);b(f)})["catch"](function(a){b(f)})}},setBatch:function(a,b,c){if(this.IDBOpenDBRequest)for(var d=this.IDBOpenDBRequest.transaction([this.storeName],"readwrite"),e=d.objectStore(this.storeName),f=0;f<a.length;f+=1){var g={id:a[f].key,data:a[f]},h=e.put(g);h.onsuccess=function(a){}}},set:function(a,b,c,d){var e=performance.now();if(this.IDBOpenDBRequest){var f=this.IDBOpenDBRequest.transaction([this.storeName],"readwrite"),g=f.objectStore(this.storeName),h=[{
id:a,data:b}],i=g.add(h);i.onsuccess=function(a){"function"==typeof c&&c(a.target.result),G.debug("Saved state to IndexedDB. "+(performance.now()-e).toFixed(2)+"ms")},i.onerror=function(a){"function"==typeof d&&d(a)}}},put:function(a,b,c,d,e){if(this.IDBOpenDBRequest){var f=performance.now(),g=this.IDBOpenDBRequest.transaction([c],"readwrite"),h=g.objectStore(c),i={id:a,data:b},j=h.put(i);j.onsuccess=function(a){"function"==typeof d&&d(a.target.result),G.debug("Saved state to IndexedDB. "+(performance.now()-f).toFixed(2)+"ms")},j.onerror=function(a){G.error("离线存储出错:",a.target.error.name,":",a.target.error.message),"function"==typeof e&&e(a)}}},"delete":function(a,b,c){if(this.IDBOpenDBRequest){var d=this.IDBOpenDBRequest.transaction(this.storeName,"readwrite"),e=d.objectStore(this.storeName),f=e["delete"](a);f.onsuccess=function(a){G.debug("delete data form IndexedDB."),"function"==typeof b&&b(a.target.result)},f.onerror=function(a){G.error("IndexedDB",a),"function"==typeof c&&c(a)}}},clear:function(a,b){if(this.IDBOpenDBRequest){var c=this.IDBOpenDBRequest.transaction(this.storeName,"readwrite"),d=c.objectStore(this.storeName),e=d.clear();e.onsuccess=function(b){G.debug("Cleared IndexedDB."),"function"==typeof a&&a(b.target.result)},e.onerror=function(a){G.error("IndexedDB",a),"function"==typeof b&&b(a)}}},deleteDatabase:function(a){indexedDB.deleteDatabase(this.dbName),G.debug(this.dbName+"数据库已删除"),"function"==typeof a&&a()},close:function(a){this.IDBOpenDBRequest&&(this.IDBOpenDBRequest.close(),G.debug("数据库已关闭"),"function"==typeof a&&a())},getIndex:function(a,b,c,d){var e=a.transaction(b,"readwrite"),f=e.objectStore(b),g=f.index("id"),h=g.openCursor();h.onsuccess=function(){var a=this.result;a&&(console.log(a.value),a["continue"]())};var i=IDBKeyRange.only(2),j=g.openCursor(i);j.onsuccess=function(){var a=j.result;a&&console.info(a.value)}},destroy:function(){this.close(),this.IDBOpenDBRequest=null,this.dbName=null,this.storeName=null}});var ac=function(a,b){this.modelKey=a,this.cacheViable=!0,this._storage=void 0,this.url=b,this._requests={}};Object.assign(ac.prototype,{loadDraw:function(a,b,c){var d=this;this.cacheViable===!0?this.loadDrawFromDB(a,function(a){a?d.convertBlobToJson(a,function(a){a?b(a):c()}):c&&c()},function(){d.loadDrawFromServer(a,b,c)}):this.loadDrawFromServer(a,b,c)},cancelLoad:function(){if(Object.keys(this._requests).length>0){for(var a in this._requests)if(this._requests.hasOwnProperty(a)){var b=this._requests[a];b.abort()}this._requests={}}},convertBlobToJson:function(a,b){var c=new FileReader;c.onload=function(a){var c=new Uint8Array(a.target.result),d="{}";d=Aa.isIE11()?$a.decodeUTF8(c):new TextDecoder("utf-8").decode(c);var e=JSON.parse(d);b&&b(e)},c.onerror=function(a){b&&b()},c.readAsArrayBuffer(a)},loadDrawFromDB:function(a,b,c){this._executeBlockInStorage(function(d){d.get(a,d.dbName,function(a){if(!a)return void c();if(a.split===!0){var e=a.list,f=[],g=0;d.getBatch(e,function(d){for(var h=0;h<e.length;h+=1){var i=d[e[h]];i&&(f.push(i),g+=i.size)}if(g===a.length){var j=new Blob(f);b(j)}else c()})}else b(a)},function(a){c()})},function(){c()})},loadDrawFromServer:function(a,b,c){var d=this.url.dataUrl(a),e=this,f=new XMLHttpRequest;f.open("GET",d,!0),f.addEventListener("load",function(d){e._requests[a]&&delete e._requests[a];var g=d.target.response;if(200===f.status){if(e.cacheViable){var h=new Blob([g],{type:"application/json"}),i=e._sliceStringResponseIfNeed(h);e._saveDrawToIndexDB(a,i)}try{var j=JSON.parse(g);j?b&&b(g):c&&c()}catch(k){c&&c()}}else 0===f.status?(G.warn("FileLoaderX: HTTP Status 0 received."),b&&b(g)):c&&c(d)},!1),f.addEventListener("error",function(b){e._requests[a]&&delete e._requests[a],c&&c(b)},!1),void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials);for(var g in this.requestHeader)f.setRequestHeader(g,this.requestHeader[g]);return f.send(null),this._requests[a]=f,f},setPath:function(a){return this.path=a,this},setResponseType:function(a){return this.responseType=a,this},setWithCredentials:function(a){return this.withCredentials=a,this},setMimeType:function(a){return this.mimeType=a,this},setCacheViable:function(a){return this.cacheViable=a,this},setRequestHeader:function(a){return this.requestHeader=a,this},_sliceStringResponseIfNeed:function(a){var b=1,c=31457280;if(a.size*b<=c)return[a];for(var d=[],e=Math.floor(c/b),f=Math.ceil(a.size/e),g=0;g<f;g+=1){var h=g*e,i=g===f-1?a.size:h+e,j=a.slice(h,i);d.push(j)}return d},_saveDrawToIndexDB:function(a,b){this._executeBlockInStorage(function(c){var d=c.dbName;if(1===b.length)c.put(a,b[0],d);else{for(var e=[],f=0,g=0;g<b.length;g+=1){f+=b[g].size;var h=a+"_"+g;e.push(h),c.put(h,b[g],d)}c.put(a,{split:!0,list:e,length:f},d)}},function(a){G.warn("保存图纸失败"),G.warn(a)})},_executeBlockInStorage:function(a,b){if(!this._storage){var c=this.modelKey+"draws",d=c;this._storage=new _b({store:d,version:1,dbName:c})}var e=this;this._storage.IDBOpenDBRequest?a(this._storage):(this._storage.addEventListener(ga.ON_DATABASE_OPEN,function(b){a(e._storage)}),this._storage.addEventListener(ga.ON_DATABASE_EEEOR,function(a){e._storage=void 0,b(a)}))}});var bc=function(){this.drawKey=void 0,this.modelKey=void 0,this.componentKey=void 0,this.componentPartKey=void 0,this.layerName=void 0,this._paths=void 0,this._boundingBox=new D};bc.prototype.isEmpty=function(){return!(this._paths&&this._paths.length>0)},bc.prototype.addPath=function(a){a&&(this._paths||(this._paths=[]),this._paths.push(a),a.boundingBox&&this._boundingBox.union(a.boundingBox))},bc.prototype.addPaths=function(a){a&&a.length>0&&(this._paths||(this._paths=[]),this._paths=this._paths.concat(a))},bc.prototype.removePathInLayer=function(a){if(a&&this._paths)for(var b=this._paths.length-1;b>=0;b-=1)this._paths[b].layerName===a&&this._paths.splice(b,1)},bc.prototype.addPathsFromGroup=function(a){if(a){var b=a.allPaths();b&&(this._paths||(this._paths=[]),this._paths=this._paths.concat(b))}},bc.prototype.allPaths=function(){return this._paths},bc.prototype.render=function(a,b,c,d,e,f){for(var g=0,h=this._paths.length;g<h;g+=1){var i=this._paths[g];i&&i._render(a,b,c,d,e,f)}},bc.prototype._isOnScreen=function(a,b){if(this._boundingBox&&!this._boundingBox.isEmpty()){var c=this._boundingBox.clone(),d=new Ra;d.fromCanvasTransform(b[0],b[1],b[2],b[3],b[4],b[5]);var e=c.applyMatrix3(d);if(!a.intersectsBox(e)&&!e.intersectsBox(a))return!1}return!0};var cc=function(a){var b=a.split("_");if(4===b.length)return b[0]+"_"+b[1]},dc=function(a){this.drawKey=void 0,this.modelKey=void 0,this.boundingBox=void 0,this.name=void 0,this.layers=void 0,this.components=void 0,this.viewer=a,this._allPaths=void 0,this._localMatrix=void 0,this._boundingPath=void 0,this._isShowBoundingBox=!0,this.quadTree=void 0};dc.prototype.localMatrixWithCanvasSize=function(a,b){if(!this._localMatrix){if(!this.boundingBox)return new Ra;var c=a/b,d=this.boundingBox,e=d.getSize(new B),f=d.getCenter(new B),g=a/2,h=b/2,i=e.x/e.y,j=a,k=b;c>i?j=k*i:k=j/i;var l=j/e.x,m=k/e.y,n=g-f.x,o=h-f.y,p=new Ra;p.translate(n,o);var q=new Ra;q.translate(f.x,f.y);var r=new Ra;r.scale(l,m);var s=new Ra;s.translate(-f.x,-f.y);var t=new Ra;t.multiply(p),t.multiply(q),t.multiply(r),t.multiply(s),this._localMatrix=t}return this._localMatrix},dc.prototype.clearLocalMatrix=function(){this._localMatrix=void 0},dc.prototype.clearCachedBoundingBox=function(){for(var a=Object.values(this.components),b=0,c=a.length;b<c;b+=1){var d=a[b];d.clearCachedBoundingBox()}},dc.prototype.addLayer=function(a){this.layers||(this.layers=[]),this.layers.push(a)},dc.prototype.addPath=function(a){this._allPaths||(this._allPaths=[]),this._allPaths.push(a)},dc.prototype.showLayer=function(a){if(a&&this.layers)for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];if(a.name===d.name)return d.isVisible=!0,!0}return!1},dc.prototype.hideLayer=function(a){if(a&&this.layers)for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];if(a.name===d.name)return d.isVisible=!1,!0}return!1},dc.prototype.showAllLayer=function(){var a=!1;if(this.layers)for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];d.isVisible!==!0&&(d.isVisible=!0,a=!0)}return a},dc.prototype.setLayerColor=function(a,b){if(a&&b&&this.layers)for(var c=0,d=this.layers.length;c<d;c+=1){var e=this.layers[c];if(a===e.name)return e.layerColor=b,!0}return!1},dc.prototype.setAllLayerColor=function(a){if(a&&this.layers){for(var b=0,c=this.layers.length;b<c;b+=1)this.layers[b].layerColor=a;return!0}return!1},dc.prototype.clearAllCustomLayerColor=function(){if(this.layers){for(var a=0,b=this.layers.length;a<b;a+=1)this.layers[a].layerColor=void 0;return!0}return!1},dc.prototype.hideAllLayer=function(){var a=!1;if(this.layers)for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];d.isVisible!==!1&&(d.isVisible=!1,a=!0)}return a},dc.prototype.layerIsVisible=function(a){if(!this.layers)return!0;for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];if(a===d.name)return d.isVisible}return!1},dc.prototype.hiddenLayers=function(){var a=[];if(this.layers)for(var b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b];d.isVisible===!1&&a.push(d.name)}return a.length>0?a:void 0},dc.prototype.getVisiblePathsOfComponent=function(a){if(a&&this.components){var b=this.components[a];if(b&&b.parts){for(var c=new bc,d=0,e=b.parts.length;d<e;d+=1){var f=b.parts[d];this.layerIsVisible(f.layerName)&&c.addPaths(f.getAllPaths())}if(!c.isEmpty())return c.modelKey=this.modelKey,c.componentKey=a,c.drawKey=this.drawKey,c.userId=a,c}}return!1},dc.prototype.getVisiblePathsOfComponentPart=function(a){if(a&&this.components){var b=cc(a),c=this.components[b];if(c&&c.parts)for(var d=0,e=c.parts.length;d<e;d+=1){var f=c.parts[d];if(f.partKey===a&&this.layerIsVisible(f.layerName)){var g=new bc;return g.addPaths(f.getAllPaths()),g.modelKey=this.modelKey,g.componentKey=b,g.componentPartKey=f.partKey,g.drawKey=this.drawKey,g.userId=f.partKey,g}}}},dc.prototype.componentPartsInScreenBox=function(a,b,c){var d=[];for(var e in this.components)if(this.components.hasOwnProperty(e))for(var f=this.components[e],g=0,h=f.parts.length;g<h;g+=1){var i=f.parts[g],j=i.getBoundingBoxes(this._localMatrix);if(j&&j.world){var k=j.world,l=k.clone().applyMatrix3(b);c?(a.containsBox(l)||l.containsBox(a))&&d.push(i.partKey):(a.intersectsBox(l)||l.intersectsBox(a))&&d.push(i.partKey)}}if(d.length>0)return d},dc.prototype.allComponentPartKeysOfComponents=function(a){if(this.components&&a){for(var b=[],c=0,d=a.length;c<d;c+=1){var e=this.components[a[c]];if(e){var f=e.allPartKeys();f&&(b=b.concat(f))}}return b}},dc.prototype.getComponentBoundingBoxes=function(a){if(a&&this.components){var b=this.components[a];if(b)return b.getBoundingBoxes(this._localMatrix)}},dc.prototype.getComponentPartBoundingBoxes=function(a){if(a&&this.components){var b=cc(a),c=this.components[b];if(c)return c.getPartBoundingBoxes(this._localMatrix,a)}},dc.prototype.getAllLayerBaseInfo=function(){if(this.layers){for(var a=[],b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b],e={};e.name=d.name,e.layerColor=d.layerColor,e.drawKey=this.drawKey,e.modelKey=this.modelKey,e.isVisible=d.isVisible,a.push(e)}return a}},dc.prototype.getAllLayerBaseInfoObject=function(){if(this.layers){for(var a={},b=0,c=this.layers.length;b<c;b+=1){var d=this.layers[b],e={};e.name=d.name,e.layerColor=d.layerColor,e.drawKey=this.drawKey,e.modelKey=this.modelKey,e.isVisible=d.isVisible,a[d.name]=e}return a}},dc.prototype.getAllPaths=function(){return this._allPaths},dc.prototype.render=function(a,b,c,d,e,f){if(this.components){var g=this.getAllLayerBaseInfoObject(),h=!0;if(f){var i=Object.keys(this.components);f.length===i.length&&(h=!1);for(var j=new Array(i.length),k=0,l=f.length;k<l;k+=1){var m=this.modelKey+"_"+f[k],n=this.components[m];j[n.orderIndex]=m}for(var o=0,p=j.length;o<p;o+=1){var q=j[o];if(q){var r=this.components[q];r&&r.render({ctx:a,box:b,viewportTransform:c,zoom:d,overrideMaterial:e,layersInfo:g,needCheckIfOnScreen:h})}}}else for(var s=Object.values(this.components),t=0,u=s.length;t<u;t+=1){var v=s[t];v.render({ctx:a,box:b,viewportTransform:c,zoom:d,overrideMaterial:e,layersInfo:g,needCheckIfOnScreen:h})}}if(this._isShowBoundingBox){if(!this._boundingPath&&this.boundingBox){var w=this.boundingBox.min.x,x=this.boundingBox.min.y,y=this.boundingBox.max.x,z=this.boundingBox.max.y,A=new Path2D;A.moveTo(w,x),A.lineTo(y,x),A.lineTo(y,z),A.lineTo(w,z),A.closePath(),this._boundingPath=A}this._boundingPath&&(a.save(),a.strokeStyle="#ffffff",a.stroke(this._boundingPath),a.restore())}if(Z.DEBUG)for(var B in this.components)if(this.components.hasOwnProperty(B)){var C=this.components[B];C.drawBoundingBox(a)}},dc.prototype.isUserIdExist=function(a){return!0},dc.prototype.getBoundingBox=function(){return this.boundingBox?this.boundingBox.clone():null};var ec=new D,fc=function(){this.layerName=void 0,this.partKey=void 0,this.boundingBox=void 0,this.worldBoundingBox=void 0,this._paths=void 0,this._viewBoxInHitTest=void 0};fc.prototype.addPath=function(a){a&&(this._paths||(this._paths=[]),this._paths.push(a))},fc.prototype.getAllPaths=function(){return this._paths},fc.prototype.getBoundingBoxes=function(a){if(this.boundingBox){var b=ec.copy(this.boundingBox);return this.worldBoundingBox||a&&(this.worldBoundingBox=b.clone().applyMatrix3(a)),{local:b,world:this.worldBoundingBox?this.worldBoundingBox:b}}},fc.prototype.clearCachedBoundingBox=function(){this.worldBoundingBox=void 0;for(var a=0,b=this._paths.length;a<b;a+=1){var c=this._paths[a];c.worldBoundingBox=void 0}},fc.prototype.hitTest=function(a,b,c,d){if(this._paths){var e=this.getBoundingBoxes(d);if(e){var f=e.world,g=this._viewBoxInHitTest;if(g||(g=f.clone().applyMatrix3(c),Math.round(g.min.x)===Math.round(g.max.x)&&(g.min.x-=a,g.max.x+=a),Math.round(g.min.y)===Math.round(g.max.y)&&(g.min.y-=a,g.max.y+=a),this._viewBoxInHitTest=g),g.containsPoint(b))for(var h=0,i=this._paths.length;h<i;h+=1){var j=this._paths[h];if(j.hitTest(a,b,c,d))return j}}}},fc.prototype.isOnScreen=function(a){var b=this.getBoundingBoxes();if(b){var c=b.local;return a.intersectsBox(c)||c.intersectsBox(a)?[!0,a.containsBox(c)]:[!1,!1]}return[!0,!0]},fc.prototype.render=function(a){var b=a.ctx,c=a.box,d=a.viewportTransform,e=a.zoom,f=a.overrideMaterial,g=a.needCheckIfOnScreen;if(this._paths){var h=!0;if(g){var i=this.isOnScreen(c);h=i[0],h&&(g=!i[1])}if(h){this._viewBoxInHitTest=void 0;for(var j=0,k=this._paths.length;j<k;j+=1){var l=this._paths[j];l._render(b,c,d,e,f,!1,g)}}}};var gc=function(){this.componentKey=void 0,this.parts=[],this.orderIndex=-1,this.boundingBox=void 0,this.worldBoundingBox=void 0,this._viewBoxInHitTest=void 0};gc.prototype.addPart=function(a){a&&(this.parts||(this.parts=[]),this.parts.push(a))},gc.prototype.allPartKeys=function(){if(this.parts&&this.parts.length>0){for(var a=[],b=0,c=this.parts.length;b<c;b+=1){var d=this.parts[b];a.push(d.partKey)}return a}},gc.prototype.getBoundingBoxes=function(a){if(!this.boundingBox&&this.parts){for(var b=new D,c=0,d=this.parts.length;c<d;c+=1){var e=this.parts[c],f=e.boundingBox;f&&(b.expandByPoint(f.min),b.expandByPoint(f.max))}b.isEmpty()||(this.boundingBox=b)}if(this.boundingBox){var g=this.boundingBox.clone();return this.worldBoundingBox||a&&(this.worldBoundingBox=g.clone().applyMatrix3(a)),{local:g,world:this.worldBoundingBox?this.worldBoundingBox:g.clone()}}},gc.prototype.getPartBoundingBoxes=function(a,b){if(this.parts&&this.parts.length>0)for(var c=0,d=this.parts.length;c<d;c+=1){var e=this.parts[c];if(e.partKey===b){var f=e.boundingBox.clone();return{local:f,world:a?f.clone().applyMatrix3(a):f.clone()}}}},gc.prototype.clearCachedBoundingBox=function(){this.worldBoundingBox=void 0;for(var a=0,b=this.parts.length;a<b;a+=1){var c=this.parts[a];c.clearCachedBoundingBox()}},gc.prototype.drawBoundingBox=function(a){if(this.boundingBox){if(!this._boundingPath){var b=this.boundingBox.min.x,c=this.boundingBox.min.y,d=this.boundingBox.max.x,e=this.boundingBox.max.y,f=new Path2D;f.moveTo(b,c),f.lineTo(d,c),f.lineTo(d,e),f.lineTo(b,e),f.closePath(),this._boundingPath=f}a.save(),a.strokeStyle="#0000ff",a.stroke(this._boundingPath),a.restore()}},gc.prototype.hitTest=function(a,b,c,d,e,f){if(this.parts){var g=this.getBoundingBoxes(e);if(g){var h=g.world,i=this._viewBoxInHitTest;if(i||(i=h.clone().applyMatrix3(d),Math.round(i.min.x)===Math.round(i.max.x)&&(i.min.x-=a,i.max.x+=a),Math.round(i.min.y)===Math.round(i.max.y)&&(i.min.y-=a,i.max.y+=a),this._viewBoxInHitTest=i),i.containsPoint(c))for(var j=0,k=this.parts.length;j<k;j+=1){var l=this.parts[j],m=!1;if(f)for(var n=0;n<f.length;n+=1)if(f[n]===l.layerName){m=!0;break}if(!m){var o=l.hitTest(a,c,d,e);if(o)return{path:o,part:l}}}}}},gc.prototype.isOnScreen=function(a){var b=this.getBoundingBoxes();if(b){var c=b.local;return a.intersectsBox(c)||c.intersectsBox(a)?[!0,a.containsBox(c)]:[!1,!1]}return[!0,!0]},gc.prototype.render=function(a){this._viewBoxInHitTest=void 0;var b=(a.ctx,a.box),c=(a.viewportTransform,a.zoom,a.overrideMaterial),d=a.layersInfo,e=a.needCheckIfOnScreen,f=!0;if(e){var g=this.isOnScreen(b);f=g[0],f&&(a.needCheckIfOnScreen=!g[1])}if(f)for(var h=0,i=this.parts.length;h<i;h+=1){var j=this.parts[h],k=!1;if(d){var l=d[j.layerName];l&&(l.isVisible===!1?k=!0:!c&&l.layerColor&&(a.overrideMaterial={color:l.layerColor}))}k||j.render(a)}};var hc=function(){this.drawKey=void 0,this.modelKey=void 0,this.name=void 0,this.lineWeight=void 0,this.isVisible=!0,this.layerColor=void 0,this.groups=void 0},ic=function(){function a(){e(this,a),this.strokePath=null,this.strokeStyle=null,this.fillPath=null,this.fillStyle=null}return g(a,[{key:"addStroke",value:function(a,b){b===this.strokeStyle?this.strokePath.addPath(a):(this._renderStroke(),this.strokeStyle=b,this.strokePath=new Path2D(a))}},{key:"addFill",value:function(a,b){b===this.fillStyle?this.fillPath.addPath(a):(this._renderFill(),this.fillStyle=b,this.fillPath=new Path2D(a))}},{key:"setCtx",value:function(a){this.ctx=a}},{key:"_renderStroke",value:function(){this.strokeStyle&&(this.ctx.strokeStyle=this.strokeStyle,this.ctx.stroke(this.strokePath))}},{key:"_renderFill",value:function(){this.fillStyle&&(this.ctx.fillStyle=this.fillStyle,this.ctx.fill(this.fillPath))}},{key:"render",value:function(){this._renderFill(),this._renderStroke(),this.strokePath=null,this.strokeStyle=null,this.fillPath=null,this.fillStyle=null}}]),a}(),jc=new ic,kc=function(a){this.data=a,this.path=new Path2D(a),this.visible=!0;var b=$a.getBox2FromPath(a);this.boundingBox=b.box,this.keyPoints=b.keyPoints,this.worldBoundingBox=void 0,this.fill="none",this.stroke="none",this._isShowBoundingBox=!1,this._viewBoxInHitTest=void 0};Object.assign(kc.prototype,{constructor:kc,isNotVisible:function(){return!this.visible||0===this.opacity||0===this.width&&0===this.height&&0===this.strokeWidth},set:function(a,b){return"object"===d(a)?this._setObject(a):"function"==typeof b&&"clipTo"!==a?this._set(a,b(this.get(a))):this._set(a,b),this},isOnScreen:function(a){if(this.boundingBox){var b=ec.copy(this.boundingBox);if(!a.intersectsBox(b)&&!b.intersectsBox(a))return!1}return!0},needRenderWithZoom:function(a,b,c){if(this.boundingBox){var d=this.boundingBox.clone(),e=new Ra;e.fromCanvasTransform(b[0],b[1],b[2],b[3],b[4],b[5]);var f=d.applyMatrix3(e),g=f.getSize(new B);if(a>5&&g.x<200&&g.y<200)return!1}return!0},getBoundingBoxes:function(a){if(this.boundingBox){var b=this.boundingBox.clone();return this.worldBoundingBox||(a?this.worldBoundingBox=b.clone().applyMatrix3(a):this.worldBoundingBox=b.clone()),{local:b,world:this.worldBoundingBox.clone()}}},hitTest:function(a,b,c,d){var e=this.getBoundingBoxes(d);if(e){var f=e.world,g=this._viewBoxInHitTest;if(g||(g=f.clone().applyMatrix3(c),Math.round(g.min.x)===Math.round(g.max.x)&&(g.min.x-=a,g.max.x+=a),Math.round(g.min.y)===Math.round(g.max.y)&&(g.min.y-=a,g.max.y+=a),this._viewBoxInHitTest=g),g.containsPoint(b))return this}},_set:function(a,b){this[a]=b},_setObject:function(a){for(var b in a)this._set(b,a[b])},_setStrokeStyles:function(a,b){b.color&&(a.strokeStyle=b.color),b.stroke&&(a.strokeStyle=b.stroke)},_setFillStyles:function(a,b){b.color&&(a.fillStyle=b.color),b.fill&&(a.fillStyle=b.fill)},_render:function(a,b,c,d,e,f,g){this._viewBoxInHitTest=void 0;var h=this.boundingBox.getSize(new B);if(!(!f&&h.x<d&&h.y<d)&&(!g||this.isOnScreen(b))&&(e&&e.color?(this.fill&&"none"!==this.fill&&jc.addFill(this.path,e.color),this.stroke&&"none"!==this.stroke&&jc.addStroke(this.path,e.color)):(!f&&this.fill&&"none"!==this.fill&&jc.addFill(this.path,this.fill),this.stroke&&"none"!==this.stroke&&jc.addStroke(this.path,this.stroke)),this._isShowBoundingBox)){if(!this._boundingPath){var i=this.boundingBox.min.x,j=this.boundingBox.min.y,k=this.boundingBox.max.x,l=this.boundingBox.max.y,m=new Path2D;m.moveTo(i,j),m.lineTo(k,j),m.lineTo(k,l),m.lineTo(i,l),m.closePath(),this._boundingPath=m}a.save(),a.strokeStyle="#000000",a.stroke(this._boundingPath),a.restore()}},intersectBox:function(a){},intersectPoint:function(a,b,c){this.worldBoundingBox.containsPoint(a)&&($a.isTransparent(c,a.x,a.y,3)||b.push[this])}});var lc=function(a){var b=new B(a.Min_X,a.Min_Y),c=new B(a.Max_X,a.Max_Y);return new D(b,c)},mc=function(a,b,c){var d=new dc;d.drawKey=b,d.modelKey=c;var e={};e="string"==typeof a?JSON.parse(a):a,d.boundingBox=lc(e.FileInfo.BoundBox),d.name=e.FileInfo.FileName;for(var f=Object.keys(e.Layers),g=0,h=f.length;g<h;g+=1){var i=e.Layers[g];if(i){var j=new hc;j.name=i.Name,j.lineWeight=i.lineWeight,j.modelKey=c,j.drawKey=b,d.addLayer(j)}}var k={},l=e.Elements,m=0;for(var n in l)if(l.hasOwnProperty(n)){var o=l[n],p=c+"_"+n,q=p+"_"+b,r=new gc;r.componentKey=p,r.orderIndex=m,m+=1;for(var s in o)if(o.hasOwnProperty(s)){var t=o[s],u=t.P.Layer,v=t.G.Path;if(v&&v.length>0){var w=new fc;w.boundingBox=lc(t.P.Bound),w.layerName=u,w.partKey=q+"_"+s,r.addPart(w);for(var x=t.G.Stroke,y=t.G.Fill,z=0,A=v.length;z<A;z+=1){var B=new kc(v[z]);x&&(B.stroke=x[z]),y&&y[z]&&y[z].length>0&&(B.fill=y[z]),B.userId=n,w.addPath(B),d.addPath(B,u)}}}k[r.componentKey]=r}return d.components=k,d},nc=function(a,b,c){var d=new dc;d.drawKey=b,d.modelKey=c;var e={};e="string"==typeof a?JSON.parse(a):a;var f={},g=0;for(var h in e)if(e.hasOwnProperty(h)){var i=e[h],j=b+"_"+h,k=new gc;k.componentKey=j,k.orderIndex=g,g+=1;for(var l in i)if(i.hasOwnProperty(l)){var m=i[l],n=m.P.Layer,o=m.G.Path;if(o&&o.length>0){var p=new fc;p.boundingBox=lc(m.P.Bound),p.layerName=n,k.addPart(p);for(var q=m.G.Stroke,r=m.G.Fill,s=0,t=o.length;s<t;s+=1){var u=new kc(o[s]);q&&(u.stroke=q[s]),r&&r[s]&&r[s].length>0&&(u.fill=r[s]),u.userId=h,p.addPath(u),d.addPath(u,n)}}}f[k.componentKey]=k}return d.components=f,d},oc={};oc.Url=function(a,b,c){this.serverUrl=a,this.drawKey=b,this.dbName=c},oc.Url.prototype.projectUrl=function(){return this.offLine?this.serverUrl+"/"+this.drawKey+"/resource/scene/scene.json":this.serverUrl+"/api/"+this.dbName+"/drawings/list?pkgKey="+this.drawKey},oc.Url.prototype.dataUrl=function(a){return this.apiVersion>=1.6?this.serverUrl+"/data?fileKey="+a:this.serverUrl+"/api/"+this.dbName+"/files?fileKey="+a},oc.Url.prototype.modelInfoUrl=function(a){return this.serverUrl+"/api/"+this.dbName+"/models?modelKey="+(a||this.modelKey)};var pc=function(a,b,c){var d=this,e=!1,f=0,g=0,h=void 0;this.onStart=void 0,this.onLoad=a,this.onProgress=b,this.onError=c,this.itemStart=function(a){g+=1,e===!1&&void 0!==d.onStart&&d.onStart(a,f,g),e=!0},this.itemEnd=function(a){f+=1,void 0!==d.onProgress&&d.onProgress(a,f,g),f===g&&(e=!1,void 0!==d.onLoad&&d.onLoad())},this.itemError=function(a){void 0!==d.onError&&d.onError(a)},this.resolveURL=function(a){return h?h(a):a},this.setURLModifier=function(a){return h=a,this}},qc=function(a){this.MaxThreadCount=a||8,this.todoList=[],this.doingCount=0,this.addItem=function(a){void 0!==a&&this.todoList.push(a)},this.run=function(a,b,c){function d(i){i>=f?h.doingCount<1&&(h.run(a,b,c),b(h.doingCount,f),c()):(b(h.doingCount,f),a(e[i],i+g,d))}if(!(this.doingCount>0)){if(0===this.todoList.length)return void c();var e=this.todoList,f=e.length;this.todoList=[],this.doingCount=f;for(var g=Math.min(this.MaxThreadCount,Z.ConcurrencyRequestCount,f),h=this,i=0;i<g;i+=1)d(i)}}},rc=function(a,b){this.type=b,this.manager=a,this.worker=new qc(4)};rc.prototype={constructor:rc,addTask:function(a){this.worker.addItem(a)},processTasks:function(a,b,c){function d(b,c,d){a(b,function(){e.doingCount-=1,d(c)})}b=b||function(){},c=c||function(){};var e=this.worker;this.worker.run(d,b,c)}},oc.DrawPackageLoader=function(a,b,c){this.modelKey=a,this.serverUrl=b.serverUrl,this.dbName=b.dbName,this.viewerImpl=c,this.dataVersion=null,this.defaultLevel="level5",this.taskManager=new rc(this),this.drawListUrl=b.serverUrl+"/api"+b.dbName+"/drawings/list?pkgKey="+b.modelKey,this.url=new oc.Url(b.serverUrl,b.modelKey,b.dbName),this.loader=new ac(a,this.url),this.accessToken=b.token,this.loadTaskCount=0,this.maxLoadTaskCount=0,this._drawPackage=void 0},oc.DrawPackageLoader.prototype=Object.create(pc.prototype),oc.DrawPackageLoader.prototype.constructor=oc.DrawPackageLoader,oc.DrawPackageLoader.prototype.load=function(a){var b=this;this.checkModelInfo(this.modelKey,function(c){c?b.dispatchEvent({type:ba.DRAW_LOAD_ERROR,error:c}):b._load(a)})},oc.DrawPackageLoader.prototype.cancelLoad=function(){this.loader.cancelLoad()},oc.DrawPackageLoader.prototype._load=function(a){var b=this;this.notifyProgress=a,this.dispatchEvent({type:ba.DRAW_LIST_LOAD_START,modelKey:this.modelKey}),this._loadDrawPackage(this.modelKey,function(a,c){if(a){var d=new Zb(b.viewerImpl);d.drawList=a,d.dbName=b.dbName,d.serverUrl=b.serverUrl,b._drawPackage=d,b._loadDraws(),b.dispatchEvent({type:ba.DRAW_LIST_LOAD_COMPLETE,modelKey:b.modelKey,drawPackage:d})}else b.dispatchEvent({type:ba.DRAW_LOAD_ERROR,error:c?c:"图纸数据为空"})})},oc.DrawPackageLoader.prototype.checkModelInfo=function(a,b){var c=this.url.modelInfoUrl(a);Ia({type:"GET",url:c,success:function(a){if(a){var c=a;if("string"==typeof c)try{c=JSON.parse(a)}catch(d){return void b("解析模型信息出错")}"SUCCESS"===c.code?"3"===c.data.status?b():b(c.data.remark?c.data.remark:"图纸尚未解析完成"):b(c.message?c.message:"获取模型信息错误")}},error:function(a){G.error("获取模型信息错误"),b("获取模型信息错误")}})},oc.DrawPackageLoader.loadFromLocal=function(a,b){Ia({type:"GET",url:a,success:function(c){if(c){var d=mc(c,a,a);d&&(d.modelKey=a,d.drawKey=a,b&&b(d))}},error:function(a){G.error("加载本地图纸错误")}})},oc.DrawPackageLoader.loadAxisNetFromLocal=function(a,b){Ia({type:"GET",url:a,success:function(c){if(c){var d=nc(c,a,a);d&&(d.modelKey=a,d.drawKey=a,b&&b(d))}},error:function(a){G.error("加载本地轴网错误")}})},oc.DrawPackageLoader.prototype._loadDrawPackage=function(a,b){var c=this.url.projectUrl(a);Ia({type:"GET",url:c,headers:{Authorization:this.accessToken},success:function(a){if(a=JSON.parse(a),"SUCCESS"===a.code){var c=a.data,d=void 0;c&&c.length>0?d=c:(G.warn("该模型没有图纸"),b(void 0,"该模型没有图纸")),b(d,void 0)}else G.error("加载图纸列表错误"),G.error(a),b(void 0,a.message)},error:function(a){G.error("加载图纸列表错误"),b()}})},oc.DrawPackageLoader.prototype._onTaskFinished=function(a){if(this.loadTaskCount+=1,this.notifyProgress){var b={total:this.maxLoadTaskCount,loaded:this.loadTaskCount,draw:a};this.dispatchEvent({type:ba.ONE_DRAW_LOAD_COMPLETE,progress:b,drawPackage:this._drawPackage})}this.loadTaskCount>=this.maxLoadTaskCount&&(G.timeEnd("数据加载时间"),this._dataLoaded=!0,this._loadingOnDemand=!1,this.dispatchEvent({type:ba.ALL_DRAW_LOAD_COMPLETE,modelKey:this.modelKey}))},oc.DrawPackageLoader.prototype._loadDraws=function(){var a=this._drawPackage.drawList,b=this,c=a.length||0;if(b.loadTaskCount=0,b.maxLoadTaskCount=0,b.maxLoadTaskCount+=c,b.maxLoadTaskCount<1)return void G.info("Nothing to load ",this.modelKey);G.time("数据加载时间");for(var d=[],e=0,f=a.length;e<f;e+=1)d.push(a[e].fileKey);for(var g=this.taskManager,h=0;h<d.length;h+=1)g.addTask(d[h]);g.processTasks(this._loadDraw.bind(this))},oc.DrawPackageLoader.prototype._loadDraw=function(a,b){var c=this,d=this.loader,e=this._drawPackage;d.setResponseType("json"),d.loadDraw(a,function(f){var g=e.getDrawListItemByFileKey(a),h=g.key,i=c._parseDraw(f,h);if(i){if(g.treeKey){var j=d.url.dataUrl(g.treeKey);oc.DrawPackageLoader.loadQuadTree(j,function(a){i.quadTree=a})}e.addDraw(i)}b(),c._onTaskFinished(i)},function(){b(),c._onTaskFinished(),c.dispatchEvent({type:ba.DRAW_LOAD_ERROR,error:"图纸加载错误"})})},oc.DrawPackageLoader.loadQuadTree=function(a,b){Ia({type:"GET",url:a,success:function(a){var c=void 0;a&&(c=new $b(a)),b&&b(c)},error:function(a){G.error("加载图纸四叉树错误"),b&&b(void 0)}})},oc.DrawPackageLoader.prototype._parseDraw=function(a,b){G.time("解析draw");var c=mc(a,b,this.modelKey);return G.timeEnd("解析draw"),c},oc.DrawPackageLoader.prototype._parse=function(a){var b={},c=a.split('"'),d=c[0].split(" "),e={};d.length>1&&(b.type=d[0],e[d[1].slice(0,d[1].length-1)]=c[1]);for(var f=2;f<c.length;f+=2)c[f].endsWith("=")&&(e[c[f].slice(0,c[f].length-1)]=c[f+1]);return b.attr=e,b},oc.DrawPackageLoader.prototype.destroy=function(){this.taskManager=null,this.loader=null},oc.DrawPackageLoader.prototype.setCrossOrigin=function(a){this.loader.setCrossOrigin(a)},Object.assign(oc.DrawPackageLoader.prototype,J.prototype);var sc=function(a){this.selectionSet={},this.selectionMaterial="#ff0000",this.hoverId=void 0,this.hoverMaterialDefaultParams={color:14540253,opacity:.9,transparent:!0},this.hoverMaterial="#00ff00",this.boxMaterialDefaultParams={color:16776960,opacity:1,transparent:!1},this.modelManager=a,this.blinkComponentIds={}};sc.prototype={constructor:sc,_dispatchChangeEvent:function(){var a=this.getSelection();this.modelManager.dispatchEvent({type:ga.ON_SELECTION_CHANGED,selectionList:a})},clearSelection:function(){var a=!1;for(var b in this.selectionSet)if(this.selectionSet.hasOwnProperty(b)){a=!0,this.selectionSet={};break}a&&(this.modelManager.clearSelection(),this._dispatchChangeEvent())},addSelection:function(a){if(a){for(var b=this.selectionSet,c=!1,d=a.length-1;d>=0;d-=1)b.hasOwnProperty(a[d])||(b[a[d]]=!0,c=!0);c&&(this.modelManager.applySelection(),this._dispatchChangeEvent())}},setSelection:function(a){a||(a=[]);for(var b=[],c=a.length-1;c>=0;c-=1)this.modelManager.isUserIdExist(a[c])||b.push(a[c]);b.length>0&&this.modelManager.dispatchEvent({type:ga.ON_SELECTION_FAILED,failedId:b});for(var d=this.selectionSet={},c=a.length-1;c>=0;c-=1)d[a[c]]=!0;this.modelManager.applySelection(),this._dispatchChangeEvent()},removeSelection:function(a){var b=!1,c=this.selectionSet;if(a&&a.length>0)for(var d=0,e=a.length;d<e;d+=1){var f=a[d];c.hasOwnProperty(f)&&(delete c[f],b=!0)}b&&(this.modelManager.applySelection(),this._dispatchChangeEvent())},getSelection:function(){var a=[];for(var b in this.selectionSet)a.push(b);return a},getSelectionSet:function(){return this.selectionSet},isSelected:function(a){return this.selectionSet.hasOwnProperty(a)},setHoverId:function(a,b){this.hoverId=a,this.hoverObj=b,this.modelManager.applyHover()},clearHover:function(){this.hoverId=void 0,this.hoverObj=void 0,this.modelManager.clearHover()},getHoverMaterial:function(a){var b=this.hoverMaterial.clone();if(a&&a.hasOwnProperty("color")){var c=a.color.clone(),d=Math.max(c.r,Math.max(c.g,c.b));0===d&&(d=.5),c.r+=0===c.r?.3*d:.2*c.r,c.g+=0===c.g?.3*d:.2*c.g,c.b+=0===c.b?.3*d:.2*c.b,c.r>1&&(c.r=1),c.g>1&&(c.g=1),c.b>1&&(c.b=1),1===c.r&&1===c.g&&1===c.b&&(c.r=.87,c.g=.87,c.b=.87),b.color.setHex(c.getHex()),void 0!==a.opacity?b.opacity=a.opacity:b.opacity=this.hoverMaterialDefaultParams.opacity,void 0!==a.transparent?b.transparent=a.transparent:b.transparent=this.hoverMaterialDefaultParams.transparent,void 0!==a.side?b.side=a.side:b.side=this.hoverMaterialDefaultParams.side,void 0!==a.metalness&&(b.metalness=a.metalness),void 0!==a.roughness&&(b.roughness=a.roughness),void 0!==a.bumpMap&&(b.bumpMap=a.bumpMap),void 0!==a.alphaMap&&(b.alphaMap=a.alphaMap),void 0!==a.emissiveMap&&(b.emissiveMap=a.emissiveMap),void 0!==a.envMap&&(b.envMap=a.envMap),void 0!==a.envMapIntensity&&(b.envMapIntensity=a.envMapIntensity),
void 0!==a.map&&null!==a.map&&(b.map=a.map,b.opacity*=.9,b.transparent=!0),b.needsUpdate=!0}return b},setSelectionColor:function(a,b){var c=this.selectionMaterial.color,d=this.selectionMaterial.opacity;b=void 0===b?d:b,"0x"+c.getHexString()===a&&d===b||(this.selectionMaterial.color.setHex(a),b&&(this.selectionMaterial.opacity=b),this.selectionMaterial.needsUpdate=!0,this.selectionMaterial.color.setHex(a),this.selectionMaterial.needsUpdate=!0)},getSelectionMaterial:function(){return this.selectionMaterial.clone()},setBlinkComponentsById:function(a){if(this.blinkComponentIds={},a&&0!==a.length){for(var b=a.length-1;b>=0;b-=1)this.blinkComponentIds[a[b]]=!0;this.modelManager.applyBlink()}},addBlinkComponentsById:function(a){if(a&&a.length){for(var b=this.blinkComponentIds,c=!1,d=a.length-1;d>=0;d-=1)b[a[d]]||(b[a[d]]=!0,c=!0);c&&this.modelManager.applyBlink()}},clearBlinkComponentsById:function(a){if(a&&a.length){for(var b=!1,c=this.blinkComponentIds,d=0,e=a.length;d<e;d+=1){var f=a[d];c[f]&&(delete c[f],b=!0)}b&&this.modelManager.applyBlink()}},clearAllBlinkComponents:function(){var a=!1,b=this.blinkComponentIds;X.isOwnEmptyObject(b)||(a=!0,this.blinkComponentIds={}),a&&this.modelManager.clearBlink()},getBoxMaterial:function(){return this.boxMaterial.clone()},setBoxColor:function(a,b){var c=this.boxMaterial.color,d=this.boxMaterial.opacity;b=void 0===b?d:b,"0x"+c.getHexString()===a&&d===b||(this.boxMaterial.color.setHex(a),b&&(this.boxMaterial.opacity=b),this.boxMaterial.needsUpdate=!0,this.boxMaterial.color.setHex(a),this.boxMaterial.needsUpdate=!0)}};var tc=function(a,b){this.crossOrigin=!0,this.drawPackages={},this.filter=a,this.viewerImpl=b,this.sceneState=new sc(this),this._currentDrawKey=void 0,this._loaders={}};tc.prototype.load=function(a){var b=a.modelKey;if(b){var c=this.drawPackages,d=c[b],e=this;if(void 0===d){var f=new oc.DrawPackageLoader(b,a,this.viewerImpl);f.addEventListener(ba.ONE_DRAW_LOAD_COMPLETE,function(c){e.drawPackages[b]||(e.drawPackages[b]=c.drawPackage),e.dispatchEvent({type:ba.ONE_DRAW_LOAD_COMPLETE,draw:c.progress.draw}),a.onDrawLoad&&a.onDrawLoad(c.progress.draw)}),f.addEventListener(ba.ALL_DRAW_LOAD_COMPLETE,function(a){e.dispatchEvent({type:ba.ALL_DRAW_LOAD_COMPLETE,modelKey:a.modelKey,drawPackage:a.drawPackage}),e._loaders[b]&&delete e._loaders[b]}),f.addEventListener(ba.DRAW_LIST_LOAD_COMPLETE,function(b){e.dispatchEvent({type:ba.DRAW_LIST_LOAD_COMPLETE,modelKey:b.modelKey,drawPackage:b.drawPackage}),a.onDrawListLoad&&a.onDrawListLoad(b.drawPackage.drawList)}),f.addEventListener(ba.DRAW_LOAD_ERROR,function(c){e._loaders[b]&&delete e._loaders[b],a.onLoadError&&a.onLoadError(c.error)}),f.load(!0),this._loaders[b]=f}return d}},tc.prototype.cancelLoadIfNeed=function(a){if(this._loaders[a]){var b=this._loaders[a];b.removeAllEventListener(),b.cancelLoad(),delete this._loaders[a]}},tc.prototype.unload=function(a){if(this.drawPackages[a]){if(this._currentDrawKey)for(var b in this.drawPackages)if(this.drawPackages.hasOwnProperty(b)){var c=this.drawPackages[b],d=c.getDrawByDrawKey(this._currentDrawKey);if(d&&d.modelKey===a){this.removeCurrentDraw();break}}return delete this.drawPackages[a],this.cancelLoadIfNeed(a),!0}return this.cancelLoadIfNeed(a),!1},tc.prototype.unloadAll=function(){this.removeCurrentDraw();for(var a in this.drawPackages)this.drawPackages.hasOwnProperty(a)&&this.cancelLoadIfNeed(a);this.drawPackages={}},tc.prototype.loadDrawFromLocalHost=function(a,b){var c=this;oc.DrawPackageLoader.loadFromLocal(a,function(d){if(d){var e=new Zb(c.viewerImpl);e.drawList=[{name:a,key:a}],e.modelKey=a,e.addDraw(d),c.drawPackages[a]=e,b&&b(e.drawList)}})},tc.prototype.loadRevitAxisNetFromLoacalHost=function(a,b){var c=this;oc.DrawPackageLoader.loadAxisNetFromLocal(a,function(d){if(d){var e=new Zb(c.viewerImpl);e.drawList=[{name:a,key:a}],e.modelKey=a,e.addDraw(d),c.drawPackages[a]=e,b&&b(e.drawList)}})},tc.prototype.getDrawList=function(a,b){if(a){var c=this.drawPackages[a];if(c)return b&&b(c.drawList),c.drawList;this.addEventListener(ba.DRAW_LIST_LOAD_COMPLETE,function(c){if(c.modelKey===a){var d=c.drawPackage;b(d.drawList)}})}},tc.prototype.showDraw=function(a,b){if(a&&b&&this._currentDrawKey!==a){this._currentDrawKey=a,this.sceneState.clearHover(),this.sceneState.clearSelection();var c=void 0;for(var d in this.drawPackages)if(this.drawPackages.hasOwnProperty(d)){var e=this.drawPackages[d];if(c=e.getDrawByDrawKey(a))break}if(c)b(c);else if(Object.keys(this._loaders).length>0){this.removeAllEventListenerByType(ba.ONE_DRAW_LOAD_COMPLETE);var f=this;this.addEventListener(ba.ONE_DRAW_LOAD_COMPLETE,function(a){a.draw.drawKey===f._currentDrawKey&&b(a.draw)})}}},tc.prototype.removeCurrentDraw=function(){this._currentDrawKey&&(this._currentDrawKey=void 0,this.viewerImpl.camera.setViewportTransform([1,0,0,1,0,0]),this.sceneState.clearHover(),this.sceneState.clearSelection(),this.viewerImpl.render(!0))},tc.prototype.showDrawLayer=function(a){if(a){var b=this.drawPackages[a.modelKey];if(b){var c=b.getDrawByDrawKey(a.drawKey);if(c)return c.showLayer(a)}}return!1},tc.prototype.hideDrawLayer=function(a){if(a){var b=this.drawPackages[a.modelKey];if(b){var c=b.getDrawByDrawKey(a.drawKey);if(c){var d=c.hideLayer(a);return d}}}return!1},tc.prototype.showAllLayer=function(a){var b=this.getCurrentDraw();return!(!b||b.modelKey!==a)&&b.showAllLayer()},tc.prototype.hideAllLayer=function(a){var b=this.getCurrentDraw();if(b&&b.modelKey===a){var c=b.hideAllLayer();return c&&(this.sceneState.clearHover(),this.sceneState.clearSelection()),c}return!1},tc.prototype.getCurrentDraw=function(){if(this._currentDrawKey){var a=this._currentDrawKey;return this.getDraw(a)}},tc.prototype.getDraw=function(a){if(a)for(var b in this.drawPackages)if(this.drawPackages.hasOwnProperty(b)){var c=this.drawPackages[b],d=c.getDrawByDrawKey(a);if(d)return d}},tc.prototype.getAllDraws=function(){var a=[];for(var b in this.drawPackages)if(this.drawPackages.hasOwnProperty(b)){var c=this.drawPackages[b],d=c.getAllDraws();a=a.concat(d)}return a},tc.prototype.resetAllDrawLocalMatrix=function(){for(var a=this.getAllDraws(),b=0,c=a.length;b<c;b+=1){var d=a[b];d.clearLocalMatrix(),d.clearCachedBoundingBox()}},tc.prototype.highlightComponentsByKeys=function(a){if(a){var b=this.getCurrentDraw();if(b){for(var c=[],d=0,e=a.length;d<e;d+=1){var f=b.getVisiblePathsOfComponent(a[d]);c.push(f)}if(c.length>0)return this.sceneState.setSelection(c),!0}}return!1},tc.prototype.clearAllHighlightComponents=function(){var a=this.sceneState.getSelection();return a.length>0&&(this.sceneState.clearSelection(),!0)},tc.prototype.getComponentBoundingBoxes=function(a,b){var c=this.getCurrentDraw();if(c)return c.getComponentBoundingBoxes(a,b)},tc.prototype.applyFilter=function(){this.viewerImpl.render(!0)},tc.prototype.applySelection=function(){this.viewerImpl.render()},tc.prototype.clearSelection=function(){this.viewerImpl.render()},tc.prototype.applyHover=function(){this.viewerImpl.render()},tc.prototype.clearHover=function(){this.viewerImpl.render()},tc.prototype.isUserIdExist=function(a){var b=!1;for(var c in this.drawPackages)if(this.drawPackages.hasOwnProperty(c)){var d=this.drawPackages[c];if(d.isUserIdExist(a)){b=!0;break}}return b},Object.assign(tc.prototype,J.prototype);var uc=function(){this.domElement=null,this.camera=null,this.renderer=null,this.callbacks={},this.drawManager=new tc(this.filter,this),this.filter=null,this.uuid="",this.clipPlanes=null;var a=this;this._renderTimer=null,this.clock=new y,this._onSelectComponentCallBacks=void 0,this.tempVector2=new B;var b=this._onComponentPartSelect.bind(this);this.drawManager.addEventListener(ga.ON_CLICK_PICK,b),this.drawManager.addEventListener(ga.ON_RECTPICK_ADD,b),this.drawManager.addEventListener(ga.ON_RECTPICK_REMOVE,b),this.checkNeedRender=function(){a.needRender&&(a.needRender=!1,a._render()),requestAnimationFrame(a.checkNeedRender)},this._isBlackWhiteMode=!1};Object.assign(uc.prototype,J.prototype),Object.assign(uc.prototype,{constructor:uc,getDomElement:function(){return this.domElement?this.domElement:null},getViewerDiv:function(){return this.viewerDiv?this.viewerDiv:null},init:function(a){var b=this;this.domElement=a,a.style.background="#4a4a4a";var c=document.createElement("div");this.viewerDiv=c,this.domElement.appendChild(c),this.uuid=X.createUUID();var d=null;d=document.createElement("canvas"),d.style.outline="none",d.setAttribute("id","Viewer2D"+this.uuid);var e=a.offsetWidth,f=a.offsetHeight,g=d.getContext("2d");this.ctx=g,d.width=e,d.height=f,this.viewingBox=new D(new B(0,0),new B(e,f)),this.canvas=d;var h=null;h=document.createElement("canvas"),h.style.outline="none",h.style.position="absolute",h.style.top="0",h.style.left="0",h.setAttribute("id","Viewer2D_TEMP"+this.uuid),this.tempCanvas=h;var i=h.getContext("2d");this.tempCtx=i,h.width=e,h.height=f,c.appendChild(d),c.appendChild(h),this.camera=new Sa([1,0,0,1,0,0]),this.cameraControl=new bb(this,this.camera,c,function(a){b.render(a)}),this.controlManager=new Xb,this.controlManager.setControlMode(this,"pick"),this.controlManager.registerDomEventListeners(c),this.startRender()},load:function(a){return this.drawManager.load(a)},getClipPlanes:function(){if(null===this.clipPlanes){var a=this.drawManager.getCurrentDraw(),b=a.getBoundingBox();b&&(this.clipPlanes=new Yb(this,b,b.getSize(new B),b.getCenter(this.tempVector2)))}return this.clipPlanes},loadDrawFromLocalHost:function(a,b){a&&this.drawManager.loadDrawFromLocalHost(a,b)},loadRevitAxisNetFromLoacalHost:function(a,b){a&&this.drawManager.loadRevitAxisNetFromLoacalHost(a,b)},unload:function(a){var b=this.drawManager.unload(a);return 0===Object.keys(this.drawManager.drawPackages).length&&this.resetToInitial(),b},unloadAll:function(){this.drawManager.unloadAll(),this.resetToInitial()},resetToInitial:function(){this._onSelectComponentCallBacks=void 0,this.drawManager.removeAllEventListener()},showDraw:function(a,b){if(a){var c=this;this.drawManager.showDraw(a,function(a){if(a){if(c.camera.setViewportTransform([1,0,0,1,0,0]),c.clipPlanes&&c.clipPlanes.enabled){var d=c.drawManager.getCurrentDraw().boundingBox;c.clipPlanes.init(d)}c.render(!0),b?b(a.getAllLayerBaseInfo()):void 0,c.dispatchEvent({type:ba.SHOW_DRAW,data:a})}})}},showDrawLayer:function(a){this.drawManager.showDrawLayer(a)&&this.render(!0)},showAllLayer:function(a){this.drawManager.showAllLayer(a)&&this.render(!0)},hideAllLayer:function(a){this.drawManager.hideAllLayer(a)&&this.render(!0)},hideDrawLayer:function(a){this.drawManager.hideDrawLayer(a)&&this.render(!0)},setLayerColor:function(a,b,c){if(a&&b){var d=this.drawManager.getCurrentDraw(),e=!0;if(c){var f=this.drawManager.getDraw(c);d!==f&&(e=!1,d=f)}d&&d.setLayerColor(a,b)&&e&&this.render(!0)}},setAllLayerColor:function(a,b){if(a){var c=this.drawManager.getCurrentDraw(),d=!0;if(b){var e=this.drawManager.getDraw(b);c!==e&&(d=!1,c=e)}c&&c.setAllLayerColor(a)&&d&&this.render(!0)}},clearAllCustomLayerColor:function(a){var b=this.drawManager.getCurrentDraw(),c=!0;if(a){var d=this.drawManager.getDraw(a);b!==d&&(c=!1,b=d)}b&&b.clearAllCustomLayerColor()&&c&&this.render(!0)},openBlackWhiteMode:function(){this._isBlackWhiteMode||(this._isBlackWhiteMode=!0,this.setBackgroundColor(new I("#FFFFFF",1),void 0),this.render(!0))},closeBlackWhiteMode:function(){this._isBlackWhiteMode&&(this._isBlackWhiteMode=!1,this.setBackgroundColor(new I("#4a4a4a",1),void 0),this.render(!0))},getCurrentDrawLayers:function(){var a=this.drawManager.getCurrentDraw();if(a)return a.getAllLayerBaseInfo()},getDrawList:function(a,b){return this.drawManager.getDrawList(a,b)},highlightComponentsByKeys:function(a){var b=this.drawManager.getCurrentDraw();if(!b)return!1;var c=b.allComponentPartKeysOfComponents(a);return!!c&&void this.drawManager.sceneState.setSelection(c)},clearAllHighlightComponents:function(){this.drawManager.sceneState.clearSelection()},focusOnComponentByKey:function(a,b){var c=this.camera.getViewportTransform(),d=new Ra;d.fromCanvasTransform(c[0],c[1],c[2],c[3],c[4],c[5]);var e=this.drawManager.getComponentBoundingBoxes(a,d);e&&(b?this.zoomToBox(e.world):this.focusOnBox(e.world))},focusOnComponentByKeys:function(a,b){var c=this.camera.getViewportTransform(),d=new Ra;d.fromCanvasTransform(c[0],c[1],c[2],c[3],c[4],c[5]);var e=this.getBoundingBoxByKeys(a);e&&(b?this.zoomToBox(e):this.focusOnBox(e))},highlightComponentPartsByKeys:function(a){this.drawManager.sceneState.setSelection(a)},focusOnComponentPartsByKeys:function(a,b){var c=this.getBoundingBoxByComponentPartKeys(a);c&&(b?this.zoomToBox(c):this.focusOnBox(c))},focusOnBox:function(a){if(a){var b=!1,c=this.camera.getViewportTransform(),d=new Ra;d.fromCanvasTransform(c[0],c[1],c[2],c[3],c[4],c[5]);var e=a.clone().applyMatrix3(d),f=e.getCenter(new B),g=e.getSize(new B),h=a.getSize(new B);if(g.x/h.x<.2&&h.x>50&&g.x<50)b=!0,this.camera.setViewportTransform([1,0,0,1,0,0]);else if(h.x<50){var i=50/h.x;this.zoomToPoint(f,i),b=!0}c=this.camera.getViewportTransform(),d=new Ra,d.fromCanvasTransform(c[0],c[1],c[2],c[3],c[4],c[5]),e=a.clone().applyMatrix3(d);var j=this.viewingBox,k=this.viewingBox.getCenter(new B);f=e.getCenter(new B),(!e.intersectsBox(j)&&!j.intersectsBox(e)||e.min.x<0||e.min.y<0||e.max.x>j.max.x||e.max.y>j.max.y)&&(d.translate(k.x-f.x,k.y-f.y),this.camera.setViewportTransform(d.toCanvasTransform())),b&&this.render(!0)}},render:function(a){this.needRender=!0,this.needFullRender!==!0&&(this.needFullRender=a)},startRender:function(){this._renderTimer=requestAnimationFrame(this.checkNeedRender)},stopRender:function(){cancelAnimationFrame(this._renderTimer)},_render:function(a){var b=(this.camera,this.drawManager),c=this.canvas.width,d=this.canvas.height,e=this.camera.getViewportTransform(),f=this.cameraControl.getZoom();this.viewingBox.min.set(0,0),this.viewingBox.max.set(c,d),this.ctx.resetTransform();var g=b.getCurrentDraw();if(g){var h=g.localMatrixWithCanvasSize(c,d),i=new Ra;i.fromCanvasTransform(e[0],e[1],e[2],e[3],e[4],e[5]);var j=new Ra;j.multiplyMatrices(i,h);var k=(new Ra).getInverse(j),l=this.viewingBox.clone().applyMatrix3(k);e=j.toCanvasTransform(),f=e[0];var m=null;this._isBlackWhiteMode&&(m={color:"#000000"});var n=null;if(this.clipPlanes&&this.clipPlanes.enabled){this.clipPlanes.update();var o=this.clipPlanes.boundingBox.clone().applyMatrix3(j),p=o.getSize(new B),q=o.min;n={x:q.x,y:q.y,width:p.x,height:p.y}}if(this.needFullRender||a){jc.setCtx(this.ctx),this.needFullRender=!1,this.ctx.clearRect(0,0,c,d),this.ctx.save(),n&&(this.ctx.beginPath(),this.ctx.rect(n.x,n.y,n.width,n.height),this.ctx.clip());var r=2/f;this.ctx.lineWidth=r,this.ctx.transform(e[0],e[1],e[2],e[3],e[4],e[5]);var s=void 0;g.quadTree&&g.quadTree.isValid()&&(s=g.quadTree.allComponentsInBox(l),s&&s.length&&(s=s.reverse())),g.render(this.ctx,l,e,1/f,m,s),jc.render(),this.ctx.restore()}jc.setCtx(this.tempCtx),this.tempCtx.clearRect(0,0,c,d),this.tempCtx.save(),n&&(this.tempCtx.beginPath(),this.tempCtx.rect(n.x,n.y,n.width,n.height),this.tempCtx.clip()),this.tempCtx.transform(e[0],e[1],e[2],e[3],e[4],e[5]);var t=Math.max(5/f,2);this.tempCtx.lineWidth=t;var u=b.sceneState.hoverObj;u&&u.render(this.tempCtx,this.viewingBox,e,1/f,m,!0),m={color:this._isBlackWhiteMode?"#000000":Z.SelectionColor.color};var v=b.sceneState.getSelectionSet();for(var w in v)if(v.hasOwnProperty(w)){var x=g.getVisiblePathsOfComponentPart(w);x&&x.render(this.tempCtx,this.viewingBox,e,1/f,m,!0)}jc.render(),this._3DCamera&&this._3DCamera.render(this.tempCtx,j,c,d),this.tempCtx.restore(),this.onRenderListener()}else this.ctx.clearRect(0,0,c,d),this.tempCtx.clearRect(0,0,c,d)},resize:function(a,b){var c=this.getDomElement();c&&(c.style.height=b+"px",c.style.width=a+"px");var d=this.canvas;d.width=a,d.height=b;var e=this.tempCanvas;e.width=a,e.height=b,this.dispatchEvent({type:"resize",data:{width:a,height:b}}),this.drawManager.resetAllDrawLocalMatrix(),this.render(!0)},getZoom:function(){return this.cameraControl.getZoom()},setViewportTransform:function(a){return this.cameraControl.setViewportTransform(a),this.render(),this},calcViewportBoundaries:function(){var a={},b=this.width,c=this.height,d=$a.invertTransform(this.viewportTransform);return a.tl=$a.transformPoint({x:0,y:0},d),a.br=$a.transformPoint({x:b,y:c},d),a.tr=new Ta(a.br.x,a.tl.y),a.bl=new Ta(a.tl.x,a.br.y),this.vptCoords=a,a},zoomToPoint:function(a,b){this.cameraControl.zoomToPoint(a,b)},zoomToScreenBox:function(a){this.cameraControl.zoomToScreenBox(a)},zoomToBox:function(a){var b=this.camera.getViewportTransform(),c=new Ra;if(c.fromCanvasTransform(b[0],b[1],b[2],b[3],b[4],b[5]),a){return a=a.clone(),a.applyMatrix3(c),void this.zoomToScreenBox(a)}},getBoundingBoxByKeys:function(a){var b=this.drawManager.getCurrentDraw();if(b){for(var c=null,d=0,e=a.length;d<e;d+=1){var f=b.getComponentBoundingBoxes(a[d]);f&&f.world&&(c?(c.expandByPoint(f.world.min),c.expandByPoint(f.world.max)):c=f.world.clone())}return c}},getBoundingBoxByComponentPartKeys:function(a){var b=this.drawManager.getCurrentDraw();if(b){for(var c=null,d=0,e=a.length;d<e;d+=1){var f=b.getComponentPartBoundingBoxes(a[d]);f&&f.world&&(c?(c.expandByPoint(f.world.min),c.expandByPoint(f.world.max)):c=f.world.clone())}return c}},getScreenCoordFromSceneCoord:function(a){var b=new B;return a.isVector2?b=a.clone():Array.isArray(a)&&(b=new B(a[0],a[1])),b.applyMatrix3(this.getSceneToScreenMatrix()).toArray()},getSceneCoordFromScreenCoord:function(a){var b=new B;return a.isVector2?b=a.clone():Array.isArray(a)&&(b=new B(a[0],a[1])),b.applyMatrix3(this.getScreenToSceneMatrix()).toArray()},get2DSceneCoordFrom3DSceneCoord:function(a){var b=new B;return a.isVector3?b.set(a.x,-a.y):Array.isArray(a)&&b.set(a[0],-a[1]),b.toArray()},get3DSceneCoordFrom2DSceneCoord:function(a){var b=new B;return a.isVector2?b.set(a.x,-a.y):Array.isArray(a)&&b.set(a[0],-a[1]),b.toArray()},get2DScreenCoordFrom3DSceneCoord:function(a){var b=new B;return a.isVector3?b.set(a.x,-a.y):Array.isArray(a)&&b.set(a[0],-a[1]),this.getScreenCoordFromSceneCoord(b)},getScreenToSceneMatrix:function(){var a=this.getSceneToScreenMatrix(),b=(new Ra).getInverse(a);return b},getSceneToScreenMatrix:function(){var a=this.drawManager,b=this.canvas.width,c=this.canvas.height,d=this.camera.getViewportTransform(),e=a.getCurrentDraw();if(e){var f=e.localMatrixWithCanvasSize(b,c),g=new Ra;g.fromCanvasTransform(d[0],d[1],d[2],d[3],d[4],d[5]);var h=new Ra;return h.multiplyMatrices(g,f),h}return new Ra},setZoom:function(a){this.cameraControl.setZoom(a)},absolutePan:function(a){this.cameraControl.absolutePan(a)},relativePan:function(a){this.cameraControl.relativePan(a)},setBackgroundColor:function(a,b){if(b)this.setBackgroundColors([{color:a,stop:"0%"},{color:b,stop:"100%"}],"180deg");else{var c=this.getDomElement();c&&(c.style.background=a.getRGBA())}},setBackgroundColors:function(a,b){var c=this.getDomElement(),d=b||"0deg",e=[];if(a&&a.length>0){1===a.length&&this.setBackgroundColor(a[0].color||a[0]);for(var f=0;f<a.length;f+=1){var g=a[f].color.getRGBA()+" "+a[f].stop;e.push(g)}var h=d+", "+e.join(",");c&&(c.style.background="linear-gradient("+h+")")}},show3DCamera:function(a,b){this._3DCamera||(this._3DCamera=new Sa),a=this.get2DSceneCoordFrom3DSceneCoord(a),a=new B(a[0],a[1]);var c=0;b&&(b=this.get2DSceneCoordFrom3DSceneCoord(b),c=$a.canvasRotateAngleOfVector(b[0],b[1])),this._3DCamera.position=a,c&&(this._3DCamera.rotate=c),this.render()},hide3DCamera:function(){this._3DCamera=void 0},getCameraStatus:function(){return{viewportTransform:this.cameraControl.camera.getViewportTransform()}},setCameraStatus:function(a){a&&(this.cameraControl.camera.setViewportTransform(a.viewportTransform),this.render(!0))},restoreCameraStatus:function(){this.cameraControl.camera.setViewportTransform([1,0,0,1,0,0]),this.cameraControl.dispatchEvent({type:ga.ON_CAMERA_CHANGE}),this.render(!0)},setOnSelectComponentCallback:function(a){"function"==typeof a?this._onSelectComponentCallBacks=[a]:a||(this._onSelectComponentCallBacks=void 0)},addOnSelectComponentCallback:function(a){this._onSelectComponentCallBacks?this._onSelectComponentCallBacks.push(a):this._onSelectComponentCallBacks=[a]},addRenderListener:function(a){this.addEventListener("render",a)},removeRenderListener:function(a){this.removeEventListener("render",a)},onRenderListener:function(){this.dispatchEvent("render")},_onComponentPartSelect:function(){if(this._onSelectComponentCallBacks){var a=this.drawManager.sceneState.getSelection(),b=void 0;if(a&&a.length>0){for(var c={},d=0,e=a.length;d<e;d+=1){var f=cc(a[d]);c[f]=void 0}b=Object.keys(c)}for(var g=0,h=this._onSelectComponentCallBacks.length;g<h;g+=1)this._onSelectComponentCallBacks[g](b,a)}}});var vc=function(a){var b={host:"https://bos3d.bimwinner.com",viewport:""},c=this,d=X.extend({},b,a);this.host=d.host;var e=document.getElementById(d.viewport);e.style.position="relative",this.viewerImpl=new uc,this.getViewerImpl().init(e),this.currentModelKey=void 0,this.onDrawListLoad=void 0,this.onDrawLoad=void 0,this.getViewerImpl().drawManager.addEventListener(ga.ON_CLICK_PICK,function(a){if(a.intersectInfo){G.log("key",a.intersectInfo.selectedObjectId);var b=a.intersectInfo.object;b&&G.log(b)}}),window.BOS2DUI||new Oa({viewer2D:this,linkage:a.linkage,BOS2D:window.BOS2D||window.BIMWINNER.BOS2D}),this.SVGRect=new Pa(this),this.SVGRect.creatSVG(),this.viewerImpl.drawManager.addEventListener(ga.ON_CONTROL_UPDATEUI,function(a){c.SVGRect.creatRect(a)}),this.viewportDiv=e};Object.assign(vc.prototype,J.prototype),Object.assign(vc.prototype,{constructor:vc,getViewerImpl:function(){return this.viewerImpl},addView:function(a,b,c){this.currentModelKey=a;var d=this;this.getViewerImpl().load({serverUrl:this.host,modelKey:a,dbName:b,token:c||"",onDrawListLoad:function(b){d.currentModelKey===a&&d.onDrawListLoad&&d.onDrawListLoad(b)},onDrawLoad:function(a){d.onDrawLoad&&d.onDrawLoad(a)},onLoadError:function(a){a&&za("error",a,5e3)}})},removeView:function(a){return this.getViewerImpl().unload(a)},removeAllView:function(){this.getViewerImpl().unloadAll()},setBackGroundColor:function(a,b){this.getViewerImpl().setBackgroundColor(new I(a,b))},showLocalDraw:function(a){a&&(this.currentModelKey=a,this.getViewerImpl().loadDrawFromLocalHost(a,this.onDrawListLoad))},showRevitAxisNet:function(a){a&&(this.currentModelKey=a,this.getViewerImpl().loadRevitAxisNetFromLoacalHost(a,this.onDrawListLoad))},render:function(){this.getViewerImpl().render()},showDraw:function(a,b){this.getViewerImpl().showDraw(a,b)},getCurrentDrawLayers:function(){return this.getViewerImpl().getCurrentDrawLayers()},showDrawLayer:function(a){this.getViewerImpl().showDrawLayer(a)},hideDrawLayer:function(a){this.getViewerImpl().hideDrawLayer(a)},showAllLayer:function(){this.getViewerImpl().showAllLayer(this.currentModelKey)},hideAllLayer:function(){this.getViewerImpl().hideAllLayer(this.currentModelKey)},setLayerColor:function(a,b,c){this.getViewerImpl().setLayerColor(a,b,c)},setAllLayerColor:function(a,b){this.getViewerImpl().setAllLayerColor(a,b)},openBlackWhiteMode:function(){this.getViewerImpl().openBlackWhiteMode()},closeBlackWhiteMode:function(){this.getViewerImpl().closeBlackWhiteMode()},clearAllCustomLayerColor:function(a){this.getViewerImpl().clearAllCustomLayerColor()},getCurrentDrawList:function(a){return this.getViewerImpl().getDrawList(this.currentModelKey,a)},setOnSelectComponentCallback:function(a){this.getViewerImpl().setOnSelectComponentCallback(a)},addOnSelectComponentCallback:function(a){this.getViewerImpl().addOnSelectComponentCallback(a)},highlightComponentsByKeys:function(a){this.getViewerImpl().highlightComponentsByKeys(a)},clearAllHighlightComponents:function(){this.getViewerImpl().clearAllHighlightComponents()},focusOnComponentByKey:function(a,b,c){var d=this.getViewerImpl();d.focusOnComponentByKey(a,c),b===!0&&d.highlightComponentsByKeys([a])},focusOnComponentByKeys:function(a,b,c){var d=this.getViewerImpl();d.focusOnComponentByKeys(a,c),b===!0&&d.highlightComponentsByKeys(a)},highlightComponentPartsByKeys:function(a){this.getViewerImpl().highlightComponentPartsByKeys(a)},focusOnComponentPartsByKeys:function(a,b){this.getViewerImpl().focusOnComponentPartsByKeys(a,b)},getSelectedComponentPartKeys:function(){return this.viewerImpl.drawManager.sceneState.getSelection()},resize:function(a,b){this.getViewerImpl().resize(a,b)},autoResize:function(){this.getViewerImpl().resize(this.getClientWidth()-5,this.getClientHeight()-8)},getClientHeight:function(){return Qa.getClientHeight()},getClientWidth:function(){return Qa.getClientWidth()},getBoxByComponentsKey:function(a){Array.isArray(a)||(a=[a]);var b=this.getViewerImpl().getBoundingBoxByKeys(a);return b?b:null},getScreenCoordFromSceneCoord:function(a){return this.getViewerImpl().getScreenCoordFromSceneCoord(a)},getSceneCoordFromScreenCoord:function(a){return this.getViewerImpl().getSceneCoordFromScreenCoord(a)},show3DCamera:function(a,b){this.getViewerImpl().show3DCamera(a,b)},hide3DCamera:function(){this.getViewerImpl().hide3DCamera()},getCameraStatus:function(){return this.getViewerImpl().getCameraStatus()},setCameraStatus:function(a){this.getViewerImpl().setCameraStatus(a)},restoreCameraStatus:function(){this.getViewerImpl().restoreCameraStatus()}}),a.Box2=D,a.ControlMode=da,a.DPI=aa,a.DRAW_EVENTS=ba,a.DeviceTest=Aa,a.EVENTS=ga,a.GlobalData=Z,a.IDENTITYMATRIX=_,a.MOUSE=ca,a.OPSELECTIONTYPE=fa,a.ToolMode=ea,a.Vector2=B,a.Viewer2D=vc,a.ViewerImpl=uc,a.logger=G,Object.defineProperty(a,"__esModule",{value:!0})});